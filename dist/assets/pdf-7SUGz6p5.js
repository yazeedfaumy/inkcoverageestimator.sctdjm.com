var Jn=Object.defineProperty;var mn=x=>{throw TypeError(x)};var Qn=(x,e,N)=>e in x?Jn(x,e,{enumerable:!0,configurable:!0,writable:!0,value:N}):x[e]=N;var Jt=(x,e,N)=>Qn(x,typeof e!="symbol"?e+"":e,N),De=(x,e,N)=>e.has(x)||mn("Cannot "+N);var t=(x,e,N)=>(De(x,e,"read from private field"),N?N.call(x):e.get(x)),at=(x,e,N)=>e.has(x)?mn("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(x):e.set(x,N),lt=(x,e,N,n)=>(De(x,e,"write to private field"),n?n.call(x,N):e.set(x,N),N),K=(x,e,N)=>(De(x,e,"access private method"),N);var de=(x,e,N,n)=>({set _(u){lt(x,e,u,N)},get _(){return t(x,e,n)}});import{g as getDefaultExportFromCjs,a as getAugmentedNamespace,r as reactExports,b as React}from"./react-B6wDfWTD.js";function _mergeNamespaces(x,e){for(var N=0;N<e.length;N++){const n=e[N];if(typeof n!="string"&&!Array.isArray(n)){for(const u in n)if(u!=="default"&&!(u in x)){const z=Object.getOwnPropertyDescriptor(n,u);z&&Object.defineProperty(x,u,z.get?z:{enumerable:!0,get:()=>n[u]})}}}return Object.freeze(Object.defineProperty(x,Symbol.toStringTag,{value:"Module"}))}var propTypes={exports:{}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function x(n,u,z,H,ut,k){if(k!==ReactPropTypesSecret){var w=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw w.name="Invariant Violation",w}}x.isRequired=x;function e(){return x}var N={array:x,bigint:x,bool:x,func:x,number:x,object:x,string:x,symbol:x,any:x,arrayOf:e,element:x,elementType:x,instanceOf:e,node:x,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return N.PropTypes=N,N};propTypes.exports=factoryWithThrowingShims();var propTypesExports=propTypes.exports;const PropTypes=getDefaultExportFromCjs(propTypesExports);function commonjsRequire(x){throw new Error('Could not dynamically require "'+x+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(e,N){module.exports=e.pdfjsLib=N()})(globalThis,()=>(()=>{var __webpack_modules__=[,(x,e)=>{var qt;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=C,e.bytesToString=ht,e.createValidAbsoluteUrl=nt,e.getModificationDate=Pt,e.getUuid=It,e.getVerbosityLevel=V,e.info=J,e.isArrayBuffer=tt,e.isArrayEqual=wt,e.isNodeJS=void 0,e.normalizeUnicode=Ft,e.objectFromMap=_t,e.objectSize=bt,e.setVerbosityLevel=et,e.shadow=T,e.string32=yt,e.stringToBytes=pt,e.stringToPDFString=gt,e.stringToUTF8String=St,e.unreachable=rt,e.utf8StringToString=vt,e.warn=G;const N=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=N;const n=[1,0,0,1,0,0];e.IDENTITY_MATRIX=n;const u=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=u;const z=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=z;const H=1.35;e.LINE_FACTOR=H;const ut=.35;e.LINE_DESCENT_FACTOR=ut;const k=ut/H;e.BASELINE_FACTOR=k;const w={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=w;const m={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=m;const j="pdfjs_internal_editor_";e.AnnotationEditorPrefix=j;const U={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=U;const _={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=_;const b={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=b;const S={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=S;const g={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=g;const f={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=f;const A={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=A;const L={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=L;const v={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=v;const o={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=o;const d={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=d;const l={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=l;const c={O:"PageOpen",C:"PageClose"};e.PageActionEventType=c;const h={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=h;const B={NONE:0,BINARY:1};e.CMapCompressionType=B;const a={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=a;const E={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=E;let R=h.WARNINGS;function et(Et){Number.isInteger(Et)&&(R=Et)}function V(){return R}function J(Et){R>=h.INFOS&&console.log(`Info: ${Et}`)}function G(Et){R>=h.WARNINGS&&console.log(`Warning: ${Et}`)}function rt(Et){throw new Error(Et)}function C(Et,ot){Et||rt(ot)}function $(Et){switch(Et==null?void 0:Et.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function nt(Et,ot=null,ct=null){if(!Et)return null;try{if(ct&&typeof Et=="string"){if(ct.addDefaultProtocol&&Et.startsWith("www.")){const Xt=Et.match(/\./g);(Xt==null?void 0:Xt.length)>=2&&(Et=`http://${Et}`)}if(ct.tryConvertEncoding)try{Et=St(Et)}catch{}}const kt=ot?new URL(Et,ot):new URL(Et);if($(kt))return kt}catch{}return null}function T(Et,ot,ct,kt=!1){return Object.defineProperty(Et,ot,{value:ct,enumerable:!kt,configurable:!0,writable:!1}),ct}const s=function(){function ot(ct,kt){this.constructor===ot&&rt("Cannot initialize BaseException."),this.message=ct,this.name=kt}return ot.prototype=new Error,ot.constructor=ot,ot}();e.BaseException=s;class i extends s{constructor(ot,ct){super(ot,"PasswordException"),this.code=ct}}e.PasswordException=i;class p extends s{constructor(ot,ct){super(ot,"UnknownErrorException"),this.details=ct}}e.UnknownErrorException=p;class M extends s{constructor(ot){super(ot,"InvalidPDFException")}}e.InvalidPDFException=M;class D extends s{constructor(ot){super(ot,"MissingPDFException")}}e.MissingPDFException=D;class O extends s{constructor(ot,ct){super(ot,"UnexpectedResponseException"),this.status=ct}}e.UnexpectedResponseException=O;class q extends s{constructor(ot){super(ot,"FormatError")}}e.FormatError=q;class st extends s{constructor(ot){super(ot,"AbortException")}}e.AbortException=st;function ht(Et){(typeof Et!="object"||(Et==null?void 0:Et.length)===void 0)&&rt("Invalid argument for bytesToString");const ot=Et.length,ct=8192;if(ot<ct)return String.fromCharCode.apply(null,Et);const kt=[];for(let Xt=0;Xt<ot;Xt+=ct){const Vt=Math.min(Xt+ct,ot),W=Et.subarray(Xt,Vt);kt.push(String.fromCharCode.apply(null,W))}return kt.join("")}function pt(Et){typeof Et!="string"&&rt("Invalid argument for stringToBytes");const ot=Et.length,ct=new Uint8Array(ot);for(let kt=0;kt<ot;++kt)ct[kt]=Et.charCodeAt(kt)&255;return ct}function yt(Et){return String.fromCharCode(Et>>24&255,Et>>16&255,Et>>8&255,Et&255)}function bt(Et){return Object.keys(Et).length}function _t(Et){const ot=Object.create(null);for(const[ct,kt]of Et)ot[ct]=kt;return ot}function Q(){const Et=new Uint8Array(4);return Et[0]=1,new Uint32Array(Et.buffer,0,1)[0]===1}function Z(){try{return new Function(""),!0}catch{return!1}}class y{static get isLittleEndian(){return T(this,"isLittleEndian",Q())}static get isEvalSupported(){return T(this,"isEvalSupported",Z())}static get isOffscreenCanvasSupported(){return T(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?T(this,"platform",{isWin:!1,isMac:!1}):T(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var ot,ct;return T(this,"isCSSRoundSupported",(ct=(ot=globalThis.CSS)==null?void 0:ot.supports)==null?void 0:ct.call(ot,"width: round(1.5px, 1px)"))}}e.FeatureTest=y;const I=[...Array(256).keys()].map(Et=>Et.toString(16).padStart(2,"0"));class Y{static makeHexColor(ot,ct,kt){return`#${I[ot]}${I[ct]}${I[kt]}`}static scaleMinMax(ot,ct){let kt;ot[0]?(ot[0]<0&&(kt=ct[0],ct[0]=ct[1],ct[1]=kt),ct[0]*=ot[0],ct[1]*=ot[0],ot[3]<0&&(kt=ct[2],ct[2]=ct[3],ct[3]=kt),ct[2]*=ot[3],ct[3]*=ot[3]):(kt=ct[0],ct[0]=ct[2],ct[2]=kt,kt=ct[1],ct[1]=ct[3],ct[3]=kt,ot[1]<0&&(kt=ct[2],ct[2]=ct[3],ct[3]=kt),ct[2]*=ot[1],ct[3]*=ot[1],ot[2]<0&&(kt=ct[0],ct[0]=ct[1],ct[1]=kt),ct[0]*=ot[2],ct[1]*=ot[2]),ct[0]+=ot[4],ct[1]+=ot[4],ct[2]+=ot[5],ct[3]+=ot[5]}static transform(ot,ct){return[ot[0]*ct[0]+ot[2]*ct[1],ot[1]*ct[0]+ot[3]*ct[1],ot[0]*ct[2]+ot[2]*ct[3],ot[1]*ct[2]+ot[3]*ct[3],ot[0]*ct[4]+ot[2]*ct[5]+ot[4],ot[1]*ct[4]+ot[3]*ct[5]+ot[5]]}static applyTransform(ot,ct){const kt=ot[0]*ct[0]+ot[1]*ct[2]+ct[4],Xt=ot[0]*ct[1]+ot[1]*ct[3]+ct[5];return[kt,Xt]}static applyInverseTransform(ot,ct){const kt=ct[0]*ct[3]-ct[1]*ct[2],Xt=(ot[0]*ct[3]-ot[1]*ct[2]+ct[2]*ct[5]-ct[4]*ct[3])/kt,Vt=(-ot[0]*ct[1]+ot[1]*ct[0]+ct[4]*ct[1]-ct[5]*ct[0])/kt;return[Xt,Vt]}static getAxialAlignedBoundingBox(ot,ct){const kt=this.applyTransform(ot,ct),Xt=this.applyTransform(ot.slice(2,4),ct),Vt=this.applyTransform([ot[0],ot[3]],ct),W=this.applyTransform([ot[2],ot[1]],ct);return[Math.min(kt[0],Xt[0],Vt[0],W[0]),Math.min(kt[1],Xt[1],Vt[1],W[1]),Math.max(kt[0],Xt[0],Vt[0],W[0]),Math.max(kt[1],Xt[1],Vt[1],W[1])]}static inverseTransform(ot){const ct=ot[0]*ot[3]-ot[1]*ot[2];return[ot[3]/ct,-ot[1]/ct,-ot[2]/ct,ot[0]/ct,(ot[2]*ot[5]-ot[4]*ot[3])/ct,(ot[4]*ot[1]-ot[5]*ot[0])/ct]}static singularValueDecompose2dScale(ot){const ct=[ot[0],ot[2],ot[1],ot[3]],kt=ot[0]*ct[0]+ot[1]*ct[2],Xt=ot[0]*ct[1]+ot[1]*ct[3],Vt=ot[2]*ct[0]+ot[3]*ct[2],W=ot[2]*ct[1]+ot[3]*ct[3],mt=(kt+W)/2,Ct=Math.sqrt((kt+W)**2-4*(kt*W-Vt*Xt))/2,Lt=mt+Ct||1,Bt=mt-Ct||1;return[Math.sqrt(Lt),Math.sqrt(Bt)]}static normalizeRect(ot){const ct=ot.slice(0);return ot[0]>ot[2]&&(ct[0]=ot[2],ct[2]=ot[0]),ot[1]>ot[3]&&(ct[1]=ot[3],ct[3]=ot[1]),ct}static intersect(ot,ct){const kt=Math.max(Math.min(ot[0],ot[2]),Math.min(ct[0],ct[2])),Xt=Math.min(Math.max(ot[0],ot[2]),Math.max(ct[0],ct[2]));if(kt>Xt)return null;const Vt=Math.max(Math.min(ot[1],ot[3]),Math.min(ct[1],ct[3])),W=Math.min(Math.max(ot[1],ot[3]),Math.max(ct[1],ct[3]));return Vt>W?null:[kt,Vt,Xt,W]}static bezierBoundingBox(ot,ct,kt,Xt,Vt,W,mt,Ct){const Lt=[],Bt=[[],[]];let Rt,F,P,X,dt,ft,At,Tt;for(let Ht=0;Ht<2;++Ht){if(Ht===0?(F=6*ot-12*kt+6*Vt,Rt=-3*ot+9*kt-9*Vt+3*mt,P=3*kt-3*ot):(F=6*ct-12*Xt+6*W,Rt=-3*ct+9*Xt-9*W+3*Ct,P=3*Xt-3*ct),Math.abs(Rt)<1e-12){if(Math.abs(F)<1e-12)continue;X=-P/F,0<X&&X<1&&Lt.push(X);continue}At=F*F-4*P*Rt,Tt=Math.sqrt(At),!(At<0)&&(dt=(-F+Tt)/(2*Rt),0<dt&&dt<1&&Lt.push(dt),ft=(-F-Tt)/(2*Rt),0<ft&&ft<1&&Lt.push(ft))}let Ot=Lt.length,Mt;const xt=Ot;for(;Ot--;)X=Lt[Ot],Mt=1-X,Bt[0][Ot]=Mt*Mt*Mt*ot+3*Mt*Mt*X*kt+3*Mt*X*X*Vt+X*X*X*mt,Bt[1][Ot]=Mt*Mt*Mt*ct+3*Mt*Mt*X*Xt+3*Mt*X*X*W+X*X*X*Ct;return Bt[0][xt]=ot,Bt[1][xt]=ct,Bt[0][xt+1]=mt,Bt[1][xt+1]=Ct,Bt[0].length=Bt[1].length=xt+2,[Math.min(...Bt[0]),Math.min(...Bt[1]),Math.max(...Bt[0]),Math.max(...Bt[1])]}}e.Util=Y;const it=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function gt(Et){if(Et[0]>="ï"){let ct;if(Et[0]==="þ"&&Et[1]==="ÿ"?ct="utf-16be":Et[0]==="ÿ"&&Et[1]==="þ"?ct="utf-16le":Et[0]==="ï"&&Et[1]==="»"&&Et[2]==="¿"&&(ct="utf-8"),ct)try{const kt=new TextDecoder(ct,{fatal:!0}),Xt=pt(Et);return kt.decode(Xt)}catch(kt){G(`stringToPDFString: "${kt}".`)}}const ot=[];for(let ct=0,kt=Et.length;ct<kt;ct++){const Xt=it[Et.charCodeAt(ct)];ot.push(Xt?String.fromCharCode(Xt):Et.charAt(ct))}return ot.join("")}function St(Et){return decodeURIComponent(escape(Et))}function vt(Et){return unescape(encodeURIComponent(Et))}function tt(Et){return typeof Et=="object"&&(Et==null?void 0:Et.byteLength)!==void 0}function wt(Et,ot){if(Et.length!==ot.length)return!1;for(let ct=0,kt=Et.length;ct<kt;ct++)if(Et[ct]!==ot[ct])return!1;return!0}function Pt(Et=new Date){return[Et.getUTCFullYear().toString(),(Et.getUTCMonth()+1).toString().padStart(2,"0"),Et.getUTCDate().toString().padStart(2,"0"),Et.getUTCHours().toString().padStart(2,"0"),Et.getUTCMinutes().toString().padStart(2,"0"),Et.getUTCSeconds().toString().padStart(2,"0")].join("")}class Wt{constructor(){at(this,qt,!1);this.promise=new Promise((ot,ct)=>{this.resolve=kt=>{lt(this,qt,!0),ot(kt)},this.reject=kt=>{lt(this,qt,!0),ct(kt)}})}get settled(){return t(this,qt)}}qt=new WeakMap,e.PromiseCapability=Wt;let Ut=null,zt=null;function Ft(Et){return Ut||(Ut=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,zt=new Map([["ﬅ","ſt"]])),Et.replaceAll(Ut,(ot,ct,kt)=>ct?ct.normalize("NFKC"):zt.get(kt))}function It(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const Et=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(Et);else for(let ot=0;ot<32;ot++)Et[ot]=Math.floor(Math.random()*255);return ht(Et)}const Gt="pdfjs_internal_id_";e.AnnotationPrefix=Gt},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var x,N,n,u,ae,_e,ut,k,w,m,j,U,_,b,S,Ae,f,A,Le,v,o;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(l){if(typeof l=="string"||l instanceof URL?l={url:l}:(0,_util.isArrayBuffer)(l)&&(l={data:l}),typeof l!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!l.url&&!l.data&&!l.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const c=new PDFDocumentLoadingTask,{docId:h}=c,B=l.url?getUrlProp(l.url):null,a=l.data?getDataProp(l.data):null,E=l.httpHeaders||null,R=l.withCredentials===!0,et=l.password??null,V=l.range instanceof PDFDataRangeTransport?l.range:null,J=Number.isInteger(l.rangeChunkSize)&&l.rangeChunkSize>0?l.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let G=l.worker instanceof PDFWorker?l.worker:null;const rt=l.verbosity,C=typeof l.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(l.docBaseUrl)?l.docBaseUrl:null,$=typeof l.cMapUrl=="string"?l.cMapUrl:null,nt=l.cMapPacked!==!1,T=l.CMapReaderFactory||DefaultCMapReaderFactory,s=typeof l.standardFontDataUrl=="string"?l.standardFontDataUrl:null,i=l.StandardFontDataFactory||DefaultStandardFontDataFactory,p=l.stopAtErrors!==!0,M=Number.isInteger(l.maxImageSize)&&l.maxImageSize>-1?l.maxImageSize:-1,D=l.isEvalSupported!==!1,O=typeof l.isOffscreenCanvasSupported=="boolean"?l.isOffscreenCanvasSupported:!_util.isNodeJS,q=Number.isInteger(l.canvasMaxAreaInBytes)?l.canvasMaxAreaInBytes:-1,st=typeof l.disableFontFace=="boolean"?l.disableFontFace:_util.isNodeJS,ht=l.fontExtraProperties===!0,pt=l.enableXfa===!0,yt=l.ownerDocument||globalThis.document,bt=l.disableRange===!0,_t=l.disableStream===!0,Q=l.disableAutoFetch===!0,Z=l.pdfBug===!0,y=V?V.length:l.length??NaN,I=typeof l.useSystemFonts=="boolean"?l.useSystemFonts:!_util.isNodeJS&&!st,Y=typeof l.useWorkerFetch=="boolean"?l.useWorkerFetch:T===_display_utils.DOMCMapReaderFactory&&i===_display_utils.DOMStandardFontDataFactory&&$&&s&&(0,_display_utils.isValidFetchUrl)($,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(s,document.baseURI),it=l.canvasFactory||new DefaultCanvasFactory({ownerDocument:yt}),gt=l.filterFactory||new DefaultFilterFactory({docId:h,ownerDocument:yt}),St=null;(0,_util.setVerbosityLevel)(rt);const vt={canvasFactory:it,filterFactory:gt};if(Y||(vt.cMapReaderFactory=new T({baseUrl:$,isCompressed:nt}),vt.standardFontDataFactory=new i({baseUrl:s})),!G){const Pt={verbosity:rt,port:_worker_options.GlobalWorkerOptions.workerPort};G=Pt.port?PDFWorker.fromPort(Pt):new PDFWorker(Pt),c._worker=G}const tt={docId:h,apiVersion:"3.11.174",data:a,password:et,disableAutoFetch:Q,rangeChunkSize:J,length:y,docBaseUrl:C,enableXfa:pt,evaluatorOptions:{maxImageSize:M,disableFontFace:st,ignoreErrors:p,isEvalSupported:D,isOffscreenCanvasSupported:O,canvasMaxAreaInBytes:q,fontExtraProperties:ht,useSystemFonts:I,cMapUrl:Y?$:null,standardFontDataUrl:Y?s:null}},wt={ignoreErrors:p,isEvalSupported:D,disableFontFace:st,fontExtraProperties:ht,enableXfa:pt,ownerDocument:yt,disableAutoFetch:Q,pdfBug:Z,styleElement:St};return G.promise.then(function(){if(c.destroyed)throw new Error("Loading aborted");const Pt=_fetchDocument(G,tt),Wt=new Promise(function(Ut){let zt;V?zt=new _transport_stream.PDFDataTransportStream({length:y,initialData:V.initialData,progressiveDone:V.progressiveDone,contentDispositionFilename:V.contentDispositionFilename,disableRange:bt,disableStream:_t},V):a||(zt=(It=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(It):(0,_display_utils.isValidFetchUrl)(It.url)?new _displayFetch_stream.PDFFetchStream(It):new _displayNetwork.PDFNetworkStream(It))({url:B,length:y,httpHeaders:E,withCredentials:R,rangeChunkSize:J,disableRange:bt,disableStream:_t})),Ut(zt)});return Promise.all([Pt,Wt]).then(function([Ut,zt]){if(c.destroyed)throw new Error("Loading aborted");const Ft=new _message_handler.MessageHandler(h,Ut,G.port),It=new WorkerTransport(Ft,c,zt,wt,vt);c._transport=It,Ft.send("Ready",null)})}).catch(c._capability.reject),c}async function _fetchDocument(l,c){if(l.destroyed)throw new Error("Worker was destroyed");const h=await l.messageHandler.sendWithPromise("GetDocRequest",c,c.data?[c.data.buffer]:null);if(l.destroyed)throw new Error("Worker was destroyed");return h}function getUrlProp(l){if(l instanceof URL)return l.href;try{return new URL(l,window.location).href}catch{if(_util.isNodeJS&&typeof l=="string")return l}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(l){if(_util.isNodeJS&&typeof Buffer<"u"&&l instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength)return l;if(typeof l=="string")return(0,_util.stringToBytes)(l);if(typeof l=="object"&&!isNaN(l==null?void 0:l.length)||(0,_util.isArrayBuffer)(l))return new Uint8Array(l);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${de(e,x)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var c,h,B;this.destroyed=!0;try{(c=this._worker)!=null&&c.port&&(this._worker._pendingDestroy=!0),await((h=this._transport)==null?void 0:h.destroy())}catch(a){throw(B=this._worker)!=null&&B.port&&delete this._worker._pendingDestroy,a}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};x=new WeakMap,at(e,x,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(c,h,B=!1,a=null){this.length=c,this.initialData=h,this.progressiveDone=B,this.contentDispositionFilename=a,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(c){this._rangeListeners.push(c)}addProgressListener(c){this._progressListeners.push(c)}addProgressiveReadListener(c){this._progressiveReadListeners.push(c)}addProgressiveDoneListener(c){this._progressiveDoneListeners.push(c)}onDataRange(c,h){for(const B of this._rangeListeners)B(c,h)}onDataProgress(c,h){this._readyCapability.promise.then(()=>{for(const B of this._progressListeners)B(c,h)})}onDataProgressiveRead(c){this._readyCapability.promise.then(()=>{for(const h of this._progressiveReadListeners)h(c)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const c of this._progressiveDoneListeners)c()})}transportReady(){this._readyCapability.resolve()}requestDataRange(c,h){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(c,h){this._pdfInfo=c,this._transport=h,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(B=>{if(!B)return B;const a=[];for(const E in B)a.push(...B[E]);return a}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(c){return this._transport.getPage(c)}getPageIndex(c){return this._transport.getPageIndex(c)}getDestinations(){return this._transport.getDestinations()}getDestination(c){return this._transport.getDestination(c)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(c=!1){return this._transport.startCleanup(c||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(c,h,B,a=!1){at(this,u);at(this,N,null);at(this,n,!1);this._pageIndex=c,this._pageInfo=h,this._transport=B,this._stats=a?new _display_utils.StatTimer:null,this._pdfBug=a,this.commonObjs=B.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:c,rotation:h=this.rotate,offsetX:B=0,offsetY:a=0,dontFlip:E=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:c,rotation:h,offsetX:B,offsetY:a,dontFlip:E})}getAnnotations({intent:c="display"}={}){const h=this._transport.getRenderingIntent(c);return this._transport.getAnnotations(this._pageIndex,h.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var c;return((c=this._transport._htmlForXfa)==null?void 0:c.children[this._pageIndex])||null}render({canvasContext:c,viewport:h,intent:B="display",annotationMode:a=_util.AnnotationMode.ENABLE,transform:E=null,background:R=null,optionalContentConfigPromise:et=null,annotationCanvasMap:V=null,pageColors:J=null,printAnnotationStorage:G=null}){var i,p;(i=this._stats)==null||i.time("Overall");const rt=this._transport.getRenderingIntent(B,a,G);lt(this,n,!1),K(this,u,_e).call(this),et||(et=this._transport.getOptionalContentConfig());let C=this._intentStates.get(rt.cacheKey);C||(C=Object.create(null),this._intentStates.set(rt.cacheKey,C)),C.streamReaderCancelTimeout&&(clearTimeout(C.streamReaderCancelTimeout),C.streamReaderCancelTimeout=null);const $=!!(rt.renderingIntent&_util.RenderingIntentFlag.PRINT);C.displayReadyCapability||(C.displayReadyCapability=new _util.PromiseCapability,C.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(p=this._stats)==null||p.time("Page Request"),this._pumpOperatorList(rt));const nt=M=>{var D,O;C.renderTasks.delete(T),(this._maybeCleanupAfterRender||$)&&lt(this,n,!0),K(this,u,ae).call(this,!$),M?(T.capability.reject(M),this._abortOperatorList({intentState:C,reason:M instanceof Error?M:new Error(M)})):T.capability.resolve(),(D=this._stats)==null||D.timeEnd("Rendering"),(O=this._stats)==null||O.timeEnd("Overall")},T=new InternalRenderTask({callback:nt,params:{canvasContext:c,viewport:h,transform:E,background:R},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:V,operatorList:C.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!$,pdfBug:this._pdfBug,pageColors:J});(C.renderTasks||(C.renderTasks=new Set)).add(T);const s=T.task;return Promise.all([C.displayReadyCapability.promise,et]).then(([M,D])=>{var O;if(this.destroyed){nt();return}(O=this._stats)==null||O.time("Rendering"),T.initializeGraphics({transparency:M,optionalContentConfig:D}),T.operatorListChanged()}).catch(nt),s}getOperatorList({intent:c="display",annotationMode:h=_util.AnnotationMode.ENABLE,printAnnotationStorage:B=null}={}){var V;function a(){R.operatorList.lastChunk&&(R.opListReadCapability.resolve(R.operatorList),R.renderTasks.delete(et))}const E=this._transport.getRenderingIntent(c,h,B,!0);let R=this._intentStates.get(E.cacheKey);R||(R=Object.create(null),this._intentStates.set(E.cacheKey,R));let et;return R.opListReadCapability||(et=Object.create(null),et.operatorListChanged=a,R.opListReadCapability=new _util.PromiseCapability,(R.renderTasks||(R.renderTasks=new Set)).add(et),R.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(V=this._stats)==null||V.time("Page Request"),this._pumpOperatorList(E)),R.opListReadCapability.promise}streamTextContent({includeMarkedContent:c=!1,disableNormalization:h=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:c===!0,disableNormalization:h===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(c={}){if(this._transport._htmlForXfa)return this.getXfa().then(B=>_xfa_text.XfaText.textContent(B));const h=this.streamTextContent(c);return new Promise(function(B,a){function E(){R.read().then(function({value:V,done:J}){if(J){B(et);return}Object.assign(et.styles,V.styles),et.items.push(...V.items),E()},a)}const R=h.getReader(),et={items:[],styles:Object.create(null)};E()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const c=[];for(const h of this._intentStates.values())if(this._abortOperatorList({intentState:h,reason:new Error("Page was destroyed."),force:!0}),!h.opListReadCapability)for(const B of h.renderTasks)c.push(B.completed),B.cancel();return this.objs.clear(),lt(this,n,!1),K(this,u,_e).call(this),Promise.all(c)}cleanup(c=!1){lt(this,n,!0);const h=K(this,u,ae).call(this,!1);return c&&h&&this._stats&&(this._stats=new _display_utils.StatTimer),h}_startRenderPage(c,h){var a,E;const B=this._intentStates.get(h);B&&((a=this._stats)==null||a.timeEnd("Page Request"),(E=B.displayReadyCapability)==null||E.resolve(c))}_renderPageChunk(c,h){for(let B=0,a=c.length;B<a;B++)h.operatorList.fnArray.push(c.fnArray[B]),h.operatorList.argsArray.push(c.argsArray[B]);h.operatorList.lastChunk=c.lastChunk,h.operatorList.separateAnnots=c.separateAnnots;for(const B of h.renderTasks)B.operatorListChanged();c.lastChunk&&K(this,u,ae).call(this,!0)}_pumpOperatorList({renderingIntent:c,cacheKey:h,annotationStorageSerializable:B}){const{map:a,transfers:E}=B,et=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:c,cacheKey:h,annotationStorage:a},E).getReader(),V=this._intentStates.get(h);V.streamReader=et;const J=()=>{et.read().then(({value:G,done:rt})=>{if(rt){V.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(G,V),J())},G=>{if(V.streamReader=null,!this._transport.destroyed){if(V.operatorList){V.operatorList.lastChunk=!0;for(const rt of V.renderTasks)rt.operatorListChanged();K(this,u,ae).call(this,!0)}if(V.displayReadyCapability)V.displayReadyCapability.reject(G);else if(V.opListReadCapability)V.opListReadCapability.reject(G);else throw G}})};J()}_abortOperatorList({intentState:c,reason:h,force:B=!1}){if(c.streamReader){if(c.streamReaderCancelTimeout&&(clearTimeout(c.streamReaderCancelTimeout),c.streamReaderCancelTimeout=null),!B){if(c.renderTasks.size>0)return;if(h instanceof _display_utils.RenderingCancelledException){let a=RENDERING_CANCELLED_TIMEOUT;h.extraDelay>0&&h.extraDelay<1e3&&(a+=h.extraDelay),c.streamReaderCancelTimeout=setTimeout(()=>{c.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:c,reason:h,force:!0})},a);return}}if(c.streamReader.cancel(new _util.AbortException(h.message)).catch(()=>{}),c.streamReader=null,!this._transport.destroyed){for(const[a,E]of this._intentStates)if(E===c){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}N=new WeakMap,n=new WeakMap,u=new WeakSet,ae=function(c=!1){if(K(this,u,_e).call(this),!t(this,n)||this.destroyed)return!1;if(c)return lt(this,N,setTimeout(()=>{lt(this,N,null),K(this,u,ae).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:h,operatorList:B}of this._intentStates.values())if(h.size>0||!B.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),lt(this,n,!1),!0},_e=function(){t(this,N)&&(clearTimeout(t(this,N)),lt(this,N,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){at(this,ut,new Set);at(this,k,Promise.resolve())}postMessage(c,h){const B={data:structuredClone(c,h?{transfer:h}:null)};t(this,k).then(()=>{for(const a of t(this,ut))a.call(this,B)})}addEventListener(c,h){t(this,ut).add(h)}removeEventListener(c,h){t(this,ut).delete(h)}terminate(){t(this,ut).clear()}}ut=new WeakMap,k=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const l=(w=document==null?void 0:document.currentScript)==null?void 0:w.src;l&&(PDFWorkerUtil.fallbackWorkerSrc=l.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(l,c){let h;try{if(h=new URL(l),!h.origin||h.origin==="null")return!1}catch{return!1}const B=new URL(c,h);return h.origin===B.origin},PDFWorkerUtil.createCDNWrapper=function(l){const c=`importScripts("${l}");`;return URL.createObjectURL(new Blob([c]))}}const _PDFWorker=class _PDFWorker{constructor({name:l=null,port:c=null,verbosity:h=(0,_util.getVerbosityLevel)()}={}){var B;if(this.name=l,this.destroyed=!1,this.verbosity=h,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,c){if((B=t(_PDFWorker,m))!=null&&B.has(c))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,m)||lt(_PDFWorker,m,new WeakMap)).set(c,this),this._initializeFromPort(c);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(l){this._port=l,this._messageHandler=new _message_handler.MessageHandler("main","worker",l),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:l}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,l)||(l=PDFWorkerUtil.createCDNWrapper(new URL(l,window.location).href));const c=new Worker(l),h=new _message_handler.MessageHandler("main","worker",c),B=()=>{c.removeEventListener("error",a),h.destroy(),c.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},a=()=>{this._webWorker||B()};c.addEventListener("error",a),h.on("test",R=>{if(c.removeEventListener("error",a),this.destroyed){B();return}R?(this._messageHandler=h,this._port=c,this._webWorker=c,this._readyCapability.resolve(),h.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),h.destroy(),c.terminate())}),h.on("ready",R=>{if(c.removeEventListener("error",a),this.destroyed){B();return}try{E()}catch{this._setupFakeWorker()}});const E=()=>{const R=new Uint8Array;h.send("test",R,[R.buffer])};E();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(l=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const c=new LoopbackPort;this._port=c;const h=`fake${PDFWorkerUtil.fakeWorkerId++}`,B=new _message_handler.MessageHandler(h+"_worker",h,c);l.setup(B,c);const a=new _message_handler.MessageHandler(h,h+"_worker",c);this._messageHandler=a,this._readyCapability.resolve(),a.send("configure",{verbosity:this.verbosity})}).catch(l=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${l.message}".`))})}destroy(){var l;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(l=t(_PDFWorker,m))==null||l.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(l){var h;if(!(l!=null&&l.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const c=(h=t(this,m))==null?void 0:h.get(l.port);if(c){if(c._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return c}return new _PDFWorker(l)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var l;try{return((l=globalThis.pdfjsWorker)==null?void 0:l.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};m=new WeakMap,at(_PDFWorker,m);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(c,h,B,a,E){at(this,S);at(this,j,new Map);at(this,U,new Map);at(this,_,new Map);at(this,b,null);this.messageHandler=c,this.loadingTask=h,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this._params=a,this.canvasFactory=E.canvasFactory,this.filterFactory=E.filterFactory,this.cMapReaderFactory=E.cMapReaderFactory,this.standardFontDataFactory=E.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=B,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(c,h=_util.AnnotationMode.ENABLE,B=null,a=!1){let E=_util.RenderingIntentFlag.DISPLAY,R=_annotation_storage.SerializableEmpty;switch(c){case"any":E=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":E=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${c}`)}switch(h){case _util.AnnotationMode.DISABLE:E+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:E+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:E+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,R=(E&_util.RenderingIntentFlag.PRINT&&B instanceof _annotation_storage.PrintAnnotationStorage?B:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${h}`)}return a&&(E+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:E,cacheKey:`${E}_${R.hash}`,annotationStorageSerializable:R}}destroy(){var B;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(B=t(this,b))==null||B.reject(new Error("Worker was destroyed during onPassword callback"));const c=[];for(const a of t(this,U).values())c.push(a._destroy());t(this,U).clear(),t(this,_).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const h=this.messageHandler.sendWithPromise("Terminate",null);return c.push(h),Promise.all(c).then(()=>{var a;this.commonObjs.clear(),this.fontLoader.clear(),t(this,j).clear(),this.filterFactory.destroy(),(a=this._networkStream)==null||a.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:c,loadingTask:h}=this;c.on("GetReader",(B,a)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=E=>{this._lastProgress={loaded:E.loaded,total:E.total}},a.onPull=()=>{this._fullReader.read().then(function({value:E,done:R}){if(R){a.close();return}(0,_util.assert)(E instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(E),1,[E])}).catch(E=>{a.error(E)})},a.onCancel=E=>{this._fullReader.cancel(E),a.ready.catch(R=>{if(!this.destroyed)throw R})}}),c.on("ReaderHeadersReady",B=>{const a=new _util.PromiseCapability,E=this._fullReader;return E.headersReady.then(()=>{var R;(!E.isStreamingSupported||!E.isRangeSupported)&&(this._lastProgress&&((R=h.onProgress)==null||R.call(h,this._lastProgress)),E.onProgress=et=>{var V;(V=h.onProgress)==null||V.call(h,{loaded:et.loaded,total:et.total})}),a.resolve({isStreamingSupported:E.isStreamingSupported,isRangeSupported:E.isRangeSupported,contentLength:E.contentLength})},a.reject),a.promise}),c.on("GetRangeReader",(B,a)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const E=this._networkStream.getRangeReader(B.begin,B.end);if(!E){a.close();return}a.onPull=()=>{E.read().then(function({value:R,done:et}){if(et){a.close();return}(0,_util.assert)(R instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(R),1,[R])}).catch(R=>{a.error(R)})},a.onCancel=R=>{E.cancel(R),a.ready.catch(et=>{if(!this.destroyed)throw et})}}),c.on("GetDoc",({pdfInfo:B})=>{this._numPages=B.numPages,this._htmlForXfa=B.htmlForXfa,delete B.htmlForXfa,h._capability.resolve(new PDFDocumentProxy(B,this))}),c.on("DocException",function(B){let a;switch(B.name){case"PasswordException":a=new _util.PasswordException(B.message,B.code);break;case"InvalidPDFException":a=new _util.InvalidPDFException(B.message);break;case"MissingPDFException":a=new _util.MissingPDFException(B.message);break;case"UnexpectedResponseException":a=new _util.UnexpectedResponseException(B.message,B.status);break;case"UnknownErrorException":a=new _util.UnknownErrorException(B.message,B.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}h._capability.reject(a)}),c.on("PasswordRequest",B=>{if(lt(this,b,new _util.PromiseCapability),h.onPassword){const a=E=>{E instanceof Error?t(this,b).reject(E):t(this,b).resolve({password:E})};try{h.onPassword(a,B.code)}catch(E){t(this,b).reject(E)}}else t(this,b).reject(new _util.PasswordException(B.message,B.code));return t(this,b).promise}),c.on("DataLoaded",B=>{var a;(a=h.onProgress)==null||a.call(h,{loaded:B.length,total:B.length}),this.downloadInfoCapability.resolve(B)}),c.on("StartRenderPage",B=>{if(this.destroyed)return;t(this,U).get(B.pageIndex)._startRenderPage(B.transparency,B.cacheKey)}),c.on("commonobj",([B,a,E])=>{var R;if(!this.destroyed&&!this.commonObjs.has(B))switch(a){case"Font":const et=this._params;if("error"in E){const G=E.error;(0,_util.warn)(`Error during font loading: ${G}`),this.commonObjs.resolve(B,G);break}const V=et.pdfBug&&((R=globalThis.FontInspector)!=null&&R.enabled)?(G,rt)=>globalThis.FontInspector.fontAdded(G,rt):null,J=new _font_loader.FontFaceObject(E,{isEvalSupported:et.isEvalSupported,disableFontFace:et.disableFontFace,ignoreErrors:et.ignoreErrors,inspectFont:V});this.fontLoader.bind(J).catch(G=>c.sendWithPromise("FontFallback",{id:B})).finally(()=>{!et.fontExtraProperties&&J.data&&(J.data=null),this.commonObjs.resolve(B,J)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(B,E);break;default:throw new Error(`Got unknown common object type ${a}`)}}),c.on("obj",([B,a,E,R])=>{var V;if(this.destroyed)return;const et=t(this,U).get(a);if(!et.objs.has(B))switch(E){case"Image":if(et.objs.resolve(B,R),R){let J;if(R.bitmap){const{width:G,height:rt}=R;J=G*rt*4}else J=((V=R.data)==null?void 0:V.length)||0;J>_util.MAX_IMAGE_SIZE_TO_CACHE&&(et._maybeCleanupAfterRender=!0)}break;case"Pattern":et.objs.resolve(B,R);break;default:throw new Error(`Got unknown object type ${E}`)}}),c.on("DocProgress",B=>{var a;this.destroyed||(a=h.onProgress)==null||a.call(h,{loaded:B.loaded,total:B.total})}),c.on("FetchBuiltInCMap",B=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(B):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),c.on("FetchStandardFontData",B=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(B):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var B;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:c,transfers:h}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:c,filename:((B=this._fullReader)==null?void 0:B.filename)??null},h).finally(()=>{this.annotationStorage.resetModified()})}getPage(c){if(!Number.isInteger(c)||c<=0||c>this._numPages)return Promise.reject(new Error("Invalid page request."));const h=c-1,B=t(this,_).get(h);if(B)return B;const a=this.messageHandler.sendWithPromise("GetPage",{pageIndex:h}).then(E=>{if(this.destroyed)throw new Error("Transport destroyed");const R=new PDFPageProxy(h,E,this,this._params.pdfBug);return t(this,U).set(h,R),R});return t(this,_).set(h,a),a}getPageIndex(c){return typeof c!="object"||c===null||!Number.isInteger(c.num)||c.num<0||!Number.isInteger(c.gen)||c.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:c.num,gen:c.gen})}getAnnotations(c,h){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:c,intent:h})}getFieldObjects(){return K(this,S,Ae).call(this,"GetFieldObjects")}hasJSActions(){return K(this,S,Ae).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(c){return typeof c!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:c})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return K(this,S,Ae).call(this,"GetDocJSActions")}getPageJSActions(c){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:c})}getStructTree(c){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:c})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(c=>new _optional_content_config.OptionalContentConfig(c))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const c="GetMetadata",h=t(this,j).get(c);if(h)return h;const B=this.messageHandler.sendWithPromise(c,null).then(a=>{var E,R;return{info:a[0],metadata:a[1]?new _metadata.Metadata(a[1]):null,contentDispositionFilename:((E=this._fullReader)==null?void 0:E.filename)??null,contentLength:((R=this._fullReader)==null?void 0:R.contentLength)??null}});return t(this,j).set(c,B),B}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(c=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const h of t(this,U).values())if(!h.cleanup())throw new Error(`startCleanup: Page ${h.pageNumber} is currently rendering.`);this.commonObjs.clear(),c||this.fontLoader.clear(),t(this,j).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:c,enableXfa:h}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:c,enableXfa:h})}}j=new WeakMap,U=new WeakMap,_=new WeakMap,b=new WeakMap,S=new WeakSet,Ae=function(c,h=null){const B=t(this,j).get(c);if(B)return B;const a=this.messageHandler.sendWithPromise(c,h);return t(this,j).set(c,a),a};class PDFObjects{constructor(){at(this,A);at(this,f,Object.create(null))}get(c,h=null){if(h){const a=K(this,A,Le).call(this,c);return a.capability.promise.then(()=>h(a.data)),null}const B=t(this,f)[c];if(!(B!=null&&B.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${c}.`);return B.data}has(c){const h=t(this,f)[c];return(h==null?void 0:h.capability.settled)||!1}resolve(c,h=null){const B=K(this,A,Le).call(this,c);B.data=h,B.capability.resolve()}clear(){var c;for(const h in t(this,f)){const{data:B}=t(this,f)[h];(c=B==null?void 0:B.bitmap)==null||c.close()}lt(this,f,Object.create(null))}}f=new WeakMap,A=new WeakSet,Le=function(c){var h;return(h=t(this,f))[c]||(h[c]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(c){at(this,v,null);lt(this,v,c),this.onContinue=null}get promise(){return t(this,v).capability.promise}cancel(c=0){t(this,v).cancel(null,c)}get separateAnnots(){const{separateAnnots:c}=t(this,v).operatorList;if(!c)return!1;const{annotationCanvasMap:h}=t(this,v);return c.form||c.canvas&&(h==null?void 0:h.size)>0}}v=new WeakMap,exports.RenderTask=RenderTask;const d=class d{constructor({callback:c,params:h,objs:B,commonObjs:a,annotationCanvasMap:E,operatorList:R,pageIndex:et,canvasFactory:V,filterFactory:J,useRequestAnimationFrame:G=!1,pdfBug:rt=!1,pageColors:C=null}){this.callback=c,this.params=h,this.objs=B,this.commonObjs=a,this.annotationCanvasMap=E,this.operatorListIdx=null,this.operatorList=R,this._pageIndex=et,this.canvasFactory=V,this.filterFactory=J,this._pdfBug=rt,this.pageColors=C,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=G===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=h.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:c=!1,optionalContentConfig:h}){var et,V;if(this.cancelled)return;if(this._canvas){if(t(d,o).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(d,o).add(this._canvas)}this._pdfBug&&((et=globalThis.StepperManager)!=null&&et.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:B,viewport:a,transform:E,background:R}=this.params;this.gfx=new _canvas.CanvasGraphics(B,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:h},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:E,viewport:a,transparency:c,background:R}),this.operatorListIdx=0,this.graphicsReady=!0,(V=this.graphicsReadyCallback)==null||V.call(this)}cancel(c=null,h=0){var B;this.running=!1,this.cancelled=!0,(B=this.gfx)==null||B.endDrawing(),t(d,o).delete(this._canvas),this.callback(c||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,h))}operatorListChanged(){var c;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(c=this.stepper)==null||c.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(d,o).delete(this._canvas),this.callback())))}};o=new WeakMap,at(d,o,new WeakSet);let InternalRenderTask=d;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(x,e,N)=>{var w,m,j,bn,_;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var n=N(1),u=N(4),z=N(8);const H=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=H;class ut{constructor(){at(this,j);at(this,w,!1);at(this,m,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(S,g){const f=t(this,m).get(S);return f===void 0?g:Object.assign(g,f)}getRawValue(S){return t(this,m).get(S)}remove(S){if(t(this,m).delete(S),t(this,m).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const g of t(this,m).values())if(g instanceof u.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(S,g){const f=t(this,m).get(S);let A=!1;if(f!==void 0)for(const[L,v]of Object.entries(g))f[L]!==v&&(A=!0,f[L]=v);else A=!0,t(this,m).set(S,g);A&&K(this,j,bn).call(this),g instanceof u.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(g.constructor._type)}has(S){return t(this,m).has(S)}getAll(){return t(this,m).size>0?(0,n.objectFromMap)(t(this,m)):null}setAll(S){for(const[g,f]of Object.entries(S))this.setValue(g,f)}get size(){return t(this,m).size}resetModified(){t(this,w)&&(lt(this,w,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new k(this)}get serializable(){if(t(this,m).size===0)return H;const S=new Map,g=new z.MurmurHash3_64,f=[],A=Object.create(null);let L=!1;for(const[v,o]of t(this,m)){const d=o instanceof u.AnnotationEditor?o.serialize(!1,A):o;d&&(S.set(v,d),g.update(`${v}:${JSON.stringify(d)}`),L||(L=!!d.bitmap))}if(L)for(const v of S.values())v.bitmap&&f.push(v.bitmap);return S.size>0?{map:S,hash:g.hexdigest(),transfers:f}:H}}w=new WeakMap,m=new WeakMap,j=new WeakSet,bn=function(){t(this,w)||(lt(this,w,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=ut;class k extends ut{constructor(g){super();at(this,_);const{map:f,hash:A,transfers:L}=g.serializable,v=structuredClone(f,L?{transfer:L}:null);lt(this,_,{map:v,hash:A,transfers:L})}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,_)}}_=new WeakMap,e.PrintAnnotationStorage=k},(x,e,N)=>{var k,w,m,j,U,_,b,S,g,f,A,L,v,o,d,Oe,Ie,h,Ne,Be,yn,_n,An,Ue,vn;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var n=N(5),u=N(1),z=N(6);const G=class G{constructor(C){at(this,d);at(this,k,"");at(this,w,!1);at(this,m,null);at(this,j,null);at(this,U,null);at(this,_,!1);at(this,b,null);at(this,S,this.focusin.bind(this));at(this,g,this.focusout.bind(this));at(this,f,!1);at(this,A,!1);at(this,L,!1);Jt(this,"_initialOptions",Object.create(null));Jt(this,"_uiManager",null);Jt(this,"_focusEventsAllowed",!0);Jt(this,"_l10nPromise",null);at(this,v,!1);at(this,o,G._zIndex++);this.constructor===G&&(0,u.unreachable)("Cannot initialize AnnotationEditor."),this.parent=C.parent,this.id=C.id,this.width=this.height=null,this.pageIndex=C.parent.pageIndex,this.name=C.name,this.div=null,this._uiManager=C.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=C.isCentered,this._structTreeParentId=null;const{rotation:$,rawDims:{pageWidth:nt,pageHeight:T,pageX:s,pageY:i}}=this.parent.viewport;this.rotation=$,this.pageRotation=(360+$-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[nt,T],this.pageTranslation=[s,i];const[p,M]=this.parentDimensions;this.x=C.x/p,this.y=C.y/M,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,u.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(C){const $=new ut({id:C.parent.getNextId(),parent:C.parent,uiManager:C._uiManager});$.annotationElementId=C.annotationElementId,$.deleted=!0,$._uiManager.addToAnnotationStorage($)}static initialize(C,$=null){if(G._l10nPromise||(G._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(T=>[T,C.get(T)]))),$!=null&&$.strings)for(const T of $.strings)G._l10nPromise.set(T,C.get(T));if(G._borderLineWidth!==-1)return;const nt=getComputedStyle(document.documentElement);G._borderLineWidth=parseFloat(nt.getPropertyValue("--outline-width"))||0}static updateDefaultParams(C,$){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(C){return!1}static paste(C,$){(0,u.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,v)}set _isDraggable(C){var $;lt(this,v,C),($=this.div)==null||$.classList.toggle("draggable",C)}center(){const[C,$]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*$/(C*2),this.y+=this.width*C/($*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*$/(C*2),this.y-=this.width*C/($*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(C){this._uiManager.addCommands(C)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,o)}setParent(C){C!==null&&(this.pageIndex=C.pageIndex,this.pageDimensions=C.pageDimensions),this.parent=C}focusin(C){this._focusEventsAllowed&&(t(this,f)?lt(this,f,!1):this.parent.setSelected(this))}focusout(C){var nt;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const $=C.relatedTarget;$!=null&&$.closest(`#${this.id}`)||(C.preventDefault(),(nt=this.parent)!=null&&nt.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(C,$,nt,T){const[s,i]=this.parentDimensions;[nt,T]=this.screenToPageTranslation(nt,T),this.x=(C+nt)/s,this.y=($+T)/i,this.fixAndSetPosition()}translate(C,$){K(this,d,Oe).call(this,this.parentDimensions,C,$)}translateInPage(C,$){K(this,d,Oe).call(this,this.pageDimensions,C,$),this.div.scrollIntoView({block:"nearest"})}drag(C,$){const[nt,T]=this.parentDimensions;if(this.x+=C/nt,this.y+=$/T,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:D,y:O}=this.div.getBoundingClientRect();this.parent.findNewParent(this,D,O)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:i}=this;const[p,M]=K(this,d,Ie).call(this);s+=p,i+=M,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*i).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[C,$]=this.pageDimensions;let{x:nt,y:T,width:s,height:i}=this;switch(s*=C,i*=$,nt*=C,T*=$,this.rotation){case 0:nt=Math.max(0,Math.min(C-s,nt)),T=Math.max(0,Math.min($-i,T));break;case 90:nt=Math.max(0,Math.min(C-i,nt)),T=Math.min($,Math.max(s,T));break;case 180:nt=Math.min(C,Math.max(s,nt)),T=Math.min($,Math.max(i,T));break;case 270:nt=Math.min(C,Math.max(i,nt)),T=Math.max(0,Math.min($-s,T));break}this.x=nt/=C,this.y=T/=$;const[p,M]=K(this,d,Ie).call(this);nt+=p,T+=M;const{style:D}=this.div;D.left=`${(100*nt).toFixed(2)}%`,D.top=`${(100*T).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(C,$){var nt;return K(nt=G,h,Ne).call(nt,C,$,this.parentRotation)}pageTranslationToScreen(C,$){var nt;return K(nt=G,h,Ne).call(nt,C,$,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:C,pageDimensions:[$,nt]}=this,T=$*C,s=nt*C;return u.FeatureTest.isCSSRoundSupported?[Math.round(T),Math.round(s)]:[T,s]}setDims(C,$){var s;const[nt,T]=this.parentDimensions;this.div.style.width=`${(100*C/nt).toFixed(2)}%`,t(this,_)||(this.div.style.height=`${(100*$/T).toFixed(2)}%`),(s=t(this,m))==null||s.classList.toggle("small",C<G.SMALL_EDITOR_SIZE||$<G.SMALL_EDITOR_SIZE)}fixDims(){const{style:C}=this.div,{height:$,width:nt}=C,T=nt.endsWith("%"),s=!t(this,_)&&$.endsWith("%");if(T&&s)return;const[i,p]=this.parentDimensions;T||(C.width=`${(100*parseFloat(nt)/i).toFixed(2)}%`),!t(this,_)&&!s&&(C.height=`${(100*parseFloat($)/p).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,m))return;const C=lt(this,m,document.createElement("button"));C.className="altText";const $=await G._l10nPromise.get("editor_alt_text_button_label");C.textContent=$,C.setAttribute("aria-label",$),C.tabIndex="0",C.addEventListener("contextmenu",z.noContextMenu),C.addEventListener("pointerdown",nt=>nt.stopPropagation()),C.addEventListener("click",nt=>{nt.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),C.addEventListener("keydown",nt=>{nt.target===C&&nt.key==="Enter"&&(nt.preventDefault(),this._uiManager.editAltText(this))}),K(this,d,Ue).call(this),this.div.append(C),G.SMALL_EDITOR_SIZE||(G.SMALL_EDITOR_SIZE=Math.min(128,Math.round(C.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,k),decorative:t(this,w)}}set altTextData({altText:C,decorative:$}){t(this,k)===C&&t(this,w)===$||(lt(this,k,C),lt(this,w,$),K(this,d,Ue).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,S)),this.div.addEventListener("focusout",t(this,g));const[C,$]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*$/C).toFixed(2)}%`,this.div.style.maxHeight=`${(100*C/$).toFixed(2)}%`);const[nt,T]=this.getInitialTranslation();return this.translate(nt,T),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(C){const{isMac:$}=u.FeatureTest.platform;if(C.button!==0||C.ctrlKey&&$){C.preventDefault();return}lt(this,f,!0),K(this,d,vn).call(this,C)}moveInDOM(){var C;(C=this.parent)==null||C.moveEditorInDOM(this)}_setParentAndPosition(C,$,nt){C.changeParent(this),this.x=$,this.y=nt,this.fixAndSetPosition()}getRect(C,$){const nt=this.parentScale,[T,s]=this.pageDimensions,[i,p]=this.pageTranslation,M=C/nt,D=$/nt,O=this.x*T,q=this.y*s,st=this.width*T,ht=this.height*s;switch(this.rotation){case 0:return[O+M+i,s-q-D-ht+p,O+M+st+i,s-q-D+p];case 90:return[O+D+i,s-q+M+p,O+D+ht+i,s-q+M+st+p];case 180:return[O-M-st+i,s-q+D+p,O-M+i,s-q+D+ht+p];case 270:return[O-D-ht+i,s-q-M-st+p,O-D+i,s-q-M+p];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(C,$){const[nt,T,s,i]=C,p=s-nt,M=i-T;switch(this.rotation){case 0:return[nt,$-i,p,M];case 90:return[nt,$-T,M,p];case 180:return[s,$-T,p,M];case 270:return[s,$-i,M,p];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){lt(this,L,!0)}disableEditMode(){lt(this,L,!1)}isInEditMode(){return t(this,L)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var C,$;(C=this.div)==null||C.addEventListener("focusin",t(this,S)),($=this.div)==null||$.addEventListener("focusout",t(this,g))}serialize(C=!1,$=null){(0,u.unreachable)("An editor must be serializable")}static deserialize(C,$,nt){const T=new this.prototype.constructor({parent:$,id:$.getNextId(),uiManager:nt});T.rotation=C.rotation;const[s,i]=T.pageDimensions,[p,M,D,O]=T.getRectInCurrentCoords(C.rect,i);return T.x=p/s,T.y=M/i,T.width=D/s,T.height=O/i,T}remove(){var C;this.div.removeEventListener("focusin",t(this,S)),this.div.removeEventListener("focusout",t(this,g)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(C=t(this,m))==null||C.remove(),lt(this,m,null),lt(this,j,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(K(this,d,yn).call(this),t(this,b).classList.remove("hidden"))}select(){var C;this.makeResizable(),(C=this.div)==null||C.classList.add("selectedEditor")}unselect(){var C,$,nt;(C=t(this,b))==null||C.classList.add("hidden"),($=this.div)==null||$.classList.remove("selectedEditor"),(nt=this.div)!=null&&nt.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(C,$){}disableEditing(){t(this,m)&&(t(this,m).hidden=!0)}enableEditing(){t(this,m)&&(t(this,m).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,A)}set isEditing(C){lt(this,A,C),this.parent&&(C?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(C,$){lt(this,_,!0);const nt=C/$,{style:T}=this.div;T.aspectRatio=nt,T.height="auto"}static get MIN_SIZE(){return 16}};k=new WeakMap,w=new WeakMap,m=new WeakMap,j=new WeakMap,U=new WeakMap,_=new WeakMap,b=new WeakMap,S=new WeakMap,g=new WeakMap,f=new WeakMap,A=new WeakMap,L=new WeakMap,v=new WeakMap,o=new WeakMap,d=new WeakSet,Oe=function([C,$],nt,T){[nt,T]=this.screenToPageTranslation(nt,T),this.x+=nt/C,this.y+=T/$,this.fixAndSetPosition()},Ie=function(){const[C,$]=this.parentDimensions,{_borderLineWidth:nt}=G,T=nt/C,s=nt/$;switch(this.rotation){case 90:return[-T,s];case 180:return[T,s];case 270:return[T,-s];default:return[-T,-s]}},h=new WeakSet,Ne=function(C,$,nt){switch(nt){case 90:return[$,-C];case 180:return[-C,-$];case 270:return[-$,C];default:return[C,$]}},Be=function(C){switch(C){case 90:{const[$,nt]=this.pageDimensions;return[0,-$/nt,nt/$,0]}case 180:return[-1,0,0,-1];case 270:{const[$,nt]=this.pageDimensions;return[0,$/nt,-nt/$,0]}default:return[1,0,0,1]}},yn=function(){if(t(this,b))return;lt(this,b,document.createElement("div")),t(this,b).classList.add("resizers");const C=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||C.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const $ of C){const nt=document.createElement("div");t(this,b).append(nt),nt.classList.add("resizer",$),nt.addEventListener("pointerdown",K(this,d,_n).bind(this,$)),nt.addEventListener("contextmenu",z.noContextMenu)}this.div.prepend(t(this,b))},_n=function(C,$){$.preventDefault();const{isMac:nt}=u.FeatureTest.platform;if($.button!==0||$.ctrlKey&&nt)return;const T=K(this,d,An).bind(this,C),s=this._isDraggable;this._isDraggable=!1;const i={passive:!0,capture:!0};window.addEventListener("pointermove",T,i);const p=this.x,M=this.y,D=this.width,O=this.height,q=this.parent.div.style.cursor,st=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle($.target).cursor;const ht=()=>{this._isDraggable=s,window.removeEventListener("pointerup",ht),window.removeEventListener("blur",ht),window.removeEventListener("pointermove",T,i),this.parent.div.style.cursor=q,this.div.style.cursor=st;const pt=this.x,yt=this.y,bt=this.width,_t=this.height;pt===p&&yt===M&&bt===D&&_t===O||this.addCommands({cmd:()=>{this.width=bt,this.height=_t,this.x=pt,this.y=yt;const[Q,Z]=this.parentDimensions;this.setDims(Q*bt,Z*_t),this.fixAndSetPosition()},undo:()=>{this.width=D,this.height=O,this.x=p,this.y=M;const[Q,Z]=this.parentDimensions;this.setDims(Q*D,Z*O),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",ht),window.addEventListener("blur",ht)},An=function(C,$){const[nt,T]=this.parentDimensions,s=this.x,i=this.y,p=this.width,M=this.height,D=G.MIN_SIZE/nt,O=G.MIN_SIZE/T,q=Ft=>Math.round(Ft*1e4)/1e4,st=K(this,d,Be).call(this,this.rotation),ht=(Ft,It)=>[st[0]*Ft+st[2]*It,st[1]*Ft+st[3]*It],pt=K(this,d,Be).call(this,360-this.rotation),yt=(Ft,It)=>[pt[0]*Ft+pt[2]*It,pt[1]*Ft+pt[3]*It];let bt,_t,Q=!1,Z=!1;switch(C){case"topLeft":Q=!0,bt=(Ft,It)=>[0,0],_t=(Ft,It)=>[Ft,It];break;case"topMiddle":bt=(Ft,It)=>[Ft/2,0],_t=(Ft,It)=>[Ft/2,It];break;case"topRight":Q=!0,bt=(Ft,It)=>[Ft,0],_t=(Ft,It)=>[0,It];break;case"middleRight":Z=!0,bt=(Ft,It)=>[Ft,It/2],_t=(Ft,It)=>[0,It/2];break;case"bottomRight":Q=!0,bt=(Ft,It)=>[Ft,It],_t=(Ft,It)=>[0,0];break;case"bottomMiddle":bt=(Ft,It)=>[Ft/2,It],_t=(Ft,It)=>[Ft/2,0];break;case"bottomLeft":Q=!0,bt=(Ft,It)=>[0,It],_t=(Ft,It)=>[Ft,0];break;case"middleLeft":Z=!0,bt=(Ft,It)=>[0,It/2],_t=(Ft,It)=>[Ft,It/2];break}const y=bt(p,M),I=_t(p,M);let Y=ht(...I);const it=q(s+Y[0]),gt=q(i+Y[1]);let St=1,vt=1,[tt,wt]=this.screenToPageTranslation($.movementX,$.movementY);if([tt,wt]=yt(tt/nt,wt/T),Q){const Ft=Math.hypot(p,M);St=vt=Math.max(Math.min(Math.hypot(I[0]-y[0]-tt,I[1]-y[1]-wt)/Ft,1/p,1/M),D/p,O/M)}else Z?St=Math.max(D,Math.min(1,Math.abs(I[0]-y[0]-tt)))/p:vt=Math.max(O,Math.min(1,Math.abs(I[1]-y[1]-wt)))/M;const Pt=q(p*St),Wt=q(M*vt);Y=ht(..._t(Pt,Wt));const Ut=it-Y[0],zt=gt-Y[1];this.width=Pt,this.height=Wt,this.x=Ut,this.y=zt,this.setDims(nt*Pt,T*Wt),this.fixAndSetPosition()},Ue=async function(){var nt;const C=t(this,m);if(!C)return;if(!t(this,k)&&!t(this,w)){C.classList.remove("done"),(nt=t(this,j))==null||nt.remove();return}G._l10nPromise.get("editor_alt_text_edit_button_label").then(T=>{C.setAttribute("aria-label",T)});let $=t(this,j);if(!$){lt(this,j,$=document.createElement("span")),$.className="tooltip",$.setAttribute("role","tooltip");const T=$.id=`alt-text-tooltip-${this.id}`;C.setAttribute("aria-describedby",T);const s=100;C.addEventListener("mouseenter",()=>{lt(this,U,setTimeout(()=>{lt(this,U,null),t(this,j).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},s))}),C.addEventListener("mouseleave",()=>{var i;clearTimeout(t(this,U)),lt(this,U,null),(i=t(this,j))==null||i.classList.remove("show")})}C.classList.add("done"),$.innerText=t(this,w)?await G._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,k),$.parentNode||C.append($)},vn=function(C){if(!this._isDraggable)return;const $=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let nt,T;$&&(nt={passive:!0,capture:!0},T=i=>{const[p,M]=this.screenToPageTranslation(i.movementX,i.movementY);this._uiManager.dragSelectedEditors(p,M)},window.addEventListener("pointermove",T,nt));const s=()=>{if(window.removeEventListener("pointerup",s),window.removeEventListener("blur",s),$&&window.removeEventListener("pointermove",T,nt),lt(this,f,!1),!this._uiManager.endDragSession()){const{isMac:i}=u.FeatureTest.platform;C.ctrlKey&&!i||C.shiftKey||C.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",s),window.addEventListener("blur",s)},at(G,h),Jt(G,"_borderLineWidth",-1),Jt(G,"_colorManager",new n.ColorManager),Jt(G,"_zIndex",1),Jt(G,"SMALL_EDITOR_SIZE",0);let H=G;e.AnnotationEditor=H;class ut extends H{constructor(C){super(C),this.annotationElementId=C.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(x,e,N)=>{var _,b,S,g,f,je,v,o,d,l,c,En,a,E,R,et,V,J,G,rt,C,$,nt,T,s,i,p,M,D,O,q,st,ht,pt,yt,bt,_t,Q,Z,y,I,Y,it,gt,St,vt,tt,Sn,We,He,ve,Ge,$e,te,ue,Tn,Pn,Ve,fe,ze;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=z,e.opacityToHex=H;var n=N(1),u=N(6);function z(Vt,W,mt){for(const Ct of mt)W.addEventListener(Ct,Vt[Ct].bind(Vt))}function H(Vt){return Math.round(Math.min(255,Math.max(1,255*Vt))).toString(16).padStart(2,"0")}class ut{constructor(){at(this,_,0)}getId(){return`${n.AnnotationEditorPrefix}${de(this,_)._++}`}}_=new WeakMap;const L=class L{constructor(){at(this,f);at(this,b,(0,n.getUuid)());at(this,S,0);at(this,g,null)}static get _isSVGFittingCanvas(){const W='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Ct=new OffscreenCanvas(1,3).getContext("2d"),Lt=new Image;Lt.src=W;const Bt=Lt.decode().then(()=>(Ct.drawImage(Lt,0,0,1,1,0,0,1,3),new Uint32Array(Ct.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",Bt)}async getFromFile(W){const{lastModified:mt,name:Ct,size:Lt,type:Bt}=W;return K(this,f,je).call(this,`${mt}_${Ct}_${Lt}_${Bt}`,W)}async getFromUrl(W){return K(this,f,je).call(this,W,W)}async getFromId(W){t(this,g)||lt(this,g,new Map);const mt=t(this,g).get(W);return mt?mt.bitmap?(mt.refCounter+=1,mt):mt.file?this.getFromFile(mt.file):this.getFromUrl(mt.url):null}getSvgUrl(W){const mt=t(this,g).get(W);return mt!=null&&mt.isSvg?mt.svgUrl:null}deleteId(W){t(this,g)||lt(this,g,new Map);const mt=t(this,g).get(W);mt&&(mt.refCounter-=1,mt.refCounter===0&&(mt.bitmap=null))}isValidId(W){return W.startsWith(`image_${t(this,b)}_`)}};b=new WeakMap,S=new WeakMap,g=new WeakMap,f=new WeakSet,je=async function(W,mt){t(this,g)||lt(this,g,new Map);let Ct=t(this,g).get(W);if(Ct===null)return null;if(Ct!=null&&Ct.bitmap)return Ct.refCounter+=1,Ct;try{Ct||(Ct={bitmap:null,id:`image_${t(this,b)}_${de(this,S)._++}`,refCounter:0,isSvg:!1});let Lt;if(typeof mt=="string"){Ct.url=mt;const Bt=await fetch(mt);if(!Bt.ok)throw new Error(Bt.statusText);Lt=await Bt.blob()}else Lt=Ct.file=mt;if(Lt.type==="image/svg+xml"){const Bt=L._isSVGFittingCanvas,Rt=new FileReader,F=new Image,P=new Promise((X,dt)=>{F.onload=()=>{Ct.bitmap=F,Ct.isSvg=!0,X()},Rt.onload=async()=>{const ft=Ct.svgUrl=Rt.result;F.src=await Bt?`${ft}#svgView(preserveAspectRatio(none))`:ft},F.onerror=Rt.onerror=dt});Rt.readAsDataURL(Lt),await P}else Ct.bitmap=await createImageBitmap(Lt);Ct.refCounter=1}catch(Lt){console.error(Lt),Ct=null}return t(this,g).set(W,Ct),Ct&&t(this,g).set(Ct.id,Ct),Ct};let k=L;class w{constructor(W=128){at(this,v,[]);at(this,o,!1);at(this,d);at(this,l,-1);lt(this,d,W)}add({cmd:W,undo:mt,mustExec:Ct,type:Lt=NaN,overwriteIfSameType:Bt=!1,keepUndo:Rt=!1}){if(Ct&&W(),t(this,o))return;const F={cmd:W,undo:mt,type:Lt};if(t(this,l)===-1){t(this,v).length>0&&(t(this,v).length=0),lt(this,l,0),t(this,v).push(F);return}if(Bt&&t(this,v)[t(this,l)].type===Lt){Rt&&(F.undo=t(this,v)[t(this,l)].undo),t(this,v)[t(this,l)]=F;return}const P=t(this,l)+1;P===t(this,d)?t(this,v).splice(0,1):(lt(this,l,P),P<t(this,v).length&&t(this,v).splice(P)),t(this,v).push(F)}undo(){t(this,l)!==-1&&(lt(this,o,!0),t(this,v)[t(this,l)].undo(),lt(this,o,!1),lt(this,l,t(this,l)-1))}redo(){t(this,l)<t(this,v).length-1&&(lt(this,l,t(this,l)+1),lt(this,o,!0),t(this,v)[t(this,l)].cmd(),lt(this,o,!1))}hasSomethingToUndo(){return t(this,l)!==-1}hasSomethingToRedo(){return t(this,l)<t(this,v).length-1}destroy(){lt(this,v,null)}}v=new WeakMap,o=new WeakMap,d=new WeakMap,l=new WeakMap,e.CommandManager=w;class m{constructor(W){at(this,c);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:mt}=n.FeatureTest.platform;for(const[Ct,Lt,Bt={}]of W)for(const Rt of Ct){const F=Rt.startsWith("mac+");mt&&F?(this.callbacks.set(Rt.slice(4),{callback:Lt,options:Bt}),this.allKeys.add(Rt.split("+").at(-1))):!mt&&!F&&(this.callbacks.set(Rt,{callback:Lt,options:Bt}),this.allKeys.add(Rt.split("+").at(-1)))}}exec(W,mt){if(!this.allKeys.has(mt.key))return;const Ct=this.callbacks.get(K(this,c,En).call(this,mt));if(!Ct)return;const{callback:Lt,options:{bubbles:Bt=!1,args:Rt=[],checker:F=null}}=Ct;F&&!F(W,mt)||(Lt.bind(W,...Rt)(),Bt||(mt.stopPropagation(),mt.preventDefault()))}}c=new WeakSet,En=function(W){W.altKey&&this.buffer.push("alt"),W.ctrlKey&&this.buffer.push("ctrl"),W.metaKey&&this.buffer.push("meta"),W.shiftKey&&this.buffer.push("shift"),this.buffer.push(W.key);const mt=this.buffer.join("+");return this.buffer.length=0,mt},e.KeyboardManager=m;const B=class B{get _colors(){const W=new Map([["CanvasText",null],["Canvas",null]]);return(0,u.getColorValues)(W),(0,n.shadow)(this,"_colors",W)}convert(W){const mt=(0,u.getRGB)(W);if(!window.matchMedia("(forced-colors: active)").matches)return mt;for(const[Ct,Lt]of this._colors)if(Lt.every((Bt,Rt)=>Bt===mt[Rt]))return B._colorsMapping.get(Ct);return mt}getHexCode(W){const mt=this._colors.get(W);return mt?n.Util.makeHexColor(...mt):W}};Jt(B,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let j=B;e.ColorManager=j;const Xt=class Xt{constructor(W,mt,Ct,Lt,Bt,Rt){at(this,tt);at(this,a,null);at(this,E,new Map);at(this,R,new Map);at(this,et,null);at(this,V,null);at(this,J,new w);at(this,G,0);at(this,rt,new Set);at(this,C,null);at(this,$,null);at(this,nt,new Set);at(this,T,null);at(this,s,new ut);at(this,i,!1);at(this,p,!1);at(this,M,null);at(this,D,n.AnnotationEditorType.NONE);at(this,O,new Set);at(this,q,null);at(this,st,this.blur.bind(this));at(this,ht,this.focus.bind(this));at(this,pt,this.copy.bind(this));at(this,yt,this.cut.bind(this));at(this,bt,this.paste.bind(this));at(this,_t,this.keydown.bind(this));at(this,Q,this.onEditingAction.bind(this));at(this,Z,this.onPageChanging.bind(this));at(this,y,this.onScaleChanging.bind(this));at(this,I,this.onRotationChanging.bind(this));at(this,Y,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});at(this,it,[0,0]);at(this,gt,null);at(this,St,null);at(this,vt,null);lt(this,St,W),lt(this,vt,mt),lt(this,et,Ct),this._eventBus=Lt,this._eventBus._on("editingaction",t(this,Q)),this._eventBus._on("pagechanging",t(this,Z)),this._eventBus._on("scalechanging",t(this,y)),this._eventBus._on("rotationchanging",t(this,I)),lt(this,V,Bt.annotationStorage),lt(this,T,Bt.filterFactory),lt(this,q,Rt),this.viewParameters={realScale:u.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const W=Xt.prototype,mt=Bt=>{const{activeElement:Rt}=document;return Rt&&t(Bt,St).contains(Rt)&&Bt.hasSomethingToControl()},Ct=this.TRANSLATE_SMALL,Lt=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new m([[["ctrl+a","mac+meta+a"],W.selectAll],[["ctrl+z","mac+meta+z"],W.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],W.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],W.delete],[["Escape","mac+Escape"],W.unselectAll],[["ArrowLeft","mac+ArrowLeft"],W.translateSelectedEditors,{args:[-Ct,0],checker:mt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],W.translateSelectedEditors,{args:[-Lt,0],checker:mt}],[["ArrowRight","mac+ArrowRight"],W.translateSelectedEditors,{args:[Ct,0],checker:mt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],W.translateSelectedEditors,{args:[Lt,0],checker:mt}],[["ArrowUp","mac+ArrowUp"],W.translateSelectedEditors,{args:[0,-Ct],checker:mt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],W.translateSelectedEditors,{args:[0,-Lt],checker:mt}],[["ArrowDown","mac+ArrowDown"],W.translateSelectedEditors,{args:[0,Ct],checker:mt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],W.translateSelectedEditors,{args:[0,Lt],checker:mt}]]))}destroy(){K(this,tt,ve).call(this),K(this,tt,We).call(this),this._eventBus._off("editingaction",t(this,Q)),this._eventBus._off("pagechanging",t(this,Z)),this._eventBus._off("scalechanging",t(this,y)),this._eventBus._off("rotationchanging",t(this,I));for(const W of t(this,R).values())W.destroy();t(this,R).clear(),t(this,E).clear(),t(this,nt).clear(),lt(this,a,null),t(this,O).clear(),t(this,J).destroy(),t(this,et).destroy()}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",t(this,q)?t(this,T).addHCMFilter(t(this,q).foreground,t(this,q).background):"none")}get direction(){return(0,n.shadow)(this,"direction",getComputedStyle(t(this,St)).direction)}editAltText(W){var mt;(mt=t(this,et))==null||mt.editAltText(this,W)}onPageChanging({pageNumber:W}){lt(this,G,W-1)}focusMainContainer(){t(this,St).focus()}findParent(W,mt){for(const Ct of t(this,R).values()){const{x:Lt,y:Bt,width:Rt,height:F}=Ct.div.getBoundingClientRect();if(W>=Lt&&W<=Lt+Rt&&mt>=Bt&&mt<=Bt+F)return Ct}return null}disableUserSelect(W=!1){t(this,vt).classList.toggle("noUserSelect",W)}addShouldRescale(W){t(this,nt).add(W)}removeShouldRescale(W){t(this,nt).delete(W)}onScaleChanging({scale:W}){this.commitOrRemove(),this.viewParameters.realScale=W*u.PixelsPerInch.PDF_TO_CSS_UNITS;for(const mt of t(this,nt))mt.onScaleChanging()}onRotationChanging({pagesRotation:W}){this.commitOrRemove(),this.viewParameters.rotation=W}addToAnnotationStorage(W){!W.isEmpty()&&t(this,V)&&!t(this,V).has(W.id)&&t(this,V).setValue(W.id,W)}blur(){if(!this.hasSelection)return;const{activeElement:W}=document;for(const mt of t(this,O))if(mt.div.contains(W)){lt(this,M,[mt,W]),mt._focusEventsAllowed=!1;break}}focus(){if(!t(this,M))return;const[W,mt]=t(this,M);lt(this,M,null),mt.addEventListener("focusin",()=>{W._focusEventsAllowed=!0},{once:!0}),mt.focus()}addEditListeners(){K(this,tt,He).call(this),K(this,tt,Ge).call(this)}removeEditListeners(){K(this,tt,ve).call(this),K(this,tt,$e).call(this)}copy(W){var Ct;if(W.preventDefault(),(Ct=t(this,a))==null||Ct.commitOrRemove(),!this.hasSelection)return;const mt=[];for(const Lt of t(this,O)){const Bt=Lt.serialize(!0);Bt&&mt.push(Bt)}mt.length!==0&&W.clipboardData.setData("application/pdfjs",JSON.stringify(mt))}cut(W){this.copy(W),this.delete()}paste(W){W.preventDefault();const{clipboardData:mt}=W;for(const Bt of mt.items)for(const Rt of t(this,$))if(Rt.isHandlingMimeForPasting(Bt.type)){Rt.paste(Bt,this.currentLayer);return}let Ct=mt.getData("application/pdfjs");if(!Ct)return;try{Ct=JSON.parse(Ct)}catch(Bt){(0,n.warn)(`paste: "${Bt.message}".`);return}if(!Array.isArray(Ct))return;this.unselectAll();const Lt=this.currentLayer;try{const Bt=[];for(const P of Ct){const X=Lt.deserialize(P);if(!X)return;Bt.push(X)}const Rt=()=>{for(const P of Bt)K(this,tt,Ve).call(this,P);K(this,tt,ze).call(this,Bt)},F=()=>{for(const P of Bt)P.remove()};this.addCommands({cmd:Rt,undo:F,mustExec:!0})}catch(Bt){(0,n.warn)(`paste: "${Bt.message}".`)}}keydown(W){var mt;(mt=this.getActive())!=null&&mt.shouldGetKeyboardEvents()||Xt._keyboardManager.exec(this,W)}onEditingAction(W){["undo","redo","delete","selectAll"].includes(W.name)&&this[W.name]()}setEditingState(W){W?(K(this,tt,Sn).call(this),K(this,tt,He).call(this),K(this,tt,Ge).call(this),K(this,tt,te).call(this,{isEditing:t(this,D)!==n.AnnotationEditorType.NONE,isEmpty:K(this,tt,fe).call(this),hasSomethingToUndo:t(this,J).hasSomethingToUndo(),hasSomethingToRedo:t(this,J).hasSomethingToRedo(),hasSelectedEditor:!1})):(K(this,tt,We).call(this),K(this,tt,ve).call(this),K(this,tt,$e).call(this),K(this,tt,te).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(W){if(!t(this,$)){lt(this,$,W);for(const mt of t(this,$))K(this,tt,ue).call(this,mt.defaultPropertiesToUpdate)}}getId(){return t(this,s).getId()}get currentLayer(){return t(this,R).get(t(this,G))}getLayer(W){return t(this,R).get(W)}get currentPageIndex(){return t(this,G)}addLayer(W){t(this,R).set(W.pageIndex,W),t(this,i)?W.enable():W.disable()}removeLayer(W){t(this,R).delete(W.pageIndex)}updateMode(W,mt=null){if(t(this,D)!==W){if(lt(this,D,W),W===n.AnnotationEditorType.NONE){this.setEditingState(!1),K(this,tt,Pn).call(this);return}this.setEditingState(!0),K(this,tt,Tn).call(this),this.unselectAll();for(const Ct of t(this,R).values())Ct.updateMode(W);if(mt){for(const Ct of t(this,E).values())if(Ct.annotationElementId===mt){this.setSelected(Ct),Ct.enterInEditMode();break}}}}updateToolbar(W){W!==t(this,D)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:W})}updateParams(W,mt){if(t(this,$)){if(W===n.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(W);return}for(const Ct of t(this,O))Ct.updateParams(W,mt);for(const Ct of t(this,$))Ct.updateDefaultParams(W,mt)}}enableWaiting(W=!1){if(t(this,p)!==W){lt(this,p,W);for(const mt of t(this,R).values())W?mt.disableClick():mt.enableClick(),mt.div.classList.toggle("waiting",W)}}getEditors(W){const mt=[];for(const Ct of t(this,E).values())Ct.pageIndex===W&&mt.push(Ct);return mt}getEditor(W){return t(this,E).get(W)}addEditor(W){t(this,E).set(W.id,W)}removeEditor(W){var mt;t(this,E).delete(W.id),this.unselect(W),(!W.annotationElementId||!t(this,rt).has(W.annotationElementId))&&((mt=t(this,V))==null||mt.remove(W.id))}addDeletedAnnotationElement(W){t(this,rt).add(W.annotationElementId),W.deleted=!0}isDeletedAnnotationElement(W){return t(this,rt).has(W)}removeDeletedAnnotationElement(W){t(this,rt).delete(W.annotationElementId),W.deleted=!1}setActiveEditor(W){t(this,a)!==W&&(lt(this,a,W),W&&K(this,tt,ue).call(this,W.propertiesToUpdate))}toggleSelected(W){if(t(this,O).has(W)){t(this,O).delete(W),W.unselect(),K(this,tt,te).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,O).add(W),W.select(),K(this,tt,ue).call(this,W.propertiesToUpdate),K(this,tt,te).call(this,{hasSelectedEditor:!0})}setSelected(W){for(const mt of t(this,O))mt!==W&&mt.unselect();t(this,O).clear(),t(this,O).add(W),W.select(),K(this,tt,ue).call(this,W.propertiesToUpdate),K(this,tt,te).call(this,{hasSelectedEditor:!0})}isSelected(W){return t(this,O).has(W)}unselect(W){W.unselect(),t(this,O).delete(W),K(this,tt,te).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,O).size!==0}undo(){t(this,J).undo(),K(this,tt,te).call(this,{hasSomethingToUndo:t(this,J).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:K(this,tt,fe).call(this)})}redo(){t(this,J).redo(),K(this,tt,te).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,J).hasSomethingToRedo(),isEmpty:K(this,tt,fe).call(this)})}addCommands(W){t(this,J).add(W),K(this,tt,te).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:K(this,tt,fe).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const W=[...t(this,O)],mt=()=>{for(const Lt of W)Lt.remove()},Ct=()=>{for(const Lt of W)K(this,tt,Ve).call(this,Lt)};this.addCommands({cmd:mt,undo:Ct,mustExec:!0})}commitOrRemove(){var W;(W=t(this,a))==null||W.commitOrRemove()}hasSomethingToControl(){return t(this,a)||this.hasSelection}selectAll(){for(const W of t(this,O))W.commit();K(this,tt,ze).call(this,t(this,E).values())}unselectAll(){if(t(this,a)){t(this,a).commitOrRemove();return}if(this.hasSelection){for(const W of t(this,O))W.unselect();t(this,O).clear(),K(this,tt,te).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(W,mt,Ct=!1){if(Ct||this.commitOrRemove(),!this.hasSelection)return;t(this,it)[0]+=W,t(this,it)[1]+=mt;const[Lt,Bt]=t(this,it),Rt=[...t(this,O)],F=1e3;t(this,gt)&&clearTimeout(t(this,gt)),lt(this,gt,setTimeout(()=>{lt(this,gt,null),t(this,it)[0]=t(this,it)[1]=0,this.addCommands({cmd:()=>{for(const P of Rt)t(this,E).has(P.id)&&P.translateInPage(Lt,Bt)},undo:()=>{for(const P of Rt)t(this,E).has(P.id)&&P.translateInPage(-Lt,-Bt)},mustExec:!1})},F));for(const P of Rt)P.translateInPage(W,mt)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),lt(this,C,new Map);for(const W of t(this,O))t(this,C).set(W,{savedX:W.x,savedY:W.y,savedPageIndex:W.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,C))return!1;this.disableUserSelect(!1);const W=t(this,C);lt(this,C,null);let mt=!1;for(const[{x:Lt,y:Bt,pageIndex:Rt},F]of W)F.newX=Lt,F.newY=Bt,F.newPageIndex=Rt,mt||(mt=Lt!==F.savedX||Bt!==F.savedY||Rt!==F.savedPageIndex);if(!mt)return!1;const Ct=(Lt,Bt,Rt,F)=>{if(t(this,E).has(Lt.id)){const P=t(this,R).get(F);P?Lt._setParentAndPosition(P,Bt,Rt):(Lt.pageIndex=F,Lt.x=Bt,Lt.y=Rt)}};return this.addCommands({cmd:()=>{for(const[Lt,{newX:Bt,newY:Rt,newPageIndex:F}]of W)Ct(Lt,Bt,Rt,F)},undo:()=>{for(const[Lt,{savedX:Bt,savedY:Rt,savedPageIndex:F}]of W)Ct(Lt,Bt,Rt,F)},mustExec:!0}),!0}dragSelectedEditors(W,mt){if(t(this,C))for(const Ct of t(this,C).keys())Ct.drag(W,mt)}rebuild(W){if(W.parent===null){const mt=this.getLayer(W.pageIndex);mt?(mt.changeParent(W),mt.addOrRebuild(W)):(this.addEditor(W),this.addToAnnotationStorage(W),W.rebuild())}else W.parent.addOrRebuild(W)}isActive(W){return t(this,a)===W}getActive(){return t(this,a)}getMode(){return t(this,D)}get imageManager(){return(0,n.shadow)(this,"imageManager",new k)}};a=new WeakMap,E=new WeakMap,R=new WeakMap,et=new WeakMap,V=new WeakMap,J=new WeakMap,G=new WeakMap,rt=new WeakMap,C=new WeakMap,$=new WeakMap,nt=new WeakMap,T=new WeakMap,s=new WeakMap,i=new WeakMap,p=new WeakMap,M=new WeakMap,D=new WeakMap,O=new WeakMap,q=new WeakMap,st=new WeakMap,ht=new WeakMap,pt=new WeakMap,yt=new WeakMap,bt=new WeakMap,_t=new WeakMap,Q=new WeakMap,Z=new WeakMap,y=new WeakMap,I=new WeakMap,Y=new WeakMap,it=new WeakMap,gt=new WeakMap,St=new WeakMap,vt=new WeakMap,tt=new WeakSet,Sn=function(){window.addEventListener("focus",t(this,ht)),window.addEventListener("blur",t(this,st))},We=function(){window.removeEventListener("focus",t(this,ht)),window.removeEventListener("blur",t(this,st))},He=function(){window.addEventListener("keydown",t(this,_t),{capture:!0})},ve=function(){window.removeEventListener("keydown",t(this,_t),{capture:!0})},Ge=function(){document.addEventListener("copy",t(this,pt)),document.addEventListener("cut",t(this,yt)),document.addEventListener("paste",t(this,bt))},$e=function(){document.removeEventListener("copy",t(this,pt)),document.removeEventListener("cut",t(this,yt)),document.removeEventListener("paste",t(this,bt))},te=function(W){Object.entries(W).some(([Ct,Lt])=>t(this,Y)[Ct]!==Lt)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,Y),W)})},ue=function(W){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:W})},Tn=function(){if(!t(this,i)){lt(this,i,!0);for(const W of t(this,R).values())W.enable()}},Pn=function(){if(this.unselectAll(),t(this,i)){lt(this,i,!1);for(const W of t(this,R).values())W.disable()}},Ve=function(W){const mt=t(this,R).get(W.pageIndex);mt?mt.addOrRebuild(W):this.addEditor(W)},fe=function(){if(t(this,E).size===0)return!0;if(t(this,E).size===1)for(const W of t(this,E).values())return W.isEmpty();return!1},ze=function(W){t(this,O).clear();for(const mt of W)mt.isEmpty()||(t(this,O).add(mt),mt.select());K(this,tt,te).call(this,{hasSelectedEditor:!0})},Jt(Xt,"TRANSLATE_SMALL",1),Jt(Xt,"TRANSLATE_BIG",10);let U=Xt;e.AnnotationEditorUIManager=U},(x,e,N)=>{var G,rt,C,$,nt,T,s,i,p,M,D,O,oe,le,Xe,Ee,Se,pe,ge;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=l,e.getColorValues=E,e.getCurrentTransform=R,e.getCurrentTransformInverse=et,e.getFilenameFromUrl=f,e.getPdfFilenameFromUrl=A,e.getRGB=a,e.getXfaPageViewport=B,e.isDataScheme=S,e.isPdfFile=g,e.isValidFetchUrl=v,e.loadScript=d,e.noContextMenu=o,e.setLayerDimensions=V;var n=N(7),u=N(1);const z="http://www.w3.org/2000/svg",J=class J{};Jt(J,"CSS",96),Jt(J,"PDF",72),Jt(J,"PDF_TO_CSS_UNITS",J.CSS/J.PDF);let H=J;e.PixelsPerInch=H;class ut extends n.BaseFilterFactory{constructor({docId:y,ownerDocument:I=globalThis.document}={}){super();at(this,O);at(this,G);at(this,rt);at(this,C);at(this,$);at(this,nt);at(this,T);at(this,s);at(this,i);at(this,p);at(this,M);at(this,D,0);lt(this,C,y),lt(this,$,I)}addFilter(y){if(!y)return"none";let I=t(this,O,oe).get(y);if(I)return I;let Y,it,gt,St;if(y.length===1){const Pt=y[0],Wt=new Array(256);for(let Ut=0;Ut<256;Ut++)Wt[Ut]=Pt[Ut]/255;St=Y=it=gt=Wt.join(",")}else{const[Pt,Wt,Ut]=y,zt=new Array(256),Ft=new Array(256),It=new Array(256);for(let Gt=0;Gt<256;Gt++)zt[Gt]=Pt[Gt]/255,Ft[Gt]=Wt[Gt]/255,It[Gt]=Ut[Gt]/255;Y=zt.join(","),it=Ft.join(","),gt=It.join(","),St=`${Y}${it}${gt}`}if(I=t(this,O,oe).get(St),I)return t(this,O,oe).set(y,I),I;const vt=`g_${t(this,C)}_transfer_map_${de(this,D)._++}`,tt=`url(#${vt})`;t(this,O,oe).set(y,tt),t(this,O,oe).set(St,tt);const wt=K(this,O,Ee).call(this,vt);return K(this,O,pe).call(this,Y,it,gt,wt),tt}addHCMFilter(y,I){var Wt;const Y=`${y}-${I}`;if(t(this,T)===Y)return t(this,s);if(lt(this,T,Y),lt(this,s,"none"),(Wt=t(this,nt))==null||Wt.remove(),!y||!I)return t(this,s);const it=K(this,O,ge).call(this,y);y=u.Util.makeHexColor(...it);const gt=K(this,O,ge).call(this,I);if(I=u.Util.makeHexColor(...gt),t(this,O,le).style.color="",y==="#000000"&&I==="#ffffff"||y===I)return t(this,s);const St=new Array(256);for(let Ut=0;Ut<=255;Ut++){const zt=Ut/255;St[Ut]=zt<=.03928?zt/12.92:((zt+.055)/1.055)**2.4}const vt=St.join(","),tt=`g_${t(this,C)}_hcm_filter`,wt=lt(this,i,K(this,O,Ee).call(this,tt));K(this,O,pe).call(this,vt,vt,vt,wt),K(this,O,Xe).call(this,wt);const Pt=(Ut,zt)=>{const Ft=it[Ut]/255,It=gt[Ut]/255,Gt=new Array(zt+1);for(let qt=0;qt<=zt;qt++)Gt[qt]=Ft+qt/zt*(It-Ft);return Gt.join(",")};return K(this,O,pe).call(this,Pt(0,5),Pt(1,5),Pt(2,5),wt),lt(this,s,`url(#${tt})`),t(this,s)}addHighlightHCMFilter(y,I,Y,it){var It;const gt=`${y}-${I}-${Y}-${it}`;if(t(this,p)===gt)return t(this,M);if(lt(this,p,gt),lt(this,M,"none"),(It=t(this,i))==null||It.remove(),!y||!I)return t(this,M);const[St,vt]=[y,I].map(K(this,O,ge).bind(this));let tt=Math.round(.2126*St[0]+.7152*St[1]+.0722*St[2]),wt=Math.round(.2126*vt[0]+.7152*vt[1]+.0722*vt[2]),[Pt,Wt]=[Y,it].map(K(this,O,ge).bind(this));wt<tt&&([tt,wt,Pt,Wt]=[wt,tt,Wt,Pt]),t(this,O,le).style.color="";const Ut=(Gt,qt,Et)=>{const ot=new Array(256),ct=(wt-tt)/Et,kt=Gt/255,Xt=(qt-Gt)/(255*Et);let Vt=0;for(let W=0;W<=Et;W++){const mt=Math.round(tt+W*ct),Ct=kt+W*Xt;for(let Lt=Vt;Lt<=mt;Lt++)ot[Lt]=Ct;Vt=mt+1}for(let W=Vt;W<256;W++)ot[W]=ot[Vt-1];return ot.join(",")},zt=`g_${t(this,C)}_hcm_highlight_filter`,Ft=lt(this,i,K(this,O,Ee).call(this,zt));return K(this,O,Xe).call(this,Ft),K(this,O,pe).call(this,Ut(Pt[0],Wt[0],5),Ut(Pt[1],Wt[1],5),Ut(Pt[2],Wt[2],5),Ft),lt(this,M,`url(#${zt})`),t(this,M)}destroy(y=!1){y&&(t(this,s)||t(this,M))||(t(this,rt)&&(t(this,rt).parentNode.parentNode.remove(),lt(this,rt,null)),t(this,G)&&(t(this,G).clear(),lt(this,G,null)),lt(this,D,0))}}G=new WeakMap,rt=new WeakMap,C=new WeakMap,$=new WeakMap,nt=new WeakMap,T=new WeakMap,s=new WeakMap,i=new WeakMap,p=new WeakMap,M=new WeakMap,D=new WeakMap,O=new WeakSet,oe=function(){return t(this,G)||lt(this,G,new Map)},le=function(){if(!t(this,rt)){const y=t(this,$).createElement("div"),{style:I}=y;I.visibility="hidden",I.contain="strict",I.width=I.height=0,I.position="absolute",I.top=I.left=0,I.zIndex=-1;const Y=t(this,$).createElementNS(z,"svg");Y.setAttribute("width",0),Y.setAttribute("height",0),lt(this,rt,t(this,$).createElementNS(z,"defs")),y.append(Y),Y.append(t(this,rt)),t(this,$).body.append(y)}return t(this,rt)},Xe=function(y){const I=t(this,$).createElementNS(z,"feColorMatrix");I.setAttribute("type","matrix"),I.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),y.append(I)},Ee=function(y){const I=t(this,$).createElementNS(z,"filter");return I.setAttribute("color-interpolation-filters","sRGB"),I.setAttribute("id",y),t(this,O,le).append(I),I},Se=function(y,I,Y){const it=t(this,$).createElementNS(z,I);it.setAttribute("type","discrete"),it.setAttribute("tableValues",Y),y.append(it)},pe=function(y,I,Y,it){const gt=t(this,$).createElementNS(z,"feComponentTransfer");it.append(gt),K(this,O,Se).call(this,gt,"feFuncR",y),K(this,O,Se).call(this,gt,"feFuncG",I),K(this,O,Se).call(this,gt,"feFuncB",Y)},ge=function(y){return t(this,O,le).style.color=y,a(getComputedStyle(t(this,O,le)).getPropertyValue("color"))},e.DOMFilterFactory=ut;class k extends n.BaseCanvasFactory{constructor({ownerDocument:Z=globalThis.document}={}){super(),this._document=Z}_createCanvas(Z,y){const I=this._document.createElement("canvas");return I.width=Z,I.height=y,I}}e.DOMCanvasFactory=k;async function w(Q,Z=!1){if(v(Q,document.baseURI)){const y=await fetch(Q);if(!y.ok)throw new Error(y.statusText);return Z?new Uint8Array(await y.arrayBuffer()):(0,u.stringToBytes)(await y.text())}return new Promise((y,I)=>{const Y=new XMLHttpRequest;Y.open("GET",Q,!0),Z&&(Y.responseType="arraybuffer"),Y.onreadystatechange=()=>{if(Y.readyState===XMLHttpRequest.DONE){if(Y.status===200||Y.status===0){let it;if(Z&&Y.response?it=new Uint8Array(Y.response):!Z&&Y.responseText&&(it=(0,u.stringToBytes)(Y.responseText)),it){y(it);return}}I(new Error(Y.statusText))}},Y.send(null)})}class m extends n.BaseCMapReaderFactory{_fetchData(Z,y){return w(Z,this.isCompressed).then(I=>({cMapData:I,compressionType:y}))}}e.DOMCMapReaderFactory=m;class j extends n.BaseStandardFontDataFactory{_fetchData(Z){return w(Z,!0)}}e.DOMStandardFontDataFactory=j;class U extends n.BaseSVGFactory{_createSVG(Z){return document.createElementNS(z,Z)}}e.DOMSVGFactory=U;class _{constructor({viewBox:Z,scale:y,rotation:I,offsetX:Y=0,offsetY:it=0,dontFlip:gt=!1}){this.viewBox=Z,this.scale=y,this.rotation=I,this.offsetX=Y,this.offsetY=it;const St=(Z[2]+Z[0])/2,vt=(Z[3]+Z[1])/2;let tt,wt,Pt,Wt;switch(I%=360,I<0&&(I+=360),I){case 180:tt=-1,wt=0,Pt=0,Wt=1;break;case 90:tt=0,wt=1,Pt=1,Wt=0;break;case 270:tt=0,wt=-1,Pt=-1,Wt=0;break;case 0:tt=1,wt=0,Pt=0,Wt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}gt&&(Pt=-Pt,Wt=-Wt);let Ut,zt,Ft,It;tt===0?(Ut=Math.abs(vt-Z[1])*y+Y,zt=Math.abs(St-Z[0])*y+it,Ft=(Z[3]-Z[1])*y,It=(Z[2]-Z[0])*y):(Ut=Math.abs(St-Z[0])*y+Y,zt=Math.abs(vt-Z[1])*y+it,Ft=(Z[2]-Z[0])*y,It=(Z[3]-Z[1])*y),this.transform=[tt*y,wt*y,Pt*y,Wt*y,Ut-tt*y*St-Pt*y*vt,zt-wt*y*St-Wt*y*vt],this.width=Ft,this.height=It}get rawDims(){const{viewBox:Z}=this;return(0,u.shadow)(this,"rawDims",{pageWidth:Z[2]-Z[0],pageHeight:Z[3]-Z[1],pageX:Z[0],pageY:Z[1]})}clone({scale:Z=this.scale,rotation:y=this.rotation,offsetX:I=this.offsetX,offsetY:Y=this.offsetY,dontFlip:it=!1}={}){return new _({viewBox:this.viewBox.slice(),scale:Z,rotation:y,offsetX:I,offsetY:Y,dontFlip:it})}convertToViewportPoint(Z,y){return u.Util.applyTransform([Z,y],this.transform)}convertToViewportRectangle(Z){const y=u.Util.applyTransform([Z[0],Z[1]],this.transform),I=u.Util.applyTransform([Z[2],Z[3]],this.transform);return[y[0],y[1],I[0],I[1]]}convertToPdfPoint(Z,y){return u.Util.applyInverseTransform([Z,y],this.transform)}}e.PageViewport=_;class b extends u.BaseException{constructor(Z,y=0){super(Z,"RenderingCancelledException"),this.extraDelay=y}}e.RenderingCancelledException=b;function S(Q){const Z=Q.length;let y=0;for(;y<Z&&Q[y].trim()==="";)y++;return Q.substring(y,y+5).toLowerCase()==="data:"}function g(Q){return typeof Q=="string"&&/\.pdf$/i.test(Q)}function f(Q,Z=!1){return Z||([Q]=Q.split(/[#?]/,1)),Q.substring(Q.lastIndexOf("/")+1)}function A(Q,Z="document.pdf"){if(typeof Q!="string")return Z;if(S(Q))return(0,u.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Z;const y=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,I=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Y=y.exec(Q);let it=I.exec(Y[1])||I.exec(Y[2])||I.exec(Y[3]);if(it&&(it=it[0],it.includes("%")))try{it=I.exec(decodeURIComponent(it))[0]}catch{}return it||Z}class L{constructor(){Jt(this,"started",Object.create(null));Jt(this,"times",[])}time(Z){Z in this.started&&(0,u.warn)(`Timer is already running for ${Z}`),this.started[Z]=Date.now()}timeEnd(Z){Z in this.started||(0,u.warn)(`Timer has not been started for ${Z}`),this.times.push({name:Z,start:this.started[Z],end:Date.now()}),delete this.started[Z]}toString(){const Z=[];let y=0;for(const{name:I}of this.times)y=Math.max(I.length,y);for(const{name:I,start:Y,end:it}of this.times)Z.push(`${I.padEnd(y)} ${it-Y}ms
`);return Z.join("")}}e.StatTimer=L;function v(Q,Z){try{const{protocol:y}=Z?new URL(Q,Z):new URL(Q);return y==="http:"||y==="https:"}catch{return!1}}function o(Q){Q.preventDefault()}function d(Q,Z=!1){return new Promise((y,I)=>{const Y=document.createElement("script");Y.src=Q,Y.onload=function(it){Z&&Y.remove(),y(it)},Y.onerror=function(){I(new Error(`Cannot load script at: ${Y.src}`))},(document.head||document.documentElement).append(Y)})}function l(Q){console.log("Deprecated API usage: "+Q)}let c;class h{static toDateObject(Z){if(!Z||typeof Z!="string")return null;c||(c=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const y=c.exec(Z);if(!y)return null;const I=parseInt(y[1],10);let Y=parseInt(y[2],10);Y=Y>=1&&Y<=12?Y-1:0;let it=parseInt(y[3],10);it=it>=1&&it<=31?it:1;let gt=parseInt(y[4],10);gt=gt>=0&&gt<=23?gt:0;let St=parseInt(y[5],10);St=St>=0&&St<=59?St:0;let vt=parseInt(y[6],10);vt=vt>=0&&vt<=59?vt:0;const tt=y[7]||"Z";let wt=parseInt(y[8],10);wt=wt>=0&&wt<=23?wt:0;let Pt=parseInt(y[9],10)||0;return Pt=Pt>=0&&Pt<=59?Pt:0,tt==="-"?(gt+=wt,St+=Pt):tt==="+"&&(gt-=wt,St-=Pt),new Date(Date.UTC(I,Y,it,gt,St,vt))}}e.PDFDateString=h;function B(Q,{scale:Z=1,rotation:y=0}){const{width:I,height:Y}=Q.attributes.style,it=[0,0,parseInt(I),parseInt(Y)];return new _({viewBox:it,scale:Z,rotation:y})}function a(Q){if(Q.startsWith("#")){const Z=parseInt(Q.slice(1),16);return[(Z&16711680)>>16,(Z&65280)>>8,Z&255]}return Q.startsWith("rgb(")?Q.slice(4,-1).split(",").map(Z=>parseInt(Z)):Q.startsWith("rgba(")?Q.slice(5,-1).split(",").map(Z=>parseInt(Z)).slice(0,3):((0,u.warn)(`Not a valid color format: "${Q}"`),[0,0,0])}function E(Q){const Z=document.createElement("span");Z.style.visibility="hidden",document.body.append(Z);for(const y of Q.keys()){Z.style.color=y;const I=window.getComputedStyle(Z).color;Q.set(y,a(I))}Z.remove()}function R(Q){const{a:Z,b:y,c:I,d:Y,e:it,f:gt}=Q.getTransform();return[Z,y,I,Y,it,gt]}function et(Q){const{a:Z,b:y,c:I,d:Y,e:it,f:gt}=Q.getTransform().invertSelf();return[Z,y,I,Y,it,gt]}function V(Q,Z,y=!1,I=!0){if(Z instanceof _){const{pageWidth:Y,pageHeight:it}=Z.rawDims,{style:gt}=Q,St=u.FeatureTest.isCSSRoundSupported,vt=`var(--scale-factor) * ${Y}px`,tt=`var(--scale-factor) * ${it}px`,wt=St?`round(${vt}, 1px)`:`calc(${vt})`,Pt=St?`round(${tt}, 1px)`:`calc(${tt})`;!y||Z.rotation%180===0?(gt.width=wt,gt.height=Pt):(gt.width=Pt,gt.height=wt)}I&&Q.setAttribute("data-main-rotation",Z.rotation)}},(x,e,N)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var n=N(1);class u{constructor(){this.constructor===u&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(m){return"none"}addHCMFilter(m,j){return"none"}addHighlightHCMFilter(m,j,U,_){return"none"}destroy(m=!1){}}e.BaseFilterFactory=u;class z{constructor(){this.constructor===z&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(m,j){if(m<=0||j<=0)throw new Error("Invalid canvas size");const U=this._createCanvas(m,j);return{canvas:U,context:U.getContext("2d")}}reset(m,j,U){if(!m.canvas)throw new Error("Canvas is not specified");if(j<=0||U<=0)throw new Error("Invalid canvas size");m.canvas.width=j,m.canvas.height=U}destroy(m){if(!m.canvas)throw new Error("Canvas is not specified");m.canvas.width=0,m.canvas.height=0,m.canvas=null,m.context=null}_createCanvas(m,j){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=z;class H{constructor({baseUrl:m=null,isCompressed:j=!0}){this.constructor===H&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=m,this.isCompressed=j}async fetch({name:m}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!m)throw new Error("CMap name must be specified.");const j=this.baseUrl+m+(this.isCompressed?".bcmap":""),U=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(j,U).catch(_=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${j}`)})}_fetchData(m,j){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=H;class ut{constructor({baseUrl:m=null}){this.constructor===ut&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=m}async fetch({filename:m}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!m)throw new Error("Font filename must be specified.");const j=`${this.baseUrl}${m}`;return this._fetchData(j).catch(U=>{throw new Error(`Unable to load font data at: ${j}`)})}_fetchData(m){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=ut;class k{constructor(){this.constructor===k&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(m,j,U=!1){if(m<=0||j<=0)throw new Error("Invalid SVG dimensions");const _=this._createSVG("svg:svg");return _.setAttribute("version","1.1"),U||(_.setAttribute("width",`${m}px`),_.setAttribute("height",`${j}px`)),_.setAttribute("preserveAspectRatio","none"),_.setAttribute("viewBox",`0 0 ${m} ${j}`),_}createElement(m){if(typeof m!="string")throw new Error("Invalid SVG element type");return this._createSVG(m)}_createSVG(m){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=k},(x,e,N)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var n=N(1);const u=3285377520,z=4294901760,H=65535;class ut{constructor(w){this.h1=w?w&4294967295:u,this.h2=w?w&4294967295:u}update(w){let m,j;if(typeof w=="string"){m=new Uint8Array(w.length*2),j=0;for(let l=0,c=w.length;l<c;l++){const h=w.charCodeAt(l);h<=255?m[j++]=h:(m[j++]=h>>>8,m[j++]=h&255)}}else if((0,n.isArrayBuffer)(w))m=w.slice(),j=m.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const U=j>>2,_=j-U*4,b=new Uint32Array(m.buffer,0,U);let S=0,g=0,f=this.h1,A=this.h2;const L=3432918353,v=461845907,o=L&H,d=v&H;for(let l=0;l<U;l++)l&1?(S=b[l],S=S*L&z|S*o&H,S=S<<15|S>>>17,S=S*v&z|S*d&H,f^=S,f=f<<13|f>>>19,f=f*5+3864292196):(g=b[l],g=g*L&z|g*o&H,g=g<<15|g>>>17,g=g*v&z|g*d&H,A^=g,A=A<<13|A>>>19,A=A*5+3864292196);switch(S=0,_){case 3:S^=m[U*4+2]<<16;case 2:S^=m[U*4+1]<<8;case 1:S^=m[U*4],S=S*L&z|S*o&H,S=S<<15|S>>>17,S=S*v&z|S*d&H,U&1?f^=S:A^=S}this.h1=f,this.h2=A}hexdigest(){let w=this.h1,m=this.h2;return w^=m>>>1,w=w*3981806797&z|w*36045&H,m=m*4283543511&z|((m<<16|w>>>16)*2950163797&z)>>>16,w^=m>>>1,w=w*444984403&z|w*60499&H,m=m*3301882366&z|((m<<16|w>>>16)*3120437893&z)>>>16,w^=m>>>1,(w>>>0).toString(16).padStart(8,"0")+(m>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=ut},(x,e,N)=>{var H;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var n=N(1);class u{constructor({ownerDocument:k=globalThis.document,styleElement:w=null}){at(this,H,new Set);this._document=k,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(k){this.nativeFontFaces.add(k),this._document.fonts.add(k)}removeNativeFontFace(k){this.nativeFontFaces.delete(k),this._document.fonts.delete(k)}insertRule(k){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const w=this.styleElement.sheet;w.insertRule(k,w.cssRules.length)}clear(){for(const k of this.nativeFontFaces)this._document.fonts.delete(k);this.nativeFontFaces.clear(),t(this,H).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(k){if(!(!k||t(this,H).has(k.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:w,src:m,style:j}=k,U=new FontFace(w,m,j);this.addNativeFontFace(U);try{await U.load(),t(this,H).add(w)}catch{(0,n.warn)(`Cannot load system font: ${k.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(U)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(k){if(k.attached||k.missingFile&&!k.systemFontInfo)return;if(k.attached=!0,k.systemFontInfo){await this.loadSystemFont(k.systemFontInfo);return}if(this.isFontLoadingAPISupported){const m=k.createNativeFontFace();if(m){this.addNativeFontFace(m);try{await m.loaded}catch(j){throw(0,n.warn)(`Failed to load font '${m.family}': '${j}'.`),k.disableFontFace=!0,j}}return}const w=k.createFontFaceRule();if(w){if(this.insertRule(w),this.isSyncFontLoadingSupported)return;await new Promise(m=>{const j=this._queueLoadingCallback(m);this._prepareFontLoadEvent(k,j)})}}get isFontLoadingAPISupported(){var w;const k=!!((w=this._document)!=null&&w.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",k)}get isSyncFontLoadingSupported(){let k=!1;return(n.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(k=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",k)}_queueLoadingCallback(k){function w(){for((0,n.assert)(!j.done,"completeRequest() cannot be called twice."),j.done=!0;m.length>0&&m[0].done;){const U=m.shift();setTimeout(U.callback,0)}}const{loadingRequests:m}=this,j={done:!1,complete:w,callback:k};return m.push(j),j}get _loadTestFont(){const k=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",k)}_prepareFontLoadEvent(k,w){function m(a,E){return a.charCodeAt(E)<<24|a.charCodeAt(E+1)<<16|a.charCodeAt(E+2)<<8|a.charCodeAt(E+3)&255}function j(a,E,R,et){const V=a.substring(0,E),J=a.substring(E+R);return V+et+J}let U,_;const b=this._document.createElement("canvas");b.width=1,b.height=1;const S=b.getContext("2d");let g=0;function f(a,E){if(++g>30){(0,n.warn)("Load test font never loaded."),E();return}if(S.font="30px "+a,S.fillText(".",0,20),S.getImageData(0,0,1,1).data[3]>0){E();return}setTimeout(f.bind(null,a,E))}const A=`lt${Date.now()}${this.loadTestFontId++}`;let L=this._loadTestFont;L=j(L,976,A.length,A);const o=16,d=1482184792;let l=m(L,o);for(U=0,_=A.length-3;U<_;U+=4)l=l-d+m(A,U)|0;U<A.length&&(l=l-d+m(A+"XXX",U)|0),L=j(L,o,4,(0,n.string32)(l));const c=`url(data:font/opentype;base64,${btoa(L)});`,h=`@font-face {font-family:"${A}";src:${c}}`;this.insertRule(h);const B=this._document.createElement("div");B.style.visibility="hidden",B.style.width=B.style.height="10px",B.style.position="absolute",B.style.top=B.style.left="0px";for(const a of[k.loadedName,A]){const E=this._document.createElement("span");E.textContent="Hi",E.style.fontFamily=a,B.append(E)}this._document.body.append(B),f(A,()=>{B.remove(),w.complete()})}}H=new WeakMap,e.FontLoader=u;class z{constructor(k,{isEvalSupported:w=!0,disableFontFace:m=!1,ignoreErrors:j=!1,inspectFont:U=null}){this.compiledGlyphs=Object.create(null);for(const _ in k)this[_]=k[_];this.isEvalSupported=w!==!1,this.disableFontFace=m===!0,this.ignoreErrors=j===!0,this._inspectFont=U}createNativeFontFace(){var w;if(!this.data||this.disableFontFace)return null;let k;if(!this.cssFontInfo)k=new FontFace(this.loadedName,this.data,{});else{const m={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(m.style=`oblique ${this.cssFontInfo.italicAngle}deg`),k=new FontFace(this.cssFontInfo.fontFamily,this.data,m)}return(w=this._inspectFont)==null||w.call(this,this),k}createFontFaceRule(){var j;if(!this.data||this.disableFontFace)return null;const k=(0,n.bytesToString)(this.data),w=`url(data:${this.mimetype};base64,${btoa(k)});`;let m;if(!this.cssFontInfo)m=`@font-face {font-family:"${this.loadedName}";src:${w}}`;else{let U=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(U+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),m=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${U}src:${w}}`}return(j=this._inspectFont)==null||j.call(this,this,w),m}getPathGenerator(k,w){if(this.compiledGlyphs[w]!==void 0)return this.compiledGlyphs[w];let m;try{m=k.get(this.loadedName+"_path_"+w)}catch(j){if(!this.ignoreErrors)throw j;return(0,n.warn)(`getPathGenerator - ignoring character: "${j}".`),this.compiledGlyphs[w]=function(U,_){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const j=[];for(const U of m){const _=U.args!==void 0?U.args.join(","):"";j.push("c.",U.cmd,"(",_,`);
`)}return this.compiledGlyphs[w]=new Function("c","size",j.join(""))}return this.compiledGlyphs[w]=function(j,U){for(const _ of m)_.cmd==="scale"&&(_.args=[U,-U]),j[_.cmd].apply(j,_.args)}}}e.FontFaceObject=z},(x,e,N)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var n=N(7);N(1);const u=function(w){return new Promise((m,j)=>{require$$5.readFile(w,(_,b)=>{if(_||!b){j(new Error(_));return}m(new Uint8Array(b))})})};class z extends n.BaseFilterFactory{}e.NodeFilterFactory=z;class H extends n.BaseCanvasFactory{_createCanvas(m,j){return require$$5.createCanvas(m,j)}}e.NodeCanvasFactory=H;class ut extends n.BaseCMapReaderFactory{_fetchData(m,j){return u(m).then(U=>({cMapData:U,compressionType:j}))}}e.NodeCMapReaderFactory=ut;class k extends n.BaseStandardFontDataFactory{_fetchData(m){return u(m)}}e.NodeStandardFontDataFactory=k},(x,e,N)=>{var rt,qe,Ye;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var n=N(1),u=N(6),z=N(12),H=N(13);const ut=16,k=100,w=4096,m=15,j=10,U=1e3,_=16;function b(T,s){if(T._removeMirroring)throw new Error("Context is already forwarding operations.");T.__originalSave=T.save,T.__originalRestore=T.restore,T.__originalRotate=T.rotate,T.__originalScale=T.scale,T.__originalTranslate=T.translate,T.__originalTransform=T.transform,T.__originalSetTransform=T.setTransform,T.__originalResetTransform=T.resetTransform,T.__originalClip=T.clip,T.__originalMoveTo=T.moveTo,T.__originalLineTo=T.lineTo,T.__originalBezierCurveTo=T.bezierCurveTo,T.__originalRect=T.rect,T.__originalClosePath=T.closePath,T.__originalBeginPath=T.beginPath,T._removeMirroring=()=>{T.save=T.__originalSave,T.restore=T.__originalRestore,T.rotate=T.__originalRotate,T.scale=T.__originalScale,T.translate=T.__originalTranslate,T.transform=T.__originalTransform,T.setTransform=T.__originalSetTransform,T.resetTransform=T.__originalResetTransform,T.clip=T.__originalClip,T.moveTo=T.__originalMoveTo,T.lineTo=T.__originalLineTo,T.bezierCurveTo=T.__originalBezierCurveTo,T.rect=T.__originalRect,T.closePath=T.__originalClosePath,T.beginPath=T.__originalBeginPath,delete T._removeMirroring},T.save=function(){s.save(),this.__originalSave()},T.restore=function(){s.restore(),this.__originalRestore()},T.translate=function(p,M){s.translate(p,M),this.__originalTranslate(p,M)},T.scale=function(p,M){s.scale(p,M),this.__originalScale(p,M)},T.transform=function(p,M,D,O,q,st){s.transform(p,M,D,O,q,st),this.__originalTransform(p,M,D,O,q,st)},T.setTransform=function(p,M,D,O,q,st){s.setTransform(p,M,D,O,q,st),this.__originalSetTransform(p,M,D,O,q,st)},T.resetTransform=function(){s.resetTransform(),this.__originalResetTransform()},T.rotate=function(p){s.rotate(p),this.__originalRotate(p)},T.clip=function(p){s.clip(p),this.__originalClip(p)},T.moveTo=function(i,p){s.moveTo(i,p),this.__originalMoveTo(i,p)},T.lineTo=function(i,p){s.lineTo(i,p),this.__originalLineTo(i,p)},T.bezierCurveTo=function(i,p,M,D,O,q){s.bezierCurveTo(i,p,M,D,O,q),this.__originalBezierCurveTo(i,p,M,D,O,q)},T.rect=function(i,p,M,D){s.rect(i,p,M,D),this.__originalRect(i,p,M,D)},T.closePath=function(){s.closePath(),this.__originalClosePath()},T.beginPath=function(){s.beginPath(),this.__originalBeginPath()}}class S{constructor(s){this.canvasFactory=s,this.cache=Object.create(null)}getCanvas(s,i,p){let M;return this.cache[s]!==void 0?(M=this.cache[s],this.canvasFactory.reset(M,i,p)):(M=this.canvasFactory.create(i,p),this.cache[s]=M),M}delete(s){delete this.cache[s]}clear(){for(const s in this.cache){const i=this.cache[s];this.canvasFactory.destroy(i),delete this.cache[s]}}}function g(T,s,i,p,M,D,O,q,st,ht){const[pt,yt,bt,_t,Q,Z]=(0,u.getCurrentTransform)(T);if(yt===0&&bt===0){const Y=O*pt+Q,it=Math.round(Y),gt=q*_t+Z,St=Math.round(gt),vt=(O+st)*pt+Q,tt=Math.abs(Math.round(vt)-it)||1,wt=(q+ht)*_t+Z,Pt=Math.abs(Math.round(wt)-St)||1;return T.setTransform(Math.sign(pt),0,0,Math.sign(_t),it,St),T.drawImage(s,i,p,M,D,0,0,tt,Pt),T.setTransform(pt,yt,bt,_t,Q,Z),[tt,Pt]}if(pt===0&&_t===0){const Y=q*bt+Q,it=Math.round(Y),gt=O*yt+Z,St=Math.round(gt),vt=(q+ht)*bt+Q,tt=Math.abs(Math.round(vt)-it)||1,wt=(O+st)*yt+Z,Pt=Math.abs(Math.round(wt)-St)||1;return T.setTransform(0,Math.sign(yt),Math.sign(bt),0,it,St),T.drawImage(s,i,p,M,D,0,0,Pt,tt),T.setTransform(pt,yt,bt,_t,Q,Z),[Pt,tt]}T.drawImage(s,i,p,M,D,O,q,st,ht);const y=Math.hypot(pt,yt),I=Math.hypot(bt,_t);return[y*st,I*ht]}function f(T){const{width:s,height:i}=T;if(s>U||i>U)return null;const p=1e3,M=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),D=s+1;let O=new Uint8Array(D*(i+1)),q,st,ht;const pt=s+7&-8;let yt=new Uint8Array(pt*i),bt=0;for(const I of T.data){let Y=128;for(;Y>0;)yt[bt++]=I&Y?0:255,Y>>=1}let _t=0;for(bt=0,yt[bt]!==0&&(O[0]=1,++_t),st=1;st<s;st++)yt[bt]!==yt[bt+1]&&(O[st]=yt[bt]?2:1,++_t),bt++;for(yt[bt]!==0&&(O[st]=2,++_t),q=1;q<i;q++){bt=q*pt,ht=q*D,yt[bt-pt]!==yt[bt]&&(O[ht]=yt[bt]?1:8,++_t);let I=(yt[bt]?4:0)+(yt[bt-pt]?8:0);for(st=1;st<s;st++)I=(I>>2)+(yt[bt+1]?4:0)+(yt[bt-pt+1]?8:0),M[I]&&(O[ht+st]=M[I],++_t),bt++;if(yt[bt-pt]!==yt[bt]&&(O[ht+st]=yt[bt]?2:4,++_t),_t>p)return null}for(bt=pt*(i-1),ht=q*D,yt[bt]!==0&&(O[ht]=8,++_t),st=1;st<s;st++)yt[bt]!==yt[bt+1]&&(O[ht+st]=yt[bt]?4:8,++_t),bt++;if(yt[bt]!==0&&(O[ht+st]=4,++_t),_t>p)return null;const Q=new Int32Array([0,D,-1,0,-D,0,0,0,1]),Z=new Path2D;for(q=0;_t&&q<=i;q++){let I=q*D;const Y=I+s;for(;I<Y&&!O[I];)I++;if(I===Y)continue;Z.moveTo(I%D,q);const it=I;let gt=O[I];do{const St=Q[gt];do I+=St;while(!O[I]);const vt=O[I];vt!==5&&vt!==10?(gt=vt,O[I]=0):(gt=vt&51*gt>>4,O[I]&=gt>>2|gt<<2),Z.lineTo(I%D,I/D|0),O[I]||--_t}while(it!==I);--q}return yt=null,O=null,function(I){I.save(),I.scale(1/s,-1/i),I.translate(0,-i),I.fill(Z),I.beginPath(),I.restore()}}class A{constructor(s,i){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,s,i])}clone(){const s=Object.create(this);return s.clipBox=this.clipBox.slice(),s}setCurrentPoint(s,i){this.x=s,this.y=i}updatePathMinMax(s,i,p){[i,p]=n.Util.applyTransform([i,p],s),this.minX=Math.min(this.minX,i),this.minY=Math.min(this.minY,p),this.maxX=Math.max(this.maxX,i),this.maxY=Math.max(this.maxY,p)}updateRectMinMax(s,i){const p=n.Util.applyTransform(i,s),M=n.Util.applyTransform(i.slice(2),s);this.minX=Math.min(this.minX,p[0],M[0]),this.minY=Math.min(this.minY,p[1],M[1]),this.maxX=Math.max(this.maxX,p[0],M[0]),this.maxY=Math.max(this.maxY,p[1],M[1])}updateScalingPathMinMax(s,i){n.Util.scaleMinMax(s,i),this.minX=Math.min(this.minX,i[0]),this.maxX=Math.max(this.maxX,i[1]),this.minY=Math.min(this.minY,i[2]),this.maxY=Math.max(this.maxY,i[3])}updateCurvePathMinMax(s,i,p,M,D,O,q,st,ht,pt){const yt=n.Util.bezierBoundingBox(i,p,M,D,O,q,st,ht);if(pt){pt[0]=Math.min(pt[0],yt[0],yt[2]),pt[1]=Math.max(pt[1],yt[0],yt[2]),pt[2]=Math.min(pt[2],yt[1],yt[3]),pt[3]=Math.max(pt[3],yt[1],yt[3]);return}this.updateRectMinMax(s,yt)}getPathBoundingBox(s=z.PathType.FILL,i=null){const p=[this.minX,this.minY,this.maxX,this.maxY];if(s===z.PathType.STROKE){i||(0,n.unreachable)("Stroke bounding box must include transform.");const M=n.Util.singularValueDecompose2dScale(i),D=M[0]*this.lineWidth/2,O=M[1]*this.lineWidth/2;p[0]-=D,p[1]-=O,p[2]+=D,p[3]+=O}return p}updateClipFromPath(){const s=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(s||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(s){this.clipBox=s,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(s=z.PathType.FILL,i=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(s,i))}}function L(T,s){if(typeof ImageData<"u"&&s instanceof ImageData){T.putImageData(s,0,0);return}const i=s.height,p=s.width,M=i%_,D=(i-M)/_,O=M===0?D:D+1,q=T.createImageData(p,_);let st=0,ht;const pt=s.data,yt=q.data;let bt,_t,Q,Z;if(s.kind===n.ImageKind.GRAYSCALE_1BPP){const y=pt.byteLength,I=new Uint32Array(yt.buffer,0,yt.byteLength>>2),Y=I.length,it=p+7>>3,gt=4294967295,St=n.FeatureTest.isLittleEndian?4278190080:255;for(bt=0;bt<O;bt++){for(Q=bt<D?_:M,ht=0,_t=0;_t<Q;_t++){const vt=y-st;let tt=0;const wt=vt>it?p:vt*8-7,Pt=wt&-8;let Wt=0,Ut=0;for(;tt<Pt;tt+=8)Ut=pt[st++],I[ht++]=Ut&128?gt:St,I[ht++]=Ut&64?gt:St,I[ht++]=Ut&32?gt:St,I[ht++]=Ut&16?gt:St,I[ht++]=Ut&8?gt:St,I[ht++]=Ut&4?gt:St,I[ht++]=Ut&2?gt:St,I[ht++]=Ut&1?gt:St;for(;tt<wt;tt++)Wt===0&&(Ut=pt[st++],Wt=128),I[ht++]=Ut&Wt?gt:St,Wt>>=1}for(;ht<Y;)I[ht++]=0;T.putImageData(q,0,bt*_)}}else if(s.kind===n.ImageKind.RGBA_32BPP){for(_t=0,Z=p*_*4,bt=0;bt<D;bt++)yt.set(pt.subarray(st,st+Z)),st+=Z,T.putImageData(q,0,_t),_t+=_;bt<O&&(Z=p*M*4,yt.set(pt.subarray(st,st+Z)),T.putImageData(q,0,_t))}else if(s.kind===n.ImageKind.RGB_24BPP)for(Q=_,Z=p*Q,bt=0;bt<O;bt++){for(bt>=D&&(Q=M,Z=p*Q),ht=0,_t=Z;_t--;)yt[ht++]=pt[st++],yt[ht++]=pt[st++],yt[ht++]=pt[st++],yt[ht++]=255;T.putImageData(q,0,bt*_)}else throw new Error(`bad image kind: ${s.kind}`)}function v(T,s){if(s.bitmap){T.drawImage(s.bitmap,0,0);return}const i=s.height,p=s.width,M=i%_,D=(i-M)/_,O=M===0?D:D+1,q=T.createImageData(p,_);let st=0;const ht=s.data,pt=q.data;for(let yt=0;yt<O;yt++){const bt=yt<D?_:M;({srcPos:st}=(0,H.convertBlackAndWhiteToRGBA)({src:ht,srcPos:st,dest:pt,width:p,height:bt,nonBlackColor:0})),T.putImageData(q,0,yt*_)}}function o(T,s){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const p of i)T[p]!==void 0&&(s[p]=T[p]);T.setLineDash!==void 0&&(s.setLineDash(T.getLineDash()),s.lineDashOffset=T.lineDashOffset)}function d(T){if(T.strokeStyle=T.fillStyle="#000000",T.fillRule="nonzero",T.globalAlpha=1,T.lineWidth=1,T.lineCap="butt",T.lineJoin="miter",T.miterLimit=10,T.globalCompositeOperation="source-over",T.font="10px sans-serif",T.setLineDash!==void 0&&(T.setLineDash([]),T.lineDashOffset=0),!n.isNodeJS){const{filter:s}=T;s!=="none"&&s!==""&&(T.filter="none")}}function l(T,s,i,p){const M=T.length;for(let D=3;D<M;D+=4){const O=T[D];if(O===0)T[D-3]=s,T[D-2]=i,T[D-1]=p;else if(O<255){const q=255-O;T[D-3]=T[D-3]*O+s*q>>8,T[D-2]=T[D-2]*O+i*q>>8,T[D-1]=T[D-1]*O+p*q>>8}}}function c(T,s,i){const p=T.length,M=1/255;for(let D=3;D<p;D+=4){const O=i?i[T[D]]:T[D];s[D]=s[D]*O*M|0}}function h(T,s,i){const p=T.length;for(let M=3;M<p;M+=4){const D=T[M-3]*77+T[M-2]*152+T[M-1]*28;s[M]=i?s[M]*i[D>>8]>>8:s[M]*D>>16}}function B(T,s,i,p,M,D,O,q,st,ht,pt){const yt=!!D,bt=yt?D[0]:0,_t=yt?D[1]:0,Q=yt?D[2]:0,Z=M==="Luminosity"?h:c,I=Math.min(p,Math.ceil(1048576/i));for(let Y=0;Y<p;Y+=I){const it=Math.min(I,p-Y),gt=T.getImageData(q-ht,Y+(st-pt),i,it),St=s.getImageData(q,Y+st,i,it);yt&&l(gt.data,bt,_t,Q),Z(gt.data,St.data,O),s.putImageData(St,q,Y+st)}}function a(T,s,i,p){const M=p[0],D=p[1],O=p[2]-M,q=p[3]-D;O===0||q===0||(B(s.context,i,O,q,s.subtype,s.backdrop,s.transferMap,M,D,s.offsetX,s.offsetY),T.save(),T.globalAlpha=1,T.globalCompositeOperation="source-over",T.setTransform(1,0,0,1,0,0),T.drawImage(i.canvas,0,0),T.restore())}function E(T,s){const i=n.Util.singularValueDecompose2dScale(T);i[0]=Math.fround(i[0]),i[1]=Math.fround(i[1]);const p=Math.fround((globalThis.devicePixelRatio||1)*u.PixelsPerInch.PDF_TO_CSS_UNITS);return s!==void 0?s:i[0]<=p||i[1]<=p}const R=["butt","round","square"],et=["miter","round","bevel"],V={},J={},nt=class nt{constructor(s,i,p,M,D,{optionalContentConfig:O,markedContentStack:q=null},st,ht){at(this,rt);this.ctx=s,this.current=new A(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=p,this.canvasFactory=M,this.filterFactory=D,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=q||[],this.optionalContentConfig=O,this.cachedCanvases=new S(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=st,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=ht,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(s,i=null){return typeof s=="string"?s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s):i}beginDrawing({transform:s,viewport:i,transparency:p=!1,background:M=null}){const D=this.ctx.canvas.width,O=this.ctx.canvas.height,q=this.ctx.fillStyle;if(this.ctx.fillStyle=M||"#ffffff",this.ctx.fillRect(0,0,D,O),this.ctx.fillStyle=q,p){const st=this.cachedCanvases.getCanvas("transparent",D,O);this.compositeCtx=this.ctx,this.transparentCanvas=st.canvas,this.ctx=st.context,this.ctx.save(),this.ctx.transform(...(0,u.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),d(this.ctx),s&&(this.ctx.transform(...s),this.outputScaleX=s[0],this.outputScaleY=s[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=(0,u.getCurrentTransform)(this.ctx)}executeOperatorList(s,i,p,M){const D=s.argsArray,O=s.fnArray;let q=i||0;const st=D.length;if(st===q)return q;const ht=st-q>j&&typeof p=="function",pt=ht?Date.now()+m:0;let yt=0;const bt=this.commonObjs,_t=this.objs;let Q;for(;;){if(M!==void 0&&q===M.nextBreakPoint)return M.breakIt(q,p),q;if(Q=O[q],Q!==n.OPS.dependency)this[Q].apply(this,D[q]);else for(const Z of D[q]){const y=Z.startsWith("g_")?bt:_t;if(!y.has(Z))return y.get(Z,p),q}if(q++,q===st)return q;if(ht&&++yt>j){if(Date.now()>pt)return p(),q;yt=0}}}endDrawing(){K(this,rt,qe).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const s of this._cachedBitmapsMap.values()){for(const i of s.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);s.clear()}this._cachedBitmapsMap.clear(),K(this,rt,Ye).call(this)}_scaleImage(s,i){const p=s.width,M=s.height;let D=Math.max(Math.hypot(i[0],i[1]),1),O=Math.max(Math.hypot(i[2],i[3]),1),q=p,st=M,ht="prescale1",pt,yt;for(;D>2&&q>1||O>2&&st>1;){let bt=q,_t=st;D>2&&q>1&&(bt=q>=16384?Math.floor(q/2)-1||1:Math.ceil(q/2),D/=q/bt),O>2&&st>1&&(_t=st>=16384?Math.floor(st/2)-1||1:Math.ceil(st)/2,O/=st/_t),pt=this.cachedCanvases.getCanvas(ht,bt,_t),yt=pt.context,yt.clearRect(0,0,bt,_t),yt.drawImage(s,0,0,q,st,0,0,bt,_t),s=pt.canvas,q=bt,st=_t,ht=ht==="prescale1"?"prescale2":"prescale1"}return{img:s,paintWidth:q,paintHeight:st}}_createMaskCanvas(s){const i=this.ctx,{width:p,height:M}=s,D=this.current.fillColor,O=this.current.patternFill,q=(0,u.getCurrentTransform)(i);let st,ht,pt,yt;if((s.bitmap||s.data)&&s.count>1){const tt=s.bitmap||s.data.buffer;ht=JSON.stringify(O?q:[q.slice(0,4),D]),st=this._cachedBitmapsMap.get(tt),st||(st=new Map,this._cachedBitmapsMap.set(tt,st));const wt=st.get(ht);if(wt&&!O){const Pt=Math.round(Math.min(q[0],q[2])+q[4]),Wt=Math.round(Math.min(q[1],q[3])+q[5]);return{canvas:wt,offsetX:Pt,offsetY:Wt}}pt=wt}pt||(yt=this.cachedCanvases.getCanvas("maskCanvas",p,M),v(yt.context,s));let bt=n.Util.transform(q,[1/p,0,0,-1/M,0,0]);bt=n.Util.transform(bt,[1,0,0,1,0,-M]);const _t=n.Util.applyTransform([0,0],bt),Q=n.Util.applyTransform([p,M],bt),Z=n.Util.normalizeRect([_t[0],_t[1],Q[0],Q[1]]),y=Math.round(Z[2]-Z[0])||1,I=Math.round(Z[3]-Z[1])||1,Y=this.cachedCanvases.getCanvas("fillCanvas",y,I),it=Y.context,gt=Math.min(_t[0],Q[0]),St=Math.min(_t[1],Q[1]);it.translate(-gt,-St),it.transform(...bt),pt||(pt=this._scaleImage(yt.canvas,(0,u.getCurrentTransformInverse)(it)),pt=pt.img,st&&O&&st.set(ht,pt)),it.imageSmoothingEnabled=E((0,u.getCurrentTransform)(it),s.interpolate),g(it,pt,0,0,pt.width,pt.height,0,0,p,M),it.globalCompositeOperation="source-in";const vt=n.Util.transform((0,u.getCurrentTransformInverse)(it),[1,0,0,1,-gt,-St]);return it.fillStyle=O?D.getPattern(i,this,vt,z.PathType.FILL):D,it.fillRect(0,0,p,M),st&&!O&&(this.cachedCanvases.delete("fillCanvas"),st.set(ht,Y.canvas)),{canvas:Y.canvas,offsetX:Math.round(gt),offsetY:Math.round(St)}}setLineWidth(s){s!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=s,this.ctx.lineWidth=s}setLineCap(s){this.ctx.lineCap=R[s]}setLineJoin(s){this.ctx.lineJoin=et[s]}setMiterLimit(s){this.ctx.miterLimit=s}setDash(s,i){const p=this.ctx;p.setLineDash!==void 0&&(p.setLineDash(s),p.lineDashOffset=i)}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[i,p]of s)switch(i){case"LW":this.setLineWidth(p);break;case"LC":this.setLineCap(p);break;case"LJ":this.setLineJoin(p);break;case"ML":this.setMiterLimit(p);break;case"D":this.setDash(p[0],p[1]);break;case"RI":this.setRenderingIntent(p);break;case"FL":this.setFlatness(p);break;case"Font":this.setFont(p[0],p[1]);break;case"CA":this.current.strokeAlpha=p;break;case"ca":this.current.fillAlpha=p,this.ctx.globalAlpha=p;break;case"BM":this.ctx.globalCompositeOperation=p;break;case"SMask":this.current.activeSMask=p?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(p);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const s=this.inSMaskMode;this.current.activeSMask&&!s?this.beginSMaskMode():!this.current.activeSMask&&s&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const s=this.ctx.canvas.width,i=this.ctx.canvas.height,p="smaskGroupAt"+this.groupLevel,M=this.cachedCanvases.getCanvas(p,s,i);this.suspendedCtx=this.ctx,this.ctx=M.context;const D=this.ctx;D.setTransform(...(0,u.getCurrentTransform)(this.suspendedCtx)),o(this.suspendedCtx,D),b(D,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),o(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(s){if(!this.current.activeSMask)return;s?(s[0]=Math.floor(s[0]),s[1]=Math.floor(s[1]),s[2]=Math.ceil(s[2]),s[3]=Math.ceil(s[3])):s=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,p=this.suspendedCtx;a(p,i,this.ctx,s),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(o(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const s=this.current;this.stateStack.push(s),this.current=s.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),o(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(s,i,p,M,D,O){this.ctx.transform(s,i,p,M,D,O),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(s,i,p){const M=this.ctx,D=this.current;let O=D.x,q=D.y,st,ht;const pt=(0,u.getCurrentTransform)(M),yt=pt[0]===0&&pt[3]===0||pt[1]===0&&pt[2]===0,bt=yt?p.slice(0):null;for(let _t=0,Q=0,Z=s.length;_t<Z;_t++)switch(s[_t]|0){case n.OPS.rectangle:O=i[Q++],q=i[Q++];const y=i[Q++],I=i[Q++],Y=O+y,it=q+I;M.moveTo(O,q),y===0||I===0?M.lineTo(Y,it):(M.lineTo(Y,q),M.lineTo(Y,it),M.lineTo(O,it)),yt||D.updateRectMinMax(pt,[O,q,Y,it]),M.closePath();break;case n.OPS.moveTo:O=i[Q++],q=i[Q++],M.moveTo(O,q),yt||D.updatePathMinMax(pt,O,q);break;case n.OPS.lineTo:O=i[Q++],q=i[Q++],M.lineTo(O,q),yt||D.updatePathMinMax(pt,O,q);break;case n.OPS.curveTo:st=O,ht=q,O=i[Q+4],q=i[Q+5],M.bezierCurveTo(i[Q],i[Q+1],i[Q+2],i[Q+3],O,q),D.updateCurvePathMinMax(pt,st,ht,i[Q],i[Q+1],i[Q+2],i[Q+3],O,q,bt),Q+=6;break;case n.OPS.curveTo2:st=O,ht=q,M.bezierCurveTo(O,q,i[Q],i[Q+1],i[Q+2],i[Q+3]),D.updateCurvePathMinMax(pt,st,ht,O,q,i[Q],i[Q+1],i[Q+2],i[Q+3],bt),O=i[Q+2],q=i[Q+3],Q+=4;break;case n.OPS.curveTo3:st=O,ht=q,O=i[Q+2],q=i[Q+3],M.bezierCurveTo(i[Q],i[Q+1],O,q,O,q),D.updateCurvePathMinMax(pt,st,ht,i[Q],i[Q+1],O,q,O,q,bt),Q+=4;break;case n.OPS.closePath:M.closePath();break}yt&&D.updateScalingPathMinMax(pt,bt),D.setCurrentPoint(O,q)}closePath(){this.ctx.closePath()}stroke(s=!0){const i=this.ctx,p=this.current.strokeColor;i.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof p=="object"&&(p!=null&&p.getPattern)?(i.save(),i.strokeStyle=p.getPattern(i,this,(0,u.getCurrentTransformInverse)(i),z.PathType.STROKE),this.rescaleAndStroke(!1),i.restore()):this.rescaleAndStroke(!0)),s&&this.consumePath(this.current.getClippedPathBoundingBox()),i.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(s=!0){const i=this.ctx,p=this.current.fillColor,M=this.current.patternFill;let D=!1;M&&(i.save(),i.fillStyle=p.getPattern(i,this,(0,u.getCurrentTransformInverse)(i),z.PathType.FILL),D=!0);const O=this.current.getClippedPathBoundingBox();this.contentVisible&&O!==null&&(this.pendingEOFill?(i.fill("evenodd"),this.pendingEOFill=!1):i.fill()),D&&i.restore(),s&&this.consumePath(O)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=V}eoClip(){this.pendingClip=J}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const s=this.pendingTextPaths,i=this.ctx;if(s===void 0){i.beginPath();return}i.save(),i.beginPath();for(const p of s)i.setTransform(...p.transform),i.translate(p.x,p.y),p.addToPath(i,p.fontSize);i.restore(),i.clip(),i.beginPath(),delete this.pendingTextPaths}setCharSpacing(s){this.current.charSpacing=s}setWordSpacing(s){this.current.wordSpacing=s}setHScale(s){this.current.textHScale=s/100}setLeading(s){this.current.leading=-s}setFont(s,i){var pt;const p=this.commonObjs.get(s),M=this.current;if(!p)throw new Error(`Can't find font for ${s}`);if(M.fontMatrix=p.fontMatrix||n.FONT_IDENTITY_MATRIX,(M.fontMatrix[0]===0||M.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+s),i<0?(i=-i,M.fontDirection=-1):M.fontDirection=1,this.current.font=p,this.current.fontSize=i,p.isType3Font)return;const D=p.loadedName||"sans-serif",O=((pt=p.systemFontInfo)==null?void 0:pt.css)||`"${D}", ${p.fallbackName}`;let q="normal";p.black?q="900":p.bold&&(q="bold");const st=p.italic?"italic":"normal";let ht=i;i<ut?ht=ut:i>k&&(ht=k),this.current.fontSizeScale=i/ht,this.ctx.font=`${st} ${q} ${ht}px ${O}`}setTextRenderingMode(s){this.current.textRenderingMode=s}setTextRise(s){this.current.textRise=s}moveText(s,i){this.current.x=this.current.lineX+=s,this.current.y=this.current.lineY+=i}setLeadingMoveText(s,i){this.setLeading(-i),this.moveText(s,i)}setTextMatrix(s,i,p,M,D,O){this.current.textMatrix=[s,i,p,M,D,O],this.current.textMatrixScale=Math.hypot(s,i),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(s,i,p,M){const D=this.ctx,O=this.current,q=O.font,st=O.textRenderingMode,ht=O.fontSize/O.fontSizeScale,pt=st&n.TextRenderingMode.FILL_STROKE_MASK,yt=!!(st&n.TextRenderingMode.ADD_TO_PATH_FLAG),bt=O.patternFill&&!q.missingFile;let _t;(q.disableFontFace||yt||bt)&&(_t=q.getPathGenerator(this.commonObjs,s)),q.disableFontFace||bt?(D.save(),D.translate(i,p),D.beginPath(),_t(D,ht),M&&D.setTransform(...M),(pt===n.TextRenderingMode.FILL||pt===n.TextRenderingMode.FILL_STROKE)&&D.fill(),(pt===n.TextRenderingMode.STROKE||pt===n.TextRenderingMode.FILL_STROKE)&&D.stroke(),D.restore()):((pt===n.TextRenderingMode.FILL||pt===n.TextRenderingMode.FILL_STROKE)&&D.fillText(s,i,p),(pt===n.TextRenderingMode.STROKE||pt===n.TextRenderingMode.FILL_STROKE)&&D.strokeText(s,i,p)),yt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,u.getCurrentTransform)(D),x:i,y:p,fontSize:ht,addToPath:_t})}get isFontSubpixelAAEnabled(){const{context:s}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);s.scale(1.5,1),s.fillText("I",0,10);const i=s.getImageData(0,0,10,10).data;let p=!1;for(let M=3;M<i.length;M+=4)if(i[M]>0&&i[M]<255){p=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",p)}showText(s){const i=this.current,p=i.font;if(p.isType3Font)return this.showType3Text(s);const M=i.fontSize;if(M===0)return;const D=this.ctx,O=i.fontSizeScale,q=i.charSpacing,st=i.wordSpacing,ht=i.fontDirection,pt=i.textHScale*ht,yt=s.length,bt=p.vertical,_t=bt?1:-1,Q=p.defaultVMetrics,Z=M*i.fontMatrix[0],y=i.textRenderingMode===n.TextRenderingMode.FILL&&!p.disableFontFace&&!i.patternFill;D.save(),D.transform(...i.textMatrix),D.translate(i.x,i.y+i.textRise),ht>0?D.scale(pt,-1):D.scale(pt,1);let I;if(i.patternFill){D.save();const vt=i.fillColor.getPattern(D,this,(0,u.getCurrentTransformInverse)(D),z.PathType.FILL);I=(0,u.getCurrentTransform)(D),D.restore(),D.fillStyle=vt}let Y=i.lineWidth;const it=i.textMatrixScale;if(it===0||Y===0){const vt=i.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(vt===n.TextRenderingMode.STROKE||vt===n.TextRenderingMode.FILL_STROKE)&&(Y=this.getSinglePixelWidth())}else Y/=it;if(O!==1&&(D.scale(O,O),Y/=O),D.lineWidth=Y,p.isInvalidPDFjsFont){const vt=[];let tt=0;for(const wt of s)vt.push(wt.unicode),tt+=wt.width;D.fillText(vt.join(""),0,0),i.x+=tt*Z*pt,D.restore(),this.compose();return}let gt=0,St;for(St=0;St<yt;++St){const vt=s[St];if(typeof vt=="number"){gt+=_t*vt*M/1e3;continue}let tt=!1;const wt=(vt.isSpace?st:0)+q,Pt=vt.fontChar,Wt=vt.accent;let Ut,zt,Ft=vt.width;if(bt){const Gt=vt.vmetric||Q,qt=-(vt.vmetric?Gt[1]:Ft*.5)*Z,Et=Gt[2]*Z;Ft=Gt?-Gt[0]:Ft,Ut=qt/O,zt=(gt+Et)/O}else Ut=gt/O,zt=0;if(p.remeasure&&Ft>0){const Gt=D.measureText(Pt).width*1e3/M*O;if(Ft<Gt&&this.isFontSubpixelAAEnabled){const qt=Ft/Gt;tt=!0,D.save(),D.scale(qt,1),Ut/=qt}else Ft!==Gt&&(Ut+=(Ft-Gt)/2e3*M/O)}if(this.contentVisible&&(vt.isInFont||p.missingFile)){if(y&&!Wt)D.fillText(Pt,Ut,zt);else if(this.paintChar(Pt,Ut,zt,I),Wt){const Gt=Ut+M*Wt.offset.x/O,qt=zt-M*Wt.offset.y/O;this.paintChar(Wt.fontChar,Gt,qt,I)}}const It=bt?Ft*Z-wt*ht:Ft*Z+wt*ht;gt+=It,tt&&D.restore()}bt?i.y-=gt:i.x+=gt*pt,D.restore(),this.compose()}showType3Text(s){const i=this.ctx,p=this.current,M=p.font,D=p.fontSize,O=p.fontDirection,q=M.vertical?1:-1,st=p.charSpacing,ht=p.wordSpacing,pt=p.textHScale*O,yt=p.fontMatrix||n.FONT_IDENTITY_MATRIX,bt=s.length,_t=p.textRenderingMode===n.TextRenderingMode.INVISIBLE;let Q,Z,y,I;if(!(_t||D===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),i.transform(...p.textMatrix),i.translate(p.x,p.y),i.scale(pt,O),Q=0;Q<bt;++Q){if(Z=s[Q],typeof Z=="number"){I=q*Z*D/1e3,this.ctx.translate(I,0),p.x+=I*pt;continue}const Y=(Z.isSpace?ht:0)+st,it=M.charProcOperatorList[Z.operatorListId];if(!it){(0,n.warn)(`Type3 character "${Z.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Z,this.save(),i.scale(D,D),i.transform(...yt),this.executeOperatorList(it),this.restore()),y=n.Util.applyTransform([Z.width,0],yt)[0]*D+Y,i.translate(y,0),p.x+=y*pt}i.restore(),this.processingType3=null}}setCharWidth(s,i){}setCharWidthAndBounds(s,i,p,M,D,O){this.ctx.rect(p,M,D-p,O-M),this.ctx.clip(),this.endPath()}getColorN_Pattern(s){let i;if(s[0]==="TilingPattern"){const p=s[1],M=this.baseTransform||(0,u.getCurrentTransform)(this.ctx),D={createCanvasGraphics:O=>new nt(O,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};i=new z.TilingPattern(s,p,this.ctx,D,M)}else i=this._getPattern(s[1],s[2]);return i}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(s,i,p){const M=n.Util.makeHexColor(s,i,p);this.ctx.strokeStyle=M,this.current.strokeColor=M}setFillRGBColor(s,i,p){const M=n.Util.makeHexColor(s,i,p);this.ctx.fillStyle=M,this.current.fillColor=M,this.current.patternFill=!1}_getPattern(s,i=null){let p;return this.cachedPatterns.has(s)?p=this.cachedPatterns.get(s):(p=(0,z.getShadingPattern)(this.getObject(s)),this.cachedPatterns.set(s,p)),i&&(p.matrix=i),p}shadingFill(s){if(!this.contentVisible)return;const i=this.ctx;this.save();const p=this._getPattern(s);i.fillStyle=p.getPattern(i,this,(0,u.getCurrentTransformInverse)(i),z.PathType.SHADING);const M=(0,u.getCurrentTransformInverse)(i);if(M){const{width:D,height:O}=i.canvas,[q,st,ht,pt]=n.Util.getAxialAlignedBoundingBox([0,0,D,O],M);this.ctx.fillRect(q,st,ht-q,pt-st)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(s,i){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(s)&&s.length===6&&this.transform(...s),this.baseTransform=(0,u.getCurrentTransform)(this.ctx),i)){const p=i[2]-i[0],M=i[3]-i[1];this.ctx.rect(i[0],i[1],p,M),this.current.updateRectMinMax((0,u.getCurrentTransform)(this.ctx),i),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(s){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;s.isolated||(0,n.info)("TODO: Support non-isolated groups."),s.knockout&&(0,n.warn)("Knockout groups not supported.");const p=(0,u.getCurrentTransform)(i);if(s.matrix&&i.transform(...s.matrix),!s.bbox)throw new Error("Bounding box is required.");let M=n.Util.getAxialAlignedBoundingBox(s.bbox,(0,u.getCurrentTransform)(i));const D=[0,0,i.canvas.width,i.canvas.height];M=n.Util.intersect(M,D)||[0,0,0,0];const O=Math.floor(M[0]),q=Math.floor(M[1]);let st=Math.max(Math.ceil(M[2])-O,1),ht=Math.max(Math.ceil(M[3])-q,1),pt=1,yt=1;st>w&&(pt=st/w,st=w),ht>w&&(yt=ht/w,ht=w),this.current.startNewPathAndClipBox([0,0,st,ht]);let bt="groupAt"+this.groupLevel;s.smask&&(bt+="_smask_"+this.smaskCounter++%2);const _t=this.cachedCanvases.getCanvas(bt,st,ht),Q=_t.context;Q.scale(1/pt,1/yt),Q.translate(-O,-q),Q.transform(...p),s.smask?this.smaskStack.push({canvas:_t.canvas,context:Q,offsetX:O,offsetY:q,scaleX:pt,scaleY:yt,subtype:s.smask.subtype,backdrop:s.smask.backdrop,transferMap:s.smask.transferMap||null,startTransformInverse:null}):(i.setTransform(1,0,0,1,0,0),i.translate(O,q),i.scale(pt,yt),i.save()),o(i,Q),this.ctx=Q,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(s){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,p=this.groupStack.pop();if(this.ctx=p,this.ctx.imageSmoothingEnabled=!1,s.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const M=(0,u.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...M);const D=n.Util.getAxialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],M);this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(D)}}beginAnnotation(s,i,p,M,D){if(K(this,rt,qe).call(this),d(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(i)&&i.length===4){const O=i[2]-i[0],q=i[3]-i[1];if(D&&this.annotationCanvasMap){p=p.slice(),p[4]-=i[0],p[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=O,i[3]=q;const[st,ht]=n.Util.singularValueDecompose2dScale((0,u.getCurrentTransform)(this.ctx)),{viewportScale:pt}=this,yt=Math.ceil(O*this.outputScaleX*pt),bt=Math.ceil(q*this.outputScaleY*pt);this.annotationCanvas=this.canvasFactory.create(yt,bt);const{canvas:_t,context:Q}=this.annotationCanvas;this.annotationCanvasMap.set(s,_t),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Q,this.ctx.save(),this.ctx.setTransform(st,0,0,-ht,0,q*ht),d(this.ctx)}else d(this.ctx),this.ctx.rect(i[0],i[1],O,q),this.ctx.clip(),this.endPath()}this.current=new A(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...p),this.transform(...M)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),K(this,rt,Ye).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(s){if(!this.contentVisible)return;const i=s.count;s=this.getObject(s.data,s),s.count=i;const p=this.ctx,M=this.processingType3;if(M&&(M.compiled===void 0&&(M.compiled=f(s)),M.compiled)){M.compiled(p);return}const D=this._createMaskCanvas(s),O=D.canvas;p.save(),p.setTransform(1,0,0,1,0,0),p.drawImage(O,D.offsetX,D.offsetY),p.restore(),this.compose()}paintImageMaskXObjectRepeat(s,i,p=0,M=0,D,O){if(!this.contentVisible)return;s=this.getObject(s.data,s);const q=this.ctx;q.save();const st=(0,u.getCurrentTransform)(q);q.transform(i,p,M,D,0,0);const ht=this._createMaskCanvas(s);q.setTransform(1,0,0,1,ht.offsetX-st[4],ht.offsetY-st[5]);for(let pt=0,yt=O.length;pt<yt;pt+=2){const bt=n.Util.transform(st,[i,p,M,D,O[pt],O[pt+1]]),[_t,Q]=n.Util.applyTransform([0,0],bt);q.drawImage(ht.canvas,_t,Q)}q.restore(),this.compose()}paintImageMaskXObjectGroup(s){if(!this.contentVisible)return;const i=this.ctx,p=this.current.fillColor,M=this.current.patternFill;for(const D of s){const{data:O,width:q,height:st,transform:ht}=D,pt=this.cachedCanvases.getCanvas("maskCanvas",q,st),yt=pt.context;yt.save();const bt=this.getObject(O,D);v(yt,bt),yt.globalCompositeOperation="source-in",yt.fillStyle=M?p.getPattern(yt,this,(0,u.getCurrentTransformInverse)(i),z.PathType.FILL):p,yt.fillRect(0,0,q,st),yt.restore(),i.save(),i.transform(...ht),i.scale(1,-1),g(i,pt.canvas,0,0,q,st,0,-1,1,1),i.restore()}this.compose()}paintImageXObject(s){if(!this.contentVisible)return;const i=this.getObject(s);if(!i){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(i)}paintImageXObjectRepeat(s,i,p,M){if(!this.contentVisible)return;const D=this.getObject(s);if(!D){(0,n.warn)("Dependent image isn't ready yet");return}const O=D.width,q=D.height,st=[];for(let ht=0,pt=M.length;ht<pt;ht+=2)st.push({transform:[i,0,0,p,M[ht],M[ht+1]],x:0,y:0,w:O,h:q});this.paintInlineImageXObjectGroup(D,st)}applyTransferMapsToCanvas(s){return this.current.transferMaps!=="none"&&(s.filter=this.current.transferMaps,s.drawImage(s.canvas,0,0),s.filter="none"),s.canvas}applyTransferMapsToBitmap(s){if(this.current.transferMaps==="none")return s.bitmap;const{bitmap:i,width:p,height:M}=s,D=this.cachedCanvases.getCanvas("inlineImage",p,M),O=D.context;return O.filter=this.current.transferMaps,O.drawImage(i,0,0),O.filter="none",D.canvas}paintInlineImageXObject(s){if(!this.contentVisible)return;const i=s.width,p=s.height,M=this.ctx;if(this.save(),!n.isNodeJS){const{filter:q}=M;q!=="none"&&q!==""&&(M.filter="none")}M.scale(1/i,-1/p);let D;if(s.bitmap)D=this.applyTransferMapsToBitmap(s);else if(typeof HTMLElement=="function"&&s instanceof HTMLElement||!s.data)D=s;else{const st=this.cachedCanvases.getCanvas("inlineImage",i,p).context;L(st,s),D=this.applyTransferMapsToCanvas(st)}const O=this._scaleImage(D,(0,u.getCurrentTransformInverse)(M));M.imageSmoothingEnabled=E((0,u.getCurrentTransform)(M),s.interpolate),g(M,O.img,0,0,O.paintWidth,O.paintHeight,0,-p,i,p),this.compose(),this.restore()}paintInlineImageXObjectGroup(s,i){if(!this.contentVisible)return;const p=this.ctx;let M;if(s.bitmap)M=s.bitmap;else{const D=s.width,O=s.height,st=this.cachedCanvases.getCanvas("inlineImage",D,O).context;L(st,s),M=this.applyTransferMapsToCanvas(st)}for(const D of i)p.save(),p.transform(...D.transform),p.scale(1,-1),g(p,M,D.x,D.y,D.w,D.h,0,-1,1,1),p.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(s){}markPointProps(s,i){}beginMarkedContent(s){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(s,i){s==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(s){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const p=this.ctx;this.pendingClip&&(i||(this.pendingClip===J?p.clip("evenodd"):p.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),p.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const s=(0,u.getCurrentTransform)(this.ctx);if(s[1]===0&&s[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(s[0]),Math.abs(s[3]));else{const i=Math.abs(s[0]*s[3]-s[2]*s[1]),p=Math.hypot(s[0],s[2]),M=Math.hypot(s[1],s[3]);this._cachedGetSinglePixelWidth=Math.max(p,M)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:s}=this.current,{a:i,b:p,c:M,d:D}=this.ctx.getTransform();let O,q;if(p===0&&M===0){const st=Math.abs(i),ht=Math.abs(D);if(st===ht)if(s===0)O=q=1/st;else{const pt=st*s;O=q=pt<1?1/pt:1}else if(s===0)O=1/st,q=1/ht;else{const pt=st*s,yt=ht*s;O=pt<1?1/pt:1,q=yt<1?1/yt:1}}else{const st=Math.abs(i*D-p*M),ht=Math.hypot(i,p),pt=Math.hypot(M,D);if(s===0)O=pt/st,q=ht/st;else{const yt=s*st;O=pt>yt?pt/yt:1,q=ht>yt?ht/yt:1}}this._cachedScaleForStroking[0]=O,this._cachedScaleForStroking[1]=q}return this._cachedScaleForStroking}rescaleAndStroke(s){const{ctx:i}=this,{lineWidth:p}=this.current,[M,D]=this.getScaleForStroking();if(i.lineWidth=p||1,M===1&&D===1){i.stroke();return}const O=i.getLineDash();if(s&&i.save(),i.scale(M,D),O.length>0){const q=Math.max(M,D);i.setLineDash(O.map(st=>st/q)),i.lineDashOffset/=q}i.stroke(),s&&i.restore()}isContentVisible(){for(let s=this.markedContentStack.length-1;s>=0;s--)if(!this.markedContentStack[s].visible)return!1;return!0}};rt=new WeakSet,qe=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Ye=function(){if(this.pageColors){const s=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(s!=="none"){const i=this.ctx.filter;this.ctx.filter=s,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}};let G=nt;e.CanvasGraphics=G;for(const T in n.OPS)G.prototype[T]!==void 0&&(G.prototype[n.OPS[T]]=G.prototype[T])},(x,e,N)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=_;var n=N(1),u=N(6);const z={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=z;function H(f,A){if(!A)return;const L=A[2]-A[0],v=A[3]-A[1],o=new Path2D;o.rect(A[0],A[1],L,v),f.clip(o)}class ut{constructor(){this.constructor===ut&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class k extends ut{constructor(A){super(),this._type=A[1],this._bbox=A[2],this._colorStops=A[3],this._p0=A[4],this._p1=A[5],this._r0=A[6],this._r1=A[7],this.matrix=null}_createGradient(A){let L;this._type==="axial"?L=A.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(L=A.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const v of this._colorStops)L.addColorStop(v[0],v[1]);return L}getPattern(A,L,v,o){let d;if(o===z.STROKE||o===z.FILL){const l=L.current.getClippedPathBoundingBox(o,(0,u.getCurrentTransform)(A))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,B=L.cachedCanvases.getCanvas("pattern",c,h,!0),a=B.context;a.clearRect(0,0,a.canvas.width,a.canvas.height),a.beginPath(),a.rect(0,0,a.canvas.width,a.canvas.height),a.translate(-l[0],-l[1]),v=n.Util.transform(v,[1,0,0,1,l[0],l[1]]),a.transform(...L.baseTransform),this.matrix&&a.transform(...this.matrix),H(a,this._bbox),a.fillStyle=this._createGradient(a),a.fill(),d=A.createPattern(B.canvas,"no-repeat");const E=new DOMMatrix(v);d.setTransform(E)}else H(A,this._bbox),d=this._createGradient(A);return d}}function w(f,A,L,v,o,d,l,c){const h=A.coords,B=A.colors,a=f.data,E=f.width*4;let R;h[L+1]>h[v+1]&&(R=L,L=v,v=R,R=d,d=l,l=R),h[v+1]>h[o+1]&&(R=v,v=o,o=R,R=l,l=c,c=R),h[L+1]>h[v+1]&&(R=L,L=v,v=R,R=d,d=l,l=R);const et=(h[L]+A.offsetX)*A.scaleX,V=(h[L+1]+A.offsetY)*A.scaleY,J=(h[v]+A.offsetX)*A.scaleX,G=(h[v+1]+A.offsetY)*A.scaleY,rt=(h[o]+A.offsetX)*A.scaleX,C=(h[o+1]+A.offsetY)*A.scaleY;if(V>=C)return;const $=B[d],nt=B[d+1],T=B[d+2],s=B[l],i=B[l+1],p=B[l+2],M=B[c],D=B[c+1],O=B[c+2],q=Math.round(V),st=Math.round(C);let ht,pt,yt,bt,_t,Q,Z,y;for(let I=q;I<=st;I++){if(I<G){const vt=I<V?0:(V-I)/(V-G);ht=et-(et-J)*vt,pt=$-($-s)*vt,yt=nt-(nt-i)*vt,bt=T-(T-p)*vt}else{let vt;I>C?vt=1:G===C?vt=0:vt=(G-I)/(G-C),ht=J-(J-rt)*vt,pt=s-(s-M)*vt,yt=i-(i-D)*vt,bt=p-(p-O)*vt}let Y;I<V?Y=0:I>C?Y=1:Y=(V-I)/(V-C),_t=et-(et-rt)*Y,Q=$-($-M)*Y,Z=nt-(nt-D)*Y,y=T-(T-O)*Y;const it=Math.round(Math.min(ht,_t)),gt=Math.round(Math.max(ht,_t));let St=E*I+it*4;for(let vt=it;vt<=gt;vt++)Y=(ht-vt)/(ht-_t),Y<0?Y=0:Y>1&&(Y=1),a[St++]=pt-(pt-Q)*Y|0,a[St++]=yt-(yt-Z)*Y|0,a[St++]=bt-(bt-y)*Y|0,a[St++]=255}}function m(f,A,L){const v=A.coords,o=A.colors;let d,l;switch(A.type){case"lattice":const c=A.verticesPerRow,h=Math.floor(v.length/c)-1,B=c-1;for(d=0;d<h;d++){let a=d*c;for(let E=0;E<B;E++,a++)w(f,L,v[a],v[a+1],v[a+c],o[a],o[a+1],o[a+c]),w(f,L,v[a+c+1],v[a+1],v[a+c],o[a+c+1],o[a+1],o[a+c])}break;case"triangles":for(d=0,l=v.length;d<l;d+=3)w(f,L,v[d],v[d+1],v[d+2],o[d],o[d+1],o[d+2]);break;default:throw new Error("illegal figure")}}class j extends ut{constructor(A){super(),this._coords=A[2],this._colors=A[3],this._figures=A[4],this._bounds=A[5],this._bbox=A[7],this._background=A[8],this.matrix=null}_createMeshCanvas(A,L,v){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),B=Math.ceil(this._bounds[2])-c,a=Math.ceil(this._bounds[3])-h,E=Math.min(Math.ceil(Math.abs(B*A[0]*1.1)),3e3),R=Math.min(Math.ceil(Math.abs(a*A[1]*1.1)),3e3),et=B/E,V=a/R,J={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/et,scaleY:1/V},G=E+2*2,rt=R+2*2,C=v.getCanvas("mesh",G,rt,!1),$=C.context,nt=$.createImageData(E,R);if(L){const s=nt.data;for(let i=0,p=s.length;i<p;i+=4)s[i]=L[0],s[i+1]=L[1],s[i+2]=L[2],s[i+3]=255}for(const s of this._figures)m(nt,s,J);return $.putImageData(nt,2,2),{canvas:C.canvas,offsetX:c-2*et,offsetY:h-2*V,scaleX:et,scaleY:V}}getPattern(A,L,v,o){H(A,this._bbox);let d;if(o===z.SHADING)d=n.Util.singularValueDecompose2dScale((0,u.getCurrentTransform)(A));else if(d=n.Util.singularValueDecompose2dScale(L.baseTransform),this.matrix){const c=n.Util.singularValueDecompose2dScale(this.matrix);d=[d[0]*c[0],d[1]*c[1]]}const l=this._createMeshCanvas(d,o===z.SHADING?null:this._background,L.cachedCanvases);return o!==z.SHADING&&(A.setTransform(...L.baseTransform),this.matrix&&A.transform(...this.matrix)),A.translate(l.offsetX,l.offsetY),A.scale(l.scaleX,l.scaleY),A.createPattern(l.canvas,"no-repeat")}}class U extends ut{getPattern(){return"hotpink"}}function _(f){switch(f[0]){case"RadialAxial":return new k(f);case"Mesh":return new j(f);case"Dummy":return new U}throw new Error(`Unknown IR type: ${f[0]}`)}const b={COLORED:1,UNCOLORED:2},g=class g{constructor(A,L,v,o,d){this.operatorList=A[2],this.matrix=A[3]||[1,0,0,1,0,0],this.bbox=A[4],this.xstep=A[5],this.ystep=A[6],this.paintType=A[7],this.tilingType=A[8],this.color=L,this.ctx=v,this.canvasGraphicsFactory=o,this.baseTransform=d}createPatternCanvas(A){const L=this.operatorList,v=this.bbox,o=this.xstep,d=this.ystep,l=this.paintType,c=this.tilingType,h=this.color,B=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+c);const a=v[0],E=v[1],R=v[2],et=v[3],V=n.Util.singularValueDecompose2dScale(this.matrix),J=n.Util.singularValueDecompose2dScale(this.baseTransform),G=[V[0]*J[0],V[1]*J[1]],rt=this.getSizeAndScale(o,this.ctx.canvas.width,G[0]),C=this.getSizeAndScale(d,this.ctx.canvas.height,G[1]),$=A.cachedCanvases.getCanvas("pattern",rt.size,C.size,!0),nt=$.context,T=B.createCanvasGraphics(nt);T.groupLevel=A.groupLevel,this.setFillAndStrokeStyleToContext(T,l,h);let s=a,i=E,p=R,M=et;return a<0&&(s=0,p+=Math.abs(a)),E<0&&(i=0,M+=Math.abs(E)),nt.translate(-(rt.scale*s),-(C.scale*i)),T.transform(rt.scale,0,0,C.scale,0,0),nt.save(),this.clipBbox(T,s,i,p,M),T.baseTransform=(0,u.getCurrentTransform)(T.ctx),T.executeOperatorList(L),T.endDrawing(),{canvas:$.canvas,scaleX:rt.scale,scaleY:C.scale,offsetX:s,offsetY:i}}getSizeAndScale(A,L,v){A=Math.abs(A);const o=Math.max(g.MAX_PATTERN_SIZE,L);let d=Math.ceil(A*v);return d>=o?d=o:v=d/A,{scale:v,size:d}}clipBbox(A,L,v,o,d){const l=o-L,c=d-v;A.ctx.rect(L,v,l,c),A.current.updateRectMinMax((0,u.getCurrentTransform)(A.ctx),[L,v,o,d]),A.clip(),A.endPath()}setFillAndStrokeStyleToContext(A,L,v){const o=A.ctx,d=A.current;switch(L){case b.COLORED:const l=this.ctx;o.fillStyle=l.fillStyle,o.strokeStyle=l.strokeStyle,d.fillColor=l.fillStyle,d.strokeColor=l.strokeStyle;break;case b.UNCOLORED:const c=n.Util.makeHexColor(v[0],v[1],v[2]);o.fillStyle=c,o.strokeStyle=c,d.fillColor=c,d.strokeColor=c;break;default:throw new n.FormatError(`Unsupported paint type: ${L}`)}}getPattern(A,L,v,o){let d=v;o!==z.SHADING&&(d=n.Util.transform(d,L.baseTransform),this.matrix&&(d=n.Util.transform(d,this.matrix)));const l=this.createPatternCanvas(L);let c=new DOMMatrix(d);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const h=A.createPattern(l.canvas,"repeat");return h.setTransform(c),h}};Jt(g,"MAX_PATTERN_SIZE",3e3);let S=g;e.TilingPattern=S},(x,e,N)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=z,e.convertToRGBA=u,e.grayToRGBA=ut;var n=N(1);function u(k){switch(k.kind){case n.ImageKind.GRAYSCALE_1BPP:return z(k);case n.ImageKind.RGB_24BPP:return H(k)}return null}function z({src:k,srcPos:w=0,dest:m,width:j,height:U,nonBlackColor:_=4294967295,inverseDecode:b=!1}){const S=n.FeatureTest.isLittleEndian?4278190080:255,[g,f]=b?[_,S]:[S,_],A=j>>3,L=j&7,v=k.length;m=new Uint32Array(m.buffer);let o=0;for(let d=0;d<U;d++){for(const c=w+A;w<c;w++){const h=w<v?k[w]:255;m[o++]=h&128?f:g,m[o++]=h&64?f:g,m[o++]=h&32?f:g,m[o++]=h&16?f:g,m[o++]=h&8?f:g,m[o++]=h&4?f:g,m[o++]=h&2?f:g,m[o++]=h&1?f:g}if(L===0)continue;const l=w<v?k[w++]:255;for(let c=0;c<L;c++)m[o++]=l&1<<7-c?f:g}return{srcPos:w,destPos:o}}function H({src:k,srcPos:w=0,dest:m,destPos:j=0,width:U,height:_}){let b=0;const S=k.length>>2,g=new Uint32Array(k.buffer,w,S);if(n.FeatureTest.isLittleEndian){for(;b<S-2;b+=3,j+=4){const f=g[b],A=g[b+1],L=g[b+2];m[j]=f|4278190080,m[j+1]=f>>>24|A<<8|4278190080,m[j+2]=A>>>16|L<<16|4278190080,m[j+3]=L>>>8|4278190080}for(let f=b*4,A=k.length;f<A;f+=3)m[j++]=k[f]|k[f+1]<<8|k[f+2]<<16|4278190080}else{for(;b<S-2;b+=3,j+=4){const f=g[b],A=g[b+1],L=g[b+2];m[j]=f|255,m[j+1]=f<<24|A>>>8|255,m[j+2]=A<<16|L>>>16|255,m[j+3]=L<<8|255}for(let f=b*4,A=k.length;f<A;f+=3)m[j++]=k[f]<<24|k[f+1]<<16|k[f+2]<<8|255}return{srcPos:w,destPos:j}}function ut(k,w){if(n.FeatureTest.isLittleEndian)for(let m=0,j=k.length;m<j;m++)w[m]=k[m]*65793|4278190080;else for(let m=0,j=k.length;m<j;m++)w[m]=k[m]*16843008|255}},(x,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const N=Object.create(null);e.GlobalWorkerOptions=N,N.workerPort=null,N.workerSrc=""},(x,e,N)=>{var k,wn,Cn,Te;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var n=N(1);const u={DATA:1,ERROR:2},z={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function H(U){switch(U instanceof Error||typeof U=="object"&&U!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),U.name){case"AbortException":return new n.AbortException(U.message);case"MissingPDFException":return new n.MissingPDFException(U.message);case"PasswordException":return new n.PasswordException(U.message,U.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(U.message,U.status);case"UnknownErrorException":return new n.UnknownErrorException(U.message,U.details);default:return new n.UnknownErrorException(U.message,U.toString())}}class ut{constructor(_,b,S){at(this,k);this.sourceName=_,this.targetName=b,this.comObj=S,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=g=>{const f=g.data;if(f.targetName!==this.sourceName)return;if(f.stream){K(this,k,Cn).call(this,f);return}if(f.callback){const L=f.callbackId,v=this.callbackCapabilities[L];if(!v)throw new Error(`Cannot resolve callback ${L}`);if(delete this.callbackCapabilities[L],f.callback===u.DATA)v.resolve(f.data);else if(f.callback===u.ERROR)v.reject(H(f.reason));else throw new Error("Unexpected callback case");return}const A=this.actionHandler[f.action];if(!A)throw new Error(`Unknown action from worker: ${f.action}`);if(f.callbackId){const L=this.sourceName,v=f.sourceName;new Promise(function(o){o(A(f.data))}).then(function(o){S.postMessage({sourceName:L,targetName:v,callback:u.DATA,callbackId:f.callbackId,data:o})},function(o){S.postMessage({sourceName:L,targetName:v,callback:u.ERROR,callbackId:f.callbackId,reason:H(o)})});return}if(f.streamId){K(this,k,wn).call(this,f);return}A(f.data)},S.addEventListener("message",this._onComObjOnMessage)}on(_,b){const S=this.actionHandler;if(S[_])throw new Error(`There is already an actionName called "${_}"`);S[_]=b}send(_,b,S){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:_,data:b},S)}sendWithPromise(_,b,S){const g=this.callbackId++,f=new n.PromiseCapability;this.callbackCapabilities[g]=f;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:_,callbackId:g,data:b},S)}catch(A){f.reject(A)}return f.promise}sendWithStream(_,b,S,g){const f=this.streamId++,A=this.sourceName,L=this.targetName,v=this.comObj;return new ReadableStream({start:o=>{const d=new n.PromiseCapability;return this.streamControllers[f]={controller:o,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},v.postMessage({sourceName:A,targetName:L,action:_,streamId:f,data:b,desiredSize:o.desiredSize},g),d.promise},pull:o=>{const d=new n.PromiseCapability;return this.streamControllers[f].pullCall=d,v.postMessage({sourceName:A,targetName:L,stream:z.PULL,streamId:f,desiredSize:o.desiredSize}),d.promise},cancel:o=>{(0,n.assert)(o instanceof Error,"cancel must have a valid reason");const d=new n.PromiseCapability;return this.streamControllers[f].cancelCall=d,this.streamControllers[f].isClosed=!0,v.postMessage({sourceName:A,targetName:L,stream:z.CANCEL,streamId:f,reason:H(o)}),d.promise}},S)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}k=new WeakSet,wn=function(_){const b=_.streamId,S=this.sourceName,g=_.sourceName,f=this.comObj,A=this,L=this.actionHandler[_.action],v={enqueue(o,d=1,l){if(this.isCancelled)return;const c=this.desiredSize;this.desiredSize-=d,c>0&&this.desiredSize<=0&&(this.sinkCapability=new n.PromiseCapability,this.ready=this.sinkCapability.promise),f.postMessage({sourceName:S,targetName:g,stream:z.ENQUEUE,streamId:b,chunk:o},l)},close(){this.isCancelled||(this.isCancelled=!0,f.postMessage({sourceName:S,targetName:g,stream:z.CLOSE,streamId:b}),delete A.streamSinks[b])},error(o){(0,n.assert)(o instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,f.postMessage({sourceName:S,targetName:g,stream:z.ERROR,streamId:b,reason:H(o)}))},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:_.desiredSize,ready:null};v.sinkCapability.resolve(),v.ready=v.sinkCapability.promise,this.streamSinks[b]=v,new Promise(function(o){o(L(_.data,v))}).then(function(){f.postMessage({sourceName:S,targetName:g,stream:z.START_COMPLETE,streamId:b,success:!0})},function(o){f.postMessage({sourceName:S,targetName:g,stream:z.START_COMPLETE,streamId:b,reason:H(o)})})},Cn=function(_){const b=_.streamId,S=this.sourceName,g=_.sourceName,f=this.comObj,A=this.streamControllers[b],L=this.streamSinks[b];switch(_.stream){case z.START_COMPLETE:_.success?A.startCall.resolve():A.startCall.reject(H(_.reason));break;case z.PULL_COMPLETE:_.success?A.pullCall.resolve():A.pullCall.reject(H(_.reason));break;case z.PULL:if(!L){f.postMessage({sourceName:S,targetName:g,stream:z.PULL_COMPLETE,streamId:b,success:!0});break}L.desiredSize<=0&&_.desiredSize>0&&L.sinkCapability.resolve(),L.desiredSize=_.desiredSize,new Promise(function(v){var o;v((o=L.onPull)==null?void 0:o.call(L))}).then(function(){f.postMessage({sourceName:S,targetName:g,stream:z.PULL_COMPLETE,streamId:b,success:!0})},function(v){f.postMessage({sourceName:S,targetName:g,stream:z.PULL_COMPLETE,streamId:b,reason:H(v)})});break;case z.ENQUEUE:if((0,n.assert)(A,"enqueue should have stream controller"),A.isClosed)break;A.controller.enqueue(_.chunk);break;case z.CLOSE:if((0,n.assert)(A,"close should have stream controller"),A.isClosed)break;A.isClosed=!0,A.controller.close(),K(this,k,Te).call(this,A,b);break;case z.ERROR:(0,n.assert)(A,"error should have stream controller"),A.controller.error(H(_.reason)),K(this,k,Te).call(this,A,b);break;case z.CANCEL_COMPLETE:_.success?A.cancelCall.resolve():A.cancelCall.reject(H(_.reason)),K(this,k,Te).call(this,A,b);break;case z.CANCEL:if(!L)break;new Promise(function(v){var o;v((o=L.onCancel)==null?void 0:o.call(L,H(_.reason)))}).then(function(){f.postMessage({sourceName:S,targetName:g,stream:z.CANCEL_COMPLETE,streamId:b,success:!0})},function(v){f.postMessage({sourceName:S,targetName:g,stream:z.CANCEL_COMPLETE,streamId:b,reason:H(v)})}),L.sinkCapability.reject(H(_.reason)),L.isCancelled=!0,delete this.streamSinks[b];break;default:throw new Error("Unexpected stream case")}},Te=async function(_,b){var S,g,f;await Promise.allSettled([(S=_.startCall)==null?void 0:S.promise,(g=_.pullCall)==null?void 0:g.promise,(f=_.cancelCall)==null?void 0:f.promise]),delete this.streamControllers[b]},e.MessageHandler=ut},(x,e,N)=>{var z,H;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=N(1);class u{constructor({parsedData:k,rawData:w}){at(this,z);at(this,H);lt(this,z,k),lt(this,H,w)}getRaw(){return t(this,H)}get(k){return t(this,z).get(k)??null}getAll(){return(0,n.objectFromMap)(t(this,z))}has(k){return t(this,z).has(k)}}z=new WeakMap,H=new WeakMap,e.Metadata=u},(x,e,N)=>{var k,w,m,j,U,_,Ke;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=N(1),u=N(8);const z=Symbol("INTERNAL");class H{constructor(g,f){at(this,k,!0);this.name=g,this.intent=f}get visible(){return t(this,k)}_setVisible(g,f){g!==z&&(0,n.unreachable)("Internal method `_setVisible` called."),lt(this,k,f)}}k=new WeakMap;class ut{constructor(g){at(this,_);at(this,w,null);at(this,m,new Map);at(this,j,null);at(this,U,null);if(this.name=null,this.creator=null,g!==null){this.name=g.name,this.creator=g.creator,lt(this,U,g.order);for(const f of g.groups)t(this,m).set(f.id,new H(f.name,f.intent));if(g.baseState==="OFF")for(const f of t(this,m).values())f._setVisible(z,!1);for(const f of g.on)t(this,m).get(f)._setVisible(z,!0);for(const f of g.off)t(this,m).get(f)._setVisible(z,!1);lt(this,j,this.getHash())}}isVisible(g){if(t(this,m).size===0)return!0;if(!g)return(0,n.warn)("Optional content group not defined."),!0;if(g.type==="OCG")return t(this,m).has(g.id)?t(this,m).get(g.id).visible:((0,n.warn)(`Optional content group not found: ${g.id}`),!0);if(g.type==="OCMD"){if(g.expression)return K(this,_,Ke).call(this,g.expression);if(!g.policy||g.policy==="AnyOn"){for(const f of g.ids){if(!t(this,m).has(f))return(0,n.warn)(`Optional content group not found: ${f}`),!0;if(t(this,m).get(f).visible)return!0}return!1}else if(g.policy==="AllOn"){for(const f of g.ids){if(!t(this,m).has(f))return(0,n.warn)(`Optional content group not found: ${f}`),!0;if(!t(this,m).get(f).visible)return!1}return!0}else if(g.policy==="AnyOff"){for(const f of g.ids){if(!t(this,m).has(f))return(0,n.warn)(`Optional content group not found: ${f}`),!0;if(!t(this,m).get(f).visible)return!0}return!1}else if(g.policy==="AllOff"){for(const f of g.ids){if(!t(this,m).has(f))return(0,n.warn)(`Optional content group not found: ${f}`),!0;if(t(this,m).get(f).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${g.policy}.`),!0}return(0,n.warn)(`Unknown group type ${g.type}.`),!0}setVisibility(g,f=!0){if(!t(this,m).has(g)){(0,n.warn)(`Optional content group not found: ${g}`);return}t(this,m).get(g)._setVisible(z,!!f),lt(this,w,null)}get hasInitialVisibility(){return t(this,j)===null||this.getHash()===t(this,j)}getOrder(){return t(this,m).size?t(this,U)?t(this,U).slice():[...t(this,m).keys()]:null}getGroups(){return t(this,m).size>0?(0,n.objectFromMap)(t(this,m)):null}getGroup(g){return t(this,m).get(g)||null}getHash(){if(t(this,w)!==null)return t(this,w);const g=new u.MurmurHash3_64;for(const[f,A]of t(this,m))g.update(`${f}:${A.visible}`);return lt(this,w,g.hexdigest())}}w=new WeakMap,m=new WeakMap,j=new WeakMap,U=new WeakMap,_=new WeakSet,Ke=function(g){const f=g.length;if(f<2)return!0;const A=g[0];for(let L=1;L<f;L++){const v=g[L];let o;if(Array.isArray(v))o=K(this,_,Ke).call(this,v);else if(t(this,m).has(v))o=t(this,m).get(v).visible;else return(0,n.warn)(`Optional content group not found: ${v}`),!0;switch(A){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return A==="And"},e.OptionalContentConfig=ut},(x,e,N)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var n=N(1),u=N(6);class z{constructor({length:w,initialData:m,progressiveDone:j=!1,contentDispositionFilename:U=null,disableRange:_=!1,disableStream:b=!1},S){if((0,n.assert)(S,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=j,this._contentDispositionFilename=U,(m==null?void 0:m.length)>0){const g=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;this._queuedChunks.push(g)}this._pdfDataRangeTransport=S,this._isStreamingSupported=!b,this._isRangeSupported=!_,this._contentLength=w,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((g,f)=>{this._onReceiveData({begin:g,chunk:f})}),this._pdfDataRangeTransport.addProgressListener((g,f)=>{this._onProgress({loaded:g,total:f})}),this._pdfDataRangeTransport.addProgressiveReadListener(g=>{this._onReceiveData({chunk:g})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:w,chunk:m}){const j=m instanceof Uint8Array&&m.byteLength===m.buffer.byteLength?m.buffer:new Uint8Array(m).buffer;if(w===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(j):this._queuedChunks.push(j);else{const U=this._rangeReaders.some(function(_){return _._begin!==w?!1:(_._enqueue(j),!0)});(0,n.assert)(U,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var w;return((w=this._fullRequestReader)==null?void 0:w._loaded)??0}_onProgress(w){var m,j,U,_;w.total===void 0?(j=(m=this._rangeReaders[0])==null?void 0:m.onProgress)==null||j.call(m,{loaded:w.loaded}):(_=(U=this._fullRequestReader)==null?void 0:U.onProgress)==null||_.call(U,{loaded:w.loaded,total:w.total})}_onProgressiveDone(){var w;(w=this._fullRequestReader)==null||w.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(w){const m=this._rangeReaders.indexOf(w);m>=0&&this._rangeReaders.splice(m,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const w=this._queuedChunks;return this._queuedChunks=null,new H(this,w,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(w,m){if(m<=this._progressiveDataLength)return null;const j=new ut(this,w,m);return this._pdfDataRangeTransport.requestDataRange(w,m),this._rangeReaders.push(j),j}cancelAllRequests(w){var m;(m=this._fullRequestReader)==null||m.cancel(w);for(const j of this._rangeReaders.slice(0))j.cancel(w);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=z;class H{constructor(w,m,j=!1,U=null){this._stream=w,this._done=j||!1,this._filename=(0,u.isPdfFile)(U)?U:null,this._queuedChunks=m||[],this._loaded=0;for(const _ of this._queuedChunks)this._loaded+=_.byteLength;this._requests=[],this._headersReady=Promise.resolve(),w._fullRequestReader=this,this.onProgress=null}_enqueue(w){this._done||(this._requests.length>0?this._requests.shift().resolve({value:w,done:!1}):this._queuedChunks.push(w),this._loaded+=w.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const w=new n.PromiseCapability;return this._requests.push(w),w.promise}cancel(w){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class ut{constructor(w,m,j){this._stream=w,this._begin=m,this._end=j,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(w){if(!this._done){if(this._requests.length===0)this._queuedChunk=w;else{this._requests.shift().resolve({value:w,done:!1});for(const j of this._requests)j.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const w=new n.PromiseCapability;return this._requests.push(w),w.promise}cancel(w){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(x,e,N)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var n=N(1),u=N(20);function z(j,U,_){return{method:"GET",headers:j,signal:_.signal,mode:"cors",credentials:U?"include":"same-origin",redirect:"follow"}}function H(j){const U=new Headers;for(const _ in j){const b=j[_];b!==void 0&&U.append(_,b)}return U}function ut(j){return j instanceof Uint8Array?j.buffer:j instanceof ArrayBuffer?j:((0,n.warn)(`getArrayBuffer - unexpected data format: ${j}`),new Uint8Array(j).buffer)}class k{constructor(U){this.source=U,this.isHttp=/^https?:/i.test(U.url),this.httpHeaders=this.isHttp&&U.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var U;return((U=this._fullRequestReader)==null?void 0:U._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new w(this),this._fullRequestReader}getRangeReader(U,_){if(_<=this._progressiveDataLength)return null;const b=new m(this,U,_);return this._rangeRequestReaders.push(b),b}cancelAllRequests(U){var _;(_=this._fullRequestReader)==null||_.cancel(U);for(const b of this._rangeRequestReaders.slice(0))b.cancel(U)}}e.PDFFetchStream=k;class w{constructor(U){this._stream=U,this._reader=null,this._loaded=0,this._filename=null;const _=U.source;this._withCredentials=_.withCredentials||!1,this._contentLength=_.length,this._headersCapability=new n.PromiseCapability,this._disableRange=_.disableRange||!1,this._rangeChunkSize=_.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!_.disableStream,this._isRangeSupported=!_.disableRange,this._headers=H(this._stream.httpHeaders);const b=_.url;fetch(b,z(this._headers,this._withCredentials,this._abortController)).then(S=>{if(!(0,u.validateResponseStatus)(S.status))throw(0,u.createResponseStatusError)(S.status,b);this._reader=S.body.getReader(),this._headersCapability.resolve();const g=L=>S.headers.get(L),{allowRangeRequests:f,suggestedLength:A}=(0,u.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=f,this._contentLength=A||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var b;await this._headersCapability.promise;const{value:U,done:_}=await this._reader.read();return _?{value:U,done:_}:(this._loaded+=U.byteLength,(b=this.onProgress)==null||b.call(this,{loaded:this._loaded,total:this._contentLength}),{value:ut(U),done:!1})}cancel(U){var _;(_=this._reader)==null||_.cancel(U),this._abortController.abort()}}class m{constructor(U,_,b){this._stream=U,this._reader=null,this._loaded=0;const S=U.source;this._withCredentials=S.withCredentials||!1,this._readCapability=new n.PromiseCapability,this._isStreamingSupported=!S.disableStream,this._abortController=new AbortController,this._headers=H(this._stream.httpHeaders),this._headers.append("Range",`bytes=${_}-${b-1}`);const g=S.url;fetch(g,z(this._headers,this._withCredentials,this._abortController)).then(f=>{if(!(0,u.validateResponseStatus)(f.status))throw(0,u.createResponseStatusError)(f.status,g);this._readCapability.resolve(),this._reader=f.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var b;await this._readCapability.promise;const{value:U,done:_}=await this._reader.read();return _?{value:U,done:_}:(this._loaded+=U.byteLength,(b=this.onProgress)==null||b.call(this,{loaded:this._loaded}),{value:ut(U),done:!1})}cancel(U){var _;(_=this._reader)==null||_.cancel(U),this._abortController.abort()}}},(x,e,N)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=k,e.extractFilenameFromHeader=ut,e.validateRangeRequestCapabilities=H,e.validateResponseStatus=w;var n=N(1),u=N(21),z=N(6);function H({getResponseHeader:m,isHttp:j,rangeChunkSize:U,disableRange:_}){const b={allowRangeRequests:!1,suggestedLength:void 0},S=parseInt(m("Content-Length"),10);return!Number.isInteger(S)||(b.suggestedLength=S,S<=2*U)||_||!j||m("Accept-Ranges")!=="bytes"||(m("Content-Encoding")||"identity")!=="identity"||(b.allowRangeRequests=!0),b}function ut(m){const j=m("Content-Disposition");if(j){let U=(0,u.getFilenameFromContentDispositionHeader)(j);if(U.includes("%"))try{U=decodeURIComponent(U)}catch{}if((0,z.isPdfFile)(U))return U}return null}function k(m,j){return m===404||m===0&&j.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+j+'".'):new n.UnexpectedResponseException(`Unexpected server response (${m}) while retrieving PDF "${j}".`,m)}function w(m){return m===200||m===206}},(x,e,N)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=u;var n=N(1);function u(z){let H=!0,ut=k("filename\\*","i").exec(z);if(ut){ut=ut[1];let S=U(ut);return S=unescape(S),S=_(S),S=b(S),m(S)}if(ut=j(z),ut){const S=b(ut);return m(S)}if(ut=k("filename","i").exec(z),ut){ut=ut[1];let S=U(ut);return S=b(S),m(S)}function k(S,g){return new RegExp("(?:^|;)\\s*"+S+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function w(S,g){if(S){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const f=new TextDecoder(S,{fatal:!0}),A=(0,n.stringToBytes)(g);g=f.decode(A),H=!1}catch{}}return g}function m(S){return H&&/[\x80-\xff]/.test(S)&&(S=w("utf-8",S),H&&(S=w("iso-8859-1",S))),S}function j(S){const g=[];let f;const A=k("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=A.exec(S))!==null;){let[,v,o,d]=f;if(v=parseInt(v,10),v in g){if(v===0)break;continue}g[v]=[o,d]}const L=[];for(let v=0;v<g.length&&v in g;++v){let[o,d]=g[v];d=U(d),o&&(d=unescape(d),v===0&&(d=_(d))),L.push(d)}return L.join("")}function U(S){if(S.startsWith('"')){const g=S.slice(1).split('\\"');for(let f=0;f<g.length;++f){const A=g[f].indexOf('"');A!==-1&&(g[f]=g[f].slice(0,A),g.length=f+1),g[f]=g[f].replaceAll(/\\(.)/g,"$1")}S=g.join('"')}return S}function _(S){const g=S.indexOf("'");if(g===-1)return S;const f=S.slice(0,g),L=S.slice(g+1).replace(/^[^']*'/,"");return w(f,L)}function b(S){return!S.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(S)?S:S.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,f,A,L){if(A==="q"||A==="Q")return L=L.replaceAll("_"," "),L=L.replaceAll(/=([0-9a-fA-F]{2})/g,function(v,o){return String.fromCharCode(parseInt(o,16))}),w(f,L);try{L=atob(L)}catch{}return w(f,L)})}return""}},(x,e,N)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var n=N(1),u=N(20);const z=200,H=206;function ut(U){const _=U.response;return typeof _!="string"?_:(0,n.stringToBytes)(_).buffer}class k{constructor(_,b={}){this.url=_,this.isHttp=/^https?:/i.test(_),this.httpHeaders=this.isHttp&&b.httpHeaders||Object.create(null),this.withCredentials=b.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(_,b,S){const g={begin:_,end:b};for(const f in S)g[f]=S[f];return this.request(g)}requestFull(_){return this.request(_)}request(_){const b=new XMLHttpRequest,S=this.currXhrId++,g=this.pendingRequests[S]={xhr:b};b.open("GET",this.url),b.withCredentials=this.withCredentials;for(const f in this.httpHeaders){const A=this.httpHeaders[f];A!==void 0&&b.setRequestHeader(f,A)}return this.isHttp&&"begin"in _&&"end"in _?(b.setRequestHeader("Range",`bytes=${_.begin}-${_.end-1}`),g.expectedStatus=H):g.expectedStatus=z,b.responseType="arraybuffer",_.onError&&(b.onerror=function(f){_.onError(b.status)}),b.onreadystatechange=this.onStateChange.bind(this,S),b.onprogress=this.onProgress.bind(this,S),g.onHeadersReceived=_.onHeadersReceived,g.onDone=_.onDone,g.onError=_.onError,g.onProgress=_.onProgress,b.send(null),S}onProgress(_,b){var g;const S=this.pendingRequests[_];S&&((g=S.onProgress)==null||g.call(S,b))}onStateChange(_,b){var v,o,d;const S=this.pendingRequests[_];if(!S)return;const g=S.xhr;if(g.readyState>=2&&S.onHeadersReceived&&(S.onHeadersReceived(),delete S.onHeadersReceived),g.readyState!==4||!(_ in this.pendingRequests))return;if(delete this.pendingRequests[_],g.status===0&&this.isHttp){(v=S.onError)==null||v.call(S,g.status);return}const f=g.status||z;if(!(f===z&&S.expectedStatus===H)&&f!==S.expectedStatus){(o=S.onError)==null||o.call(S,g.status);return}const L=ut(g);if(f===H){const l=g.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);S.onDone({begin:parseInt(c[1],10),chunk:L})}else L?S.onDone({begin:0,chunk:L}):(d=S.onError)==null||d.call(S,g.status)}getRequestXhr(_){return this.pendingRequests[_].xhr}isPendingRequest(_){return _ in this.pendingRequests}abortRequest(_){const b=this.pendingRequests[_].xhr;delete this.pendingRequests[_],b.abort()}}class w{constructor(_){this._source=_,this._manager=new k(_.url,{httpHeaders:_.httpHeaders,withCredentials:_.withCredentials}),this._rangeChunkSize=_.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(_){const b=this._rangeRequestReaders.indexOf(_);b>=0&&this._rangeRequestReaders.splice(b,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new m(this._manager,this._source),this._fullRequestReader}getRangeReader(_,b){const S=new j(this._manager,_,b);return S.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(S),S}cancelAllRequests(_){var b;(b=this._fullRequestReader)==null||b.cancel(_);for(const S of this._rangeRequestReaders.slice(0))S.cancel(_)}}e.PDFNetworkStream=w;class m{constructor(_,b){this._manager=_;const S={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=b.url,this._fullRequestId=_.requestFull(S),this._headersReceivedCapability=new n.PromiseCapability,this._disableRange=b.disableRange||!1,this._contentLength=b.length,this._rangeChunkSize=b.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const _=this._fullRequestId,b=this._manager.getRequestXhr(_),S=A=>b.getResponseHeader(A),{allowRangeRequests:g,suggestedLength:f}=(0,u.validateRangeRequestCapabilities)({getResponseHeader:S,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});g&&(this._isRangeSupported=!0),this._contentLength=f||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(S),this._isRangeSupported&&this._manager.abortRequest(_),this._headersReceivedCapability.resolve()}_onDone(_){if(_&&(this._requests.length>0?this._requests.shift().resolve({value:_.chunk,done:!1}):this._cachedChunks.push(_.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(_){this._storedError=(0,u.createResponseStatusError)(_,this._url),this._headersReceivedCapability.reject(this._storedError);for(const b of this._requests)b.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(_){var b;(b=this.onProgress)==null||b.call(this,{loaded:_.loaded,total:_.lengthComputable?_.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const _=new n.PromiseCapability;return this._requests.push(_),_.promise}cancel(_){this._done=!0,this._headersReceivedCapability.reject(_);for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class j{constructor(_,b,S){this._manager=_;const g={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=_.url,this._requestId=_.requestRange(b,S,g),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var _;(_=this.onClosed)==null||_.call(this,this)}_onDone(_){const b=_.chunk;this._requests.length>0?this._requests.shift().resolve({value:b,done:!1}):this._queuedChunk=b,this._done=!0;for(const S of this._requests)S.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(_){this._storedError=(0,u.createResponseStatusError)(_,this._url);for(const b of this._requests)b.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(_){var b;this.isStreamingSupported||(b=this.onProgress)==null||b.call(this,{loaded:_.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const b=this._queuedChunk;return this._queuedChunk=null,{value:b,done:!1}}if(this._done)return{value:void 0,done:!0};const _=new n.PromiseCapability;return this._requests.push(_),_.promise}cancel(_){this._done=!0;for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(x,e,N)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var n=N(1),u=N(20);const z=/^file:\/\/\/[a-zA-Z]:\//;function H(S){const g=require$$5,f=g.parse(S);return f.protocol==="file:"||f.host?f:/^[a-z]:[/\\]/i.test(S)?g.parse(`file:///${S}`):(f.host||(f.protocol="file:"),f)}class ut{constructor(g){this.source=g,this.url=H(g.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&g.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var g;return((g=this._fullRequestReader)==null?void 0:g._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new _(this):new j(this),this._fullRequestReader}getRangeReader(g,f){if(f<=this._progressiveDataLength)return null;const A=this.isFsUrl?new b(this,g,f):new U(this,g,f);return this._rangeRequestReaders.push(A),A}cancelAllRequests(g){var f;(f=this._fullRequestReader)==null||f.cancel(g);for(const A of this._rangeRequestReaders.slice(0))A.cancel(g)}}e.PDFNodeStream=ut;class k{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null;const f=g.source;this._contentLength=f.length,this._loaded=0,this._filename=null,this._disableRange=f.disableRange||!1,this._rangeChunkSize=f.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!f.disableStream,this._isRangeSupported=!f.disableRange,this._readableStream=null,this._readCapability=new n.PromiseCapability,this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var A;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=g.length,(A=this.onProgress)==null||A.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",f=>{this._error(f)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class w{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new n.PromiseCapability;const f=g.source;this._isStreamingSupported=!f.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var A;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=g.length,(A=this.onProgress)==null||A.call(this,{loaded:this._loaded}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",f=>{this._error(f)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function m(S,g){return{protocol:S.protocol,auth:S.auth,host:S.hostname,port:S.port,path:S.path,method:"GET",headers:g}}class j extends k{constructor(g){super(g);const f=A=>{if(A.statusCode===404){const d=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=d,this._headersCapability.reject(d);return}this._headersCapability.resolve(),this._setReadableStream(A);const L=d=>this._readableStream.headers[d.toLowerCase()],{allowRangeRequests:v,suggestedLength:o}=(0,u.validateRangeRequestCapabilities)({getResponseHeader:L,isHttp:g.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=v,this._contentLength=o||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(L)};if(this._request=null,this._url.protocol==="http:"){const A=require$$5;this._request=A.request(m(this._url,g.httpHeaders),f)}else{const A=require$$5;this._request=A.request(m(this._url,g.httpHeaders),f)}this._request.on("error",A=>{this._storedError=A,this._headersCapability.reject(A)}),this._request.end()}}class U extends w{constructor(g,f,A){super(g),this._httpHeaders={};for(const v in g.httpHeaders){const o=g.httpHeaders[v];o!==void 0&&(this._httpHeaders[v]=o)}this._httpHeaders.Range=`bytes=${f}-${A-1}`;const L=v=>{if(v.statusCode===404){const o=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=o;return}this._setReadableStream(v)};if(this._request=null,this._url.protocol==="http:"){const v=require$$5;this._request=v.request(m(this._url,this._httpHeaders),L)}else{const v=require$$5;this._request=v.request(m(this._url,this._httpHeaders),L)}this._request.on("error",v=>{this._storedError=v}),this._request.end()}}class _ extends k{constructor(g){super(g);let f=decodeURIComponent(this._url.path);z.test(this._url.href)&&(f=f.replace(/^\//,""));const A=require$$5;A.lstat(f,(L,v)=>{if(L){L.code==="ENOENT"&&(L=new n.MissingPDFException(`Missing PDF "${f}".`)),this._storedError=L,this._headersCapability.reject(L);return}this._contentLength=v.size,this._setReadableStream(A.createReadStream(f)),this._headersCapability.resolve()})}}class b extends w{constructor(g,f,A){super(g);let L=decodeURIComponent(this._url.path);z.test(this._url.href)&&(L=L.replace(/^\//,""));const v=require$$5;this._setReadableStream(v.createReadStream(L,{start:f,end:A-1}))}}},(x,e,N)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var n=N(6),u=N(1);const z={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},H="http://www.w3.org/XML/1998/namespace",ut="http://www.w3.org/1999/xlink",k=["butt","round","square"],w=["miter","round","bevel"],m=function(v,o="",d=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!d)return URL.createObjectURL(new Blob([v],{type:o}));const l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let c=`data:${o};base64,`;for(let h=0,B=v.length;h<B;h+=3){const a=v[h]&255,E=v[h+1]&255,R=v[h+2]&255,et=a>>2,V=(a&3)<<4|E>>4,J=h+1<B?(E&15)<<2|R>>6:64,G=h+2<B?R&63:64;c+=l[et]+l[V]+l[J]+l[G]}return c},j=function(){const v=new Uint8Array([137,80,78,71,13,10,26,10]),o=12,d=new Int32Array(256);for(let R=0;R<256;R++){let et=R;for(let V=0;V<8;V++)et=et&1?3988292384^et>>1&2147483647:et>>1&2147483647;d[R]=et}function l(R,et,V){let J=-1;for(let G=et;G<V;G++){const rt=(J^R[G])&255,C=d[rt];J=J>>>8^C}return J^-1}function c(R,et,V,J){let G=J;const rt=et.length;V[G]=rt>>24&255,V[G+1]=rt>>16&255,V[G+2]=rt>>8&255,V[G+3]=rt&255,G+=4,V[G]=R.charCodeAt(0)&255,V[G+1]=R.charCodeAt(1)&255,V[G+2]=R.charCodeAt(2)&255,V[G+3]=R.charCodeAt(3)&255,G+=4,V.set(et,G),G+=et.length;const C=l(V,J+4,G);V[G]=C>>24&255,V[G+1]=C>>16&255,V[G+2]=C>>8&255,V[G+3]=C&255}function h(R,et,V){let J=1,G=0;for(let rt=et;rt<V;++rt)J=(J+(R[rt]&255))%65521,G=(G+J)%65521;return G<<16|J}function B(R){if(!u.isNodeJS)return a(R);try{const et=parseInt(process.versions.node)>=8?R:Buffer.from(R),V=require$$5.deflateSync(et,{level:9});return V instanceof Uint8Array?V:new Uint8Array(V)}catch(et){(0,u.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+et)}return a(R)}function a(R){let et=R.length;const V=65535,J=Math.ceil(et/V),G=new Uint8Array(2+et+J*5+4);let rt=0;G[rt++]=120,G[rt++]=156;let C=0;for(;et>V;)G[rt++]=0,G[rt++]=255,G[rt++]=255,G[rt++]=0,G[rt++]=0,G.set(R.subarray(C,C+V),rt),rt+=V,C+=V,et-=V;G[rt++]=1,G[rt++]=et&255,G[rt++]=et>>8&255,G[rt++]=~et&65535&255,G[rt++]=(~et&65535)>>8&255,G.set(R.subarray(C),rt),rt+=R.length-C;const $=h(R,0,R.length);return G[rt++]=$>>24&255,G[rt++]=$>>16&255,G[rt++]=$>>8&255,G[rt++]=$&255,G}function E(R,et,V,J){const G=R.width,rt=R.height;let C,$,nt;const T=R.data;switch(et){case u.ImageKind.GRAYSCALE_1BPP:$=0,C=1,nt=G+7>>3;break;case u.ImageKind.RGB_24BPP:$=2,C=8,nt=G*3;break;case u.ImageKind.RGBA_32BPP:$=6,C=8,nt=G*4;break;default:throw new Error("invalid format")}const s=new Uint8Array((1+nt)*rt);let i=0,p=0;for(let ht=0;ht<rt;++ht)s[i++]=0,s.set(T.subarray(p,p+nt),i),p+=nt,i+=nt;if(et===u.ImageKind.GRAYSCALE_1BPP&&J){i=0;for(let ht=0;ht<rt;ht++){i++;for(let pt=0;pt<nt;pt++)s[i++]^=255}}const M=new Uint8Array([G>>24&255,G>>16&255,G>>8&255,G&255,rt>>24&255,rt>>16&255,rt>>8&255,rt&255,C,$,0,0,0]),D=B(s),O=v.length+o*3+M.length+D.length,q=new Uint8Array(O);let st=0;return q.set(v,st),st+=v.length,c("IHDR",M,q,st),st+=o+M.length,c("IDATA",D,q,st),st+=o+D.length,c("IEND",new Uint8Array(0),q,st),m(q,"image/png",V)}return function(et,V,J){const G=et.kind===void 0?u.ImageKind.GRAYSCALE_1BPP:et.kind;return E(et,G,V,J)}}();class U{constructor(){this.fontSizeScale=1,this.fontWeight=z.fontWeight,this.fontSize=0,this.textMatrix=u.IDENTITY_MATRIX,this.fontMatrix=u.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=u.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=z.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(o,d){this.x=o,this.y=d}}function _(v){let o=[];const d=[];for(const l of v){if(l.fn==="save"){o.push({fnId:92,fn:"group",items:[]}),d.push(o),o=o.at(-1).items;continue}l.fn==="restore"?o=d.pop():o.push(l)}return o}function b(v){if(Number.isInteger(v))return v.toString();const o=v.toFixed(10);let d=o.length-1;if(o[d]!=="0")return o;do d--;while(o[d]==="0");return o.substring(0,o[d]==="."?d:d+1)}function S(v){if(v[4]===0&&v[5]===0){if(v[1]===0&&v[2]===0)return v[0]===1&&v[3]===1?"":`scale(${b(v[0])} ${b(v[3])})`;if(v[0]===v[3]&&v[1]===-v[2]){const o=Math.acos(v[0])*180/Math.PI;return`rotate(${b(o)})`}}else if(v[0]===1&&v[1]===0&&v[2]===0&&v[3]===1)return`translate(${b(v[4])} ${b(v[5])})`;return`matrix(${b(v[0])} ${b(v[1])} ${b(v[2])} ${b(v[3])} ${b(v[4])} ${b(v[5])})`}let g=0,f=0,A=0;class L{constructor(o,d,l=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new U,this.transformMatrix=u.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=o,this.objs=d,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!l,this._operatorIdMapping=[];for(const c in u.OPS)this._operatorIdMapping[u.OPS[c]]=c}getObject(o,d=null){return typeof o=="string"?o.startsWith("g_")?this.commonObjs.get(o):this.objs.get(o):d}save(){this.transformStack.push(this.transformMatrix);const o=this.current;this.extraStack.push(o),this.current=o.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(o){this.save(),this.executeOpTree(o),this.restore()}loadDependencies(o){const d=o.fnArray,l=o.argsArray;for(let c=0,h=d.length;c<h;c++)if(d[c]===u.OPS.dependency)for(const B of l[c]){const a=B.startsWith("g_")?this.commonObjs:this.objs,E=new Promise(R=>{a.get(B,R)});this.current.dependencies.push(E)}return Promise.all(this.current.dependencies)}transform(o,d,l,c,h,B){const a=[o,d,l,c,h,B];this.transformMatrix=u.Util.transform(this.transformMatrix,a),this.tgrp=null}getSVG(o,d){this.viewport=d;const l=this._initialize(d);return this.loadDependencies(o).then(()=>(this.transformMatrix=u.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(o)),l))}convertOpList(o){const d=this._operatorIdMapping,l=o.argsArray,c=o.fnArray,h=[];for(let B=0,a=c.length;B<a;B++){const E=c[B];h.push({fnId:E,fn:d[E],args:l[B]})}return _(h)}executeOpTree(o){for(const d of o){const l=d.fn,c=d.fnId,h=d.args;switch(c|0){case u.OPS.beginText:this.beginText();break;case u.OPS.dependency:break;case u.OPS.setLeading:this.setLeading(h);break;case u.OPS.setLeadingMoveText:this.setLeadingMoveText(h[0],h[1]);break;case u.OPS.setFont:this.setFont(h);break;case u.OPS.showText:this.showText(h[0]);break;case u.OPS.showSpacedText:this.showText(h[0]);break;case u.OPS.endText:this.endText();break;case u.OPS.moveText:this.moveText(h[0],h[1]);break;case u.OPS.setCharSpacing:this.setCharSpacing(h[0]);break;case u.OPS.setWordSpacing:this.setWordSpacing(h[0]);break;case u.OPS.setHScale:this.setHScale(h[0]);break;case u.OPS.setTextMatrix:this.setTextMatrix(h[0],h[1],h[2],h[3],h[4],h[5]);break;case u.OPS.setTextRise:this.setTextRise(h[0]);break;case u.OPS.setTextRenderingMode:this.setTextRenderingMode(h[0]);break;case u.OPS.setLineWidth:this.setLineWidth(h[0]);break;case u.OPS.setLineJoin:this.setLineJoin(h[0]);break;case u.OPS.setLineCap:this.setLineCap(h[0]);break;case u.OPS.setMiterLimit:this.setMiterLimit(h[0]);break;case u.OPS.setFillRGBColor:this.setFillRGBColor(h[0],h[1],h[2]);break;case u.OPS.setStrokeRGBColor:this.setStrokeRGBColor(h[0],h[1],h[2]);break;case u.OPS.setStrokeColorN:this.setStrokeColorN(h);break;case u.OPS.setFillColorN:this.setFillColorN(h);break;case u.OPS.shadingFill:this.shadingFill(h[0]);break;case u.OPS.setDash:this.setDash(h[0],h[1]);break;case u.OPS.setRenderingIntent:this.setRenderingIntent(h[0]);break;case u.OPS.setFlatness:this.setFlatness(h[0]);break;case u.OPS.setGState:this.setGState(h[0]);break;case u.OPS.fill:this.fill();break;case u.OPS.eoFill:this.eoFill();break;case u.OPS.stroke:this.stroke();break;case u.OPS.fillStroke:this.fillStroke();break;case u.OPS.eoFillStroke:this.eoFillStroke();break;case u.OPS.clip:this.clip("nonzero");break;case u.OPS.eoClip:this.clip("evenodd");break;case u.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case u.OPS.paintImageXObject:this.paintImageXObject(h[0]);break;case u.OPS.paintInlineImageXObject:this.paintInlineImageXObject(h[0]);break;case u.OPS.paintImageMaskXObject:this.paintImageMaskXObject(h[0]);break;case u.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(h[0],h[1]);break;case u.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case u.OPS.closePath:this.closePath();break;case u.OPS.closeStroke:this.closeStroke();break;case u.OPS.closeFillStroke:this.closeFillStroke();break;case u.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case u.OPS.nextLine:this.nextLine();break;case u.OPS.transform:this.transform(h[0],h[1],h[2],h[3],h[4],h[5]);break;case u.OPS.constructPath:this.constructPath(h[0],h[1]);break;case u.OPS.endPath:this.endPath();break;case 92:this.group(d.items);break;default:(0,u.warn)(`Unimplemented operator ${l}`);break}}}setWordSpacing(o){this.current.wordSpacing=o}setCharSpacing(o){this.current.charSpacing=o}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(o,d,l,c,h,B){const a=this.current;a.textMatrix=a.lineMatrix=[o,d,l,c,h,B],a.textMatrixScale=Math.hypot(o,d),a.x=a.lineX=0,a.y=a.lineY=0,a.xcoords=[],a.ycoords=[],a.tspan=this.svgFactory.createElement("svg:tspan"),a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",`${b(a.fontSize)}px`),a.tspan.setAttributeNS(null,"y",b(-a.y)),a.txtElement=this.svgFactory.createElement("svg:text"),a.txtElement.append(a.tspan)}beginText(){const o=this.current;o.x=o.lineX=0,o.y=o.lineY=0,o.textMatrix=u.IDENTITY_MATRIX,o.lineMatrix=u.IDENTITY_MATRIX,o.textMatrixScale=1,o.tspan=this.svgFactory.createElement("svg:tspan"),o.txtElement=this.svgFactory.createElement("svg:text"),o.txtgrp=this.svgFactory.createElement("svg:g"),o.xcoords=[],o.ycoords=[]}moveText(o,d){const l=this.current;l.x=l.lineX+=o,l.y=l.lineY+=d,l.xcoords=[],l.ycoords=[],l.tspan=this.svgFactory.createElement("svg:tspan"),l.tspan.setAttributeNS(null,"font-family",l.fontFamily),l.tspan.setAttributeNS(null,"font-size",`${b(l.fontSize)}px`),l.tspan.setAttributeNS(null,"y",b(-l.y))}showText(o){const d=this.current,l=d.font,c=d.fontSize;if(c===0)return;const h=d.fontSizeScale,B=d.charSpacing,a=d.wordSpacing,E=d.fontDirection,R=d.textHScale*E,et=l.vertical,V=et?1:-1,J=l.defaultVMetrics,G=c*d.fontMatrix[0];let rt=0;for(const nt of o){if(nt===null){rt+=E*a;continue}else if(typeof nt=="number"){rt+=V*nt*c/1e3;continue}const T=(nt.isSpace?a:0)+B,s=nt.fontChar;let i,p,M=nt.width;if(et){let O;const q=nt.vmetric||J;O=nt.vmetric?q[1]:M*.5,O=-O*G;const st=q[2]*G;M=q?-q[0]:M,i=O/h,p=(rt+st)/h}else i=rt/h,p=0;(nt.isInFont||l.missingFile)&&(d.xcoords.push(d.x+i),et&&d.ycoords.push(-d.y+p),d.tspan.textContent+=s);const D=et?M*G-T*E:M*G+T*E;rt+=D}d.tspan.setAttributeNS(null,"x",d.xcoords.map(b).join(" ")),et?d.tspan.setAttributeNS(null,"y",d.ycoords.map(b).join(" ")):d.tspan.setAttributeNS(null,"y",b(-d.y)),et?d.y-=rt:d.x+=rt*R,d.tspan.setAttributeNS(null,"font-family",d.fontFamily),d.tspan.setAttributeNS(null,"font-size",`${b(d.fontSize)}px`),d.fontStyle!==z.fontStyle&&d.tspan.setAttributeNS(null,"font-style",d.fontStyle),d.fontWeight!==z.fontWeight&&d.tspan.setAttributeNS(null,"font-weight",d.fontWeight);const C=d.textRenderingMode&u.TextRenderingMode.FILL_STROKE_MASK;if(C===u.TextRenderingMode.FILL||C===u.TextRenderingMode.FILL_STROKE?(d.fillColor!==z.fillColor&&d.tspan.setAttributeNS(null,"fill",d.fillColor),d.fillAlpha<1&&d.tspan.setAttributeNS(null,"fill-opacity",d.fillAlpha)):d.textRenderingMode===u.TextRenderingMode.ADD_TO_PATH?d.tspan.setAttributeNS(null,"fill","transparent"):d.tspan.setAttributeNS(null,"fill","none"),C===u.TextRenderingMode.STROKE||C===u.TextRenderingMode.FILL_STROKE){const nt=1/(d.textMatrixScale||1);this._setStrokeAttributes(d.tspan,nt)}let $=d.textMatrix;d.textRise!==0&&($=$.slice(),$[5]+=d.textRise),d.txtElement.setAttributeNS(null,"transform",`${S($)} scale(${b(R)}, -1)`),d.txtElement.setAttributeNS(H,"xml:space","preserve"),d.txtElement.append(d.tspan),d.txtgrp.append(d.txtElement),this._ensureTransformGroup().append(d.txtElement)}setLeadingMoveText(o,d){this.setLeading(-d),this.moveText(o,d)}addFontStyle(o){if(!o.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const d=m(o.data,o.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${o.loadedName}"; src: url(${d}); }
`}setFont(o){const d=this.current,l=this.commonObjs.get(o[0]);let c=o[1];d.font=l,this.embedFonts&&!l.missingFile&&!this.embeddedFonts[l.loadedName]&&(this.addFontStyle(l),this.embeddedFonts[l.loadedName]=l),d.fontMatrix=l.fontMatrix||u.FONT_IDENTITY_MATRIX;let h="normal";l.black?h="900":l.bold&&(h="bold");const B=l.italic?"italic":"normal";c<0?(c=-c,d.fontDirection=-1):d.fontDirection=1,d.fontSize=c,d.fontFamily=l.loadedName,d.fontWeight=h,d.fontStyle=B,d.tspan=this.svgFactory.createElement("svg:tspan"),d.tspan.setAttributeNS(null,"y",b(-d.y)),d.xcoords=[],d.ycoords=[]}endText(){var d;const o=this.current;o.textRenderingMode&u.TextRenderingMode.ADD_TO_PATH_FLAG&&((d=o.txtElement)!=null&&d.hasChildNodes())&&(o.element=o.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(o){o>0&&(this.current.lineWidth=o)}setLineCap(o){this.current.lineCap=k[o]}setLineJoin(o){this.current.lineJoin=w[o]}setMiterLimit(o){this.current.miterLimit=o}setStrokeAlpha(o){this.current.strokeAlpha=o}setStrokeRGBColor(o,d,l){this.current.strokeColor=u.Util.makeHexColor(o,d,l)}setFillAlpha(o){this.current.fillAlpha=o}setFillRGBColor(o,d,l){this.current.fillColor=u.Util.makeHexColor(o,d,l),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(o){this.current.strokeColor=this._makeColorN_Pattern(o)}setFillColorN(o){this.current.fillColor=this._makeColorN_Pattern(o)}shadingFill(o){const{width:d,height:l}=this.viewport,c=u.Util.inverseTransform(this.transformMatrix),[h,B,a,E]=u.Util.getAxialAlignedBoundingBox([0,0,d,l],c),R=this.svgFactory.createElement("svg:rect");R.setAttributeNS(null,"x",h),R.setAttributeNS(null,"y",B),R.setAttributeNS(null,"width",a-h),R.setAttributeNS(null,"height",E-B),R.setAttributeNS(null,"fill",this._makeShadingPattern(o)),this.current.fillAlpha<1&&R.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(R)}_makeColorN_Pattern(o){return o[0]==="TilingPattern"?this._makeTilingPattern(o):this._makeShadingPattern(o)}_makeTilingPattern(o){const d=o[1],l=o[2],c=o[3]||u.IDENTITY_MATRIX,[h,B,a,E]=o[4],R=o[5],et=o[6],V=o[7],J=`shading${A++}`,[G,rt,C,$]=u.Util.normalizeRect([...u.Util.applyTransform([h,B],c),...u.Util.applyTransform([a,E],c)]),[nt,T]=u.Util.singularValueDecompose2dScale(c),s=R*nt,i=et*T,p=this.svgFactory.createElement("svg:pattern");p.setAttributeNS(null,"id",J),p.setAttributeNS(null,"patternUnits","userSpaceOnUse"),p.setAttributeNS(null,"width",s),p.setAttributeNS(null,"height",i),p.setAttributeNS(null,"x",`${G}`),p.setAttributeNS(null,"y",`${rt}`);const M=this.svg,D=this.transformMatrix,O=this.current.fillColor,q=this.current.strokeColor,st=this.svgFactory.create(C-G,$-rt);if(this.svg=st,this.transformMatrix=c,V===2){const ht=u.Util.makeHexColor(...d);this.current.fillColor=ht,this.current.strokeColor=ht}return this.executeOpTree(this.convertOpList(l)),this.svg=M,this.transformMatrix=D,this.current.fillColor=O,this.current.strokeColor=q,p.append(st.childNodes[0]),this.defs.append(p),`url(#${J})`}_makeShadingPattern(o){switch(typeof o=="string"&&(o=this.objs.get(o)),o[0]){case"RadialAxial":const d=`shading${A++}`,l=o[3];let c;switch(o[1]){case"axial":const h=o[4],B=o[5];c=this.svgFactory.createElement("svg:linearGradient"),c.setAttributeNS(null,"id",d),c.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),c.setAttributeNS(null,"x1",h[0]),c.setAttributeNS(null,"y1",h[1]),c.setAttributeNS(null,"x2",B[0]),c.setAttributeNS(null,"y2",B[1]);break;case"radial":const a=o[4],E=o[5],R=o[6],et=o[7];c=this.svgFactory.createElement("svg:radialGradient"),c.setAttributeNS(null,"id",d),c.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),c.setAttributeNS(null,"cx",E[0]),c.setAttributeNS(null,"cy",E[1]),c.setAttributeNS(null,"r",et),c.setAttributeNS(null,"fx",a[0]),c.setAttributeNS(null,"fy",a[1]),c.setAttributeNS(null,"fr",R);break;default:throw new Error(`Unknown RadialAxial type: ${o[1]}`)}for(const h of l){const B=this.svgFactory.createElement("svg:stop");B.setAttributeNS(null,"offset",h[0]),B.setAttributeNS(null,"stop-color",h[1]),c.append(B)}return this.defs.append(c),`url(#${d})`;case"Mesh":return(0,u.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${o[0]}`)}}setDash(o,d){this.current.dashArray=o,this.current.dashPhase=d}constructPath(o,d){const l=this.current;let c=l.x,h=l.y,B=[],a=0;for(const E of o)switch(E|0){case u.OPS.rectangle:c=d[a++],h=d[a++];const R=d[a++],et=d[a++],V=c+R,J=h+et;B.push("M",b(c),b(h),"L",b(V),b(h),"L",b(V),b(J),"L",b(c),b(J),"Z");break;case u.OPS.moveTo:c=d[a++],h=d[a++],B.push("M",b(c),b(h));break;case u.OPS.lineTo:c=d[a++],h=d[a++],B.push("L",b(c),b(h));break;case u.OPS.curveTo:c=d[a+4],h=d[a+5],B.push("C",b(d[a]),b(d[a+1]),b(d[a+2]),b(d[a+3]),b(c),b(h)),a+=6;break;case u.OPS.curveTo2:B.push("C",b(c),b(h),b(d[a]),b(d[a+1]),b(d[a+2]),b(d[a+3])),c=d[a+2],h=d[a+3],a+=4;break;case u.OPS.curveTo3:c=d[a+2],h=d[a+3],B.push("C",b(d[a]),b(d[a+1]),b(c),b(h),b(c),b(h)),a+=4;break;case u.OPS.closePath:B.push("Z");break}B=B.join(" "),l.path&&o.length>0&&o[0]!==u.OPS.rectangle&&o[0]!==u.OPS.moveTo?B=l.path.getAttributeNS(null,"d")+B:(l.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(l.path)),l.path.setAttributeNS(null,"d",B),l.path.setAttributeNS(null,"fill","none"),l.element=l.path,l.setCurrentPoint(c,h)}endPath(){const o=this.current;if(o.path=null,!this.pendingClip)return;if(!o.element){this.pendingClip=null;return}const d=`clippath${g++}`,l=this.svgFactory.createElement("svg:clipPath");l.setAttributeNS(null,"id",d),l.setAttributeNS(null,"transform",S(this.transformMatrix));const c=o.element.cloneNode(!0);if(this.pendingClip==="evenodd"?c.setAttributeNS(null,"clip-rule","evenodd"):c.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,l.append(c),this.defs.append(l),o.activeClipUrl){o.clipGroup=null;for(const h of this.extraStack)h.clipGroup=null;l.setAttributeNS(null,"clip-path",o.activeClipUrl)}o.activeClipUrl=`url(#${d})`,this.tgrp=null}clip(o){this.pendingClip=o}closePath(){const o=this.current;if(o.path){const d=`${o.path.getAttributeNS(null,"d")}Z`;o.path.setAttributeNS(null,"d",d)}}setLeading(o){this.current.leading=-o}setTextRise(o){this.current.textRise=o}setTextRenderingMode(o){this.current.textRenderingMode=o}setHScale(o){this.current.textHScale=o/100}setRenderingIntent(o){}setFlatness(o){}setGState(o){for(const[d,l]of o)switch(d){case"LW":this.setLineWidth(l);break;case"LC":this.setLineCap(l);break;case"LJ":this.setLineJoin(l);break;case"ML":this.setMiterLimit(l);break;case"D":this.setDash(l[0],l[1]);break;case"RI":this.setRenderingIntent(l);break;case"FL":this.setFlatness(l);break;case"Font":this.setFont(l);break;case"CA":this.setStrokeAlpha(l);break;case"ca":this.setFillAlpha(l);break;default:(0,u.warn)(`Unimplemented graphic state operator ${d}`);break}}fill(){const o=this.current;o.element&&(o.element.setAttributeNS(null,"fill",o.fillColor),o.element.setAttributeNS(null,"fill-opacity",o.fillAlpha),this.endPath())}stroke(){const o=this.current;o.element&&(this._setStrokeAttributes(o.element),o.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(o,d=1){const l=this.current;let c=l.dashArray;d!==1&&c.length>0&&(c=c.map(function(h){return d*h})),o.setAttributeNS(null,"stroke",l.strokeColor),o.setAttributeNS(null,"stroke-opacity",l.strokeAlpha),o.setAttributeNS(null,"stroke-miterlimit",b(l.miterLimit)),o.setAttributeNS(null,"stroke-linecap",l.lineCap),o.setAttributeNS(null,"stroke-linejoin",l.lineJoin),o.setAttributeNS(null,"stroke-width",b(d*l.lineWidth)+"px"),o.setAttributeNS(null,"stroke-dasharray",c.map(b).join(" ")),o.setAttributeNS(null,"stroke-dashoffset",b(d*l.dashPhase)+"px")}eoFill(){var o;(o=this.current.element)==null||o.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var o;(o=this.current.element)==null||o.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y","0"),o.setAttributeNS(null,"width","1px"),o.setAttributeNS(null,"height","1px"),o.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(o)}paintImageXObject(o){const d=this.getObject(o);if(!d){(0,u.warn)(`Dependent image with object ID ${o} is not ready yet`);return}this.paintInlineImageXObject(d)}paintInlineImageXObject(o,d){const l=o.width,c=o.height,h=j(o,this.forceDataSchema,!!d),B=this.svgFactory.createElement("svg:rect");B.setAttributeNS(null,"x","0"),B.setAttributeNS(null,"y","0"),B.setAttributeNS(null,"width",b(l)),B.setAttributeNS(null,"height",b(c)),this.current.element=B,this.clip("nonzero");const a=this.svgFactory.createElement("svg:image");a.setAttributeNS(ut,"xlink:href",h),a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y",b(-c)),a.setAttributeNS(null,"width",b(l)+"px"),a.setAttributeNS(null,"height",b(c)+"px"),a.setAttributeNS(null,"transform",`scale(${b(1/l)} ${b(-1/c)})`),d?d.append(a):this._ensureTransformGroup().append(a)}paintImageMaskXObject(o){const d=this.getObject(o.data,o);if(d.bitmap){(0,u.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const l=this.current,c=d.width,h=d.height,B=l.fillColor;l.maskId=`mask${f++}`;const a=this.svgFactory.createElement("svg:mask");a.setAttributeNS(null,"id",l.maskId);const E=this.svgFactory.createElement("svg:rect");E.setAttributeNS(null,"x","0"),E.setAttributeNS(null,"y","0"),E.setAttributeNS(null,"width",b(c)),E.setAttributeNS(null,"height",b(h)),E.setAttributeNS(null,"fill",B),E.setAttributeNS(null,"mask",`url(#${l.maskId})`),this.defs.append(a),this._ensureTransformGroup().append(E),this.paintInlineImageXObject(d,a)}paintFormXObjectBegin(o,d){if(Array.isArray(o)&&o.length===6&&this.transform(o[0],o[1],o[2],o[3],o[4],o[5]),d){const l=d[2]-d[0],c=d[3]-d[1],h=this.svgFactory.createElement("svg:rect");h.setAttributeNS(null,"x",d[0]),h.setAttributeNS(null,"y",d[1]),h.setAttributeNS(null,"width",b(l)),h.setAttributeNS(null,"height",b(c)),this.current.element=h,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(o){const d=this.svgFactory.create(o.width,o.height),l=this.svgFactory.createElement("svg:defs");d.append(l),this.defs=l;const c=this.svgFactory.createElement("svg:g");return c.setAttributeNS(null,"transform",S(o.transform)),d.append(c),this.svg=c,d}_ensureClipGroup(){if(!this.current.clipGroup){const o=this.svgFactory.createElement("svg:g");o.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(o),this.current.clipGroup=o}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",S(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=L},(x,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class N{static textContent(u){const z=[],H={items:z,styles:Object.create(null)};function ut(k){var j;if(!k)return;let w=null;const m=k.name;if(m==="#text")w=k.value;else if(N.shouldBuildText(m))(j=k==null?void 0:k.attributes)!=null&&j.textContent?w=k.attributes.textContent:k.value&&(w=k.value);else return;if(w!==null&&z.push({str:w}),!!k.children)for(const U of k.children)ut(U)}return ut(u),H}static shouldBuildText(u){return!(u==="textarea"||u==="input"||u==="option"||u==="select")}}e.XfaText=N},(x,e,N)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=S,e.updateTextLayer=g;var n=N(1),u=N(6);const z=1e5,H=30,ut=.8,k=new Map;function w(f,A){let L;if(A&&n.FeatureTest.isOffscreenCanvasSupported)L=new OffscreenCanvas(f,f).getContext("2d",{alpha:!1});else{const v=document.createElement("canvas");v.width=v.height=f,L=v.getContext("2d",{alpha:!1})}return L}function m(f,A){const L=k.get(f);if(L)return L;const v=w(H,A);v.font=`${H}px ${f}`;const o=v.measureText("");let d=o.fontBoundingBoxAscent,l=Math.abs(o.fontBoundingBoxDescent);if(d){const h=d/(d+l);return k.set(f,h),v.canvas.width=v.canvas.height=0,h}v.strokeStyle="red",v.clearRect(0,0,H,H),v.strokeText("g",0,0);let c=v.getImageData(0,0,H,H).data;l=0;for(let h=c.length-1-3;h>=0;h-=4)if(c[h]>0){l=Math.ceil(h/4/H);break}v.clearRect(0,0,H,H),v.strokeText("A",0,H),c=v.getImageData(0,0,H,H).data,d=0;for(let h=0,B=c.length;h<B;h+=4)if(c[h]>0){d=H-Math.floor(h/4/H);break}if(v.canvas.width=v.canvas.height=0,d){const h=d/(d+l);return k.set(f,h),h}return k.set(f,ut),ut}function j(f,A,L){const v=document.createElement("span"),o={angle:0,canvasWidth:0,hasText:A.str!=="",hasEOL:A.hasEOL,fontSize:0};f._textDivs.push(v);const d=n.Util.transform(f._transform,A.transform);let l=Math.atan2(d[1],d[0]);const c=L[A.fontName];c.vertical&&(l+=Math.PI/2);const h=Math.hypot(d[2],d[3]),B=h*m(c.fontFamily,f._isOffscreenCanvasSupported);let a,E;l===0?(a=d[4],E=d[5]-B):(a=d[4]+B*Math.sin(l),E=d[5]-B*Math.cos(l));const R="calc(var(--scale-factor)*",et=v.style;f._container===f._rootContainer?(et.left=`${(100*a/f._pageWidth).toFixed(2)}%`,et.top=`${(100*E/f._pageHeight).toFixed(2)}%`):(et.left=`${R}${a.toFixed(2)}px)`,et.top=`${R}${E.toFixed(2)}px)`),et.fontSize=`${R}${h.toFixed(2)}px)`,et.fontFamily=c.fontFamily,o.fontSize=h,v.setAttribute("role","presentation"),v.textContent=A.str,v.dir=A.dir,f._fontInspectorEnabled&&(v.dataset.fontName=A.fontName),l!==0&&(o.angle=l*(180/Math.PI));let V=!1;if(A.str.length>1)V=!0;else if(A.str!==" "&&A.transform[0]!==A.transform[3]){const J=Math.abs(A.transform[0]),G=Math.abs(A.transform[3]);J!==G&&Math.max(J,G)/Math.min(J,G)>1.5&&(V=!0)}V&&(o.canvasWidth=c.vertical?A.height:A.width),f._textDivProperties.set(v,o),f._isReadableStream&&f._layoutText(v)}function U(f){const{div:A,scale:L,properties:v,ctx:o,prevFontSize:d,prevFontFamily:l}=f,{style:c}=A;let h="";if(v.canvasWidth!==0&&v.hasText){const{fontFamily:B}=c,{canvasWidth:a,fontSize:E}=v;(d!==E||l!==B)&&(o.font=`${E*L}px ${B}`,f.prevFontSize=E,f.prevFontFamily=B);const{width:R}=o.measureText(A.textContent);R>0&&(h=`scaleX(${a*L/R})`)}v.angle!==0&&(h=`rotate(${v.angle}deg) ${h}`),h.length>0&&(c.transform=h)}function _(f){if(f._canceled)return;const A=f._textDivs,L=f._capability;if(A.length>z){L.resolve();return}if(!f._isReadableStream)for(const o of A)f._layoutText(o);L.resolve()}class b{constructor({textContentSource:A,container:L,viewport:v,textDivs:o,textDivProperties:d,textContentItemsStr:l,isOffscreenCanvasSupported:c}){var R;this._textContentSource=A,this._isReadableStream=A instanceof ReadableStream,this._container=this._rootContainer=L,this._textDivs=o||[],this._textContentItemsStr=l||[],this._isOffscreenCanvasSupported=c,this._fontInspectorEnabled=!!((R=globalThis.FontInspector)!=null&&R.enabled),this._reader=null,this._textDivProperties=d||new WeakMap,this._canceled=!1,this._capability=new n.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:v.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:w(0,c)};const{pageWidth:h,pageHeight:B,pageX:a,pageY:E}=v.rawDims;this._transform=[1,0,0,-1,-a,E+B],this._pageWidth=h,this._pageHeight=B,(0,u.setLayerDimensions)(L,v),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(A,L){for(const v of A){if(v.str===void 0){if(v.type==="beginMarkedContentProps"||v.type==="beginMarkedContent"){const o=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),v.id!==null&&this._container.setAttribute("id",`${v.id}`),o.append(this._container)}else v.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(v.str),j(this,v,L)}}_layoutText(A){const L=this._layoutTextParams.properties=this._textDivProperties.get(A);if(this._layoutTextParams.div=A,U(this._layoutTextParams),L.hasText&&this._container.append(A),L.hasEOL){const v=document.createElement("br");v.setAttribute("role","presentation"),this._container.append(v)}}_render(){const A=new n.PromiseCapability;let L=Object.create(null);if(this._isReadableStream){const v=()=>{this._reader.read().then(({value:o,done:d})=>{if(d){A.resolve();return}Object.assign(L,o.styles),this._processItems(o.items,L),v()},A.reject)};this._reader=this._textContentSource.getReader(),v()}else if(this._textContentSource){const{items:v,styles:o}=this._textContentSource;this._processItems(v,o),A.resolve()}else throw new Error('No "textContentSource" parameter specified.');A.promise.then(()=>{L=null,_(this)},this._capability.reject)}}e.TextLayerRenderTask=b;function S(f){!f.textContentSource&&(f.textContent||f.textContentStream)&&((0,u.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),f.textContentSource=f.textContent||f.textContentStream);const{container:A,viewport:L}=f,v=getComputedStyle(A),o=v.getPropertyValue("visibility"),d=parseFloat(v.getPropertyValue("--scale-factor"));o==="visible"&&(!d||Math.abs(d-L.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const l=new b(f);return l._render(),l}function g({container:f,viewport:A,textDivs:L,textDivProperties:v,isOffscreenCanvasSupported:o,mustRotate:d=!0,mustRescale:l=!0}){if(d&&(0,u.setLayerDimensions)(f,{rotation:A.rotation}),l){const c=w(0,o),B={prevFontSize:null,prevFontFamily:null,div:null,scale:A.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:c};for(const a of L)B.properties=v.get(a),B.div=a,U(B)}}},(x,e,N)=>{var m,j,U,_,b,S,g,f,A,L,v,Je,Pe,Qe,Ze;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var n=N(1),u=N(4),z=N(28),H=N(33),ut=N(6),k=N(34);const h=class h{constructor({uiManager:a,pageIndex:E,div:R,accessibilityManager:et,annotationLayer:V,viewport:J,l10n:G}){at(this,v);at(this,m);at(this,j,!1);at(this,U,null);at(this,_,this.pointerup.bind(this));at(this,b,this.pointerdown.bind(this));at(this,S,new Map);at(this,g,!1);at(this,f,!1);at(this,A,!1);at(this,L);const rt=[z.FreeTextEditor,H.InkEditor,k.StampEditor];if(!h._initialized){h._initialized=!0;for(const C of rt)C.initialize(G)}a.registerEditorTypes(rt),lt(this,L,a),this.pageIndex=E,this.div=R,lt(this,m,et),lt(this,U,V),this.viewport=J,t(this,L).addLayer(this)}get isEmpty(){return t(this,S).size===0}updateToolbar(a){t(this,L).updateToolbar(a)}updateMode(a=t(this,L).getMode()){K(this,v,Ze).call(this),a===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),a!==n.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",a===n.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",a===n.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",a===n.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(a){if(!a&&t(this,L).getMode()!==n.AnnotationEditorType.INK)return;if(!a){for(const R of t(this,S).values())if(R.isEmpty()){R.setInBackground();return}}K(this,v,Pe).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(a){t(this,L).setEditingState(a)}addCommands(a){t(this,L).addCommands(a)}enable(){this.div.style.pointerEvents="auto";const a=new Set;for(const R of t(this,S).values())R.enableEditing(),R.annotationElementId&&a.add(R.annotationElementId);if(!t(this,U))return;const E=t(this,U).getEditableAnnotations();for(const R of E){if(R.hide(),t(this,L).isDeletedAnnotationElement(R.data.id)||a.has(R.data.id))continue;const et=this.deserialize(R);et&&(this.addOrRebuild(et),et.enableEditing())}}disable(){var E;lt(this,A,!0),this.div.style.pointerEvents="none";const a=new Set;for(const R of t(this,S).values()){if(R.disableEditing(),!R.annotationElementId||R.serialize()!==null){a.add(R.annotationElementId);continue}(E=this.getEditableAnnotation(R.annotationElementId))==null||E.show(),R.remove()}if(t(this,U)){const R=t(this,U).getEditableAnnotations();for(const et of R){const{id:V}=et.data;a.has(V)||t(this,L).isDeletedAnnotationElement(V)||et.show()}}K(this,v,Ze).call(this),this.isEmpty&&(this.div.hidden=!0),lt(this,A,!1)}getEditableAnnotation(a){var E;return((E=t(this,U))==null?void 0:E.getEditableAnnotation(a))||null}setActiveEditor(a){t(this,L).getActive()!==a&&t(this,L).setActiveEditor(a)}enableClick(){this.div.addEventListener("pointerdown",t(this,b)),this.div.addEventListener("pointerup",t(this,_))}disableClick(){this.div.removeEventListener("pointerdown",t(this,b)),this.div.removeEventListener("pointerup",t(this,_))}attach(a){t(this,S).set(a.id,a);const{annotationElementId:E}=a;E&&t(this,L).isDeletedAnnotationElement(E)&&t(this,L).removeDeletedAnnotationElement(a)}detach(a){var E;t(this,S).delete(a.id),(E=t(this,m))==null||E.removePointerInTextLayer(a.contentDiv),!t(this,A)&&a.annotationElementId&&t(this,L).addDeletedAnnotationElement(a)}remove(a){this.detach(a),t(this,L).removeEditor(a),a.div.contains(document.activeElement)&&setTimeout(()=>{t(this,L).focusMainContainer()},0),a.div.remove(),a.isAttachedToDOM=!1,t(this,f)||this.addInkEditorIfNeeded(!1)}changeParent(a){var E;a.parent!==this&&(a.annotationElementId&&(t(this,L).addDeletedAnnotationElement(a.annotationElementId),u.AnnotationEditor.deleteAnnotationElement(a),a.annotationElementId=null),this.attach(a),(E=a.parent)==null||E.detach(a),a.setParent(this),a.div&&a.isAttachedToDOM&&(a.div.remove(),this.div.append(a.div)))}add(a){if(this.changeParent(a),t(this,L).addEditor(a),this.attach(a),!a.isAttachedToDOM){const E=a.render();this.div.append(E),a.isAttachedToDOM=!0}a.fixAndSetPosition(),a.onceAdded(),t(this,L).addToAnnotationStorage(a)}moveEditorInDOM(a){var R;if(!a.isAttachedToDOM)return;const{activeElement:E}=document;a.div.contains(E)&&(a._focusEventsAllowed=!1,setTimeout(()=>{a.div.contains(document.activeElement)?a._focusEventsAllowed=!0:(a.div.addEventListener("focusin",()=>{a._focusEventsAllowed=!0},{once:!0}),E.focus())},0)),a._structTreeParentId=(R=t(this,m))==null?void 0:R.moveElementInDOM(this.div,a.div,a.contentDiv,!0)}addOrRebuild(a){a.needsToBeRebuilt()?a.rebuild():this.add(a)}addUndoableEditor(a){const E=()=>a._uiManager.rebuild(a),R=()=>{a.remove()};this.addCommands({cmd:E,undo:R,mustExec:!1})}getNextId(){return t(this,L).getId()}pasteEditor(a,E){t(this,L).updateToolbar(a),t(this,L).updateMode(a);const{offsetX:R,offsetY:et}=K(this,v,Qe).call(this),V=this.getNextId(),J=K(this,v,Je).call(this,{parent:this,id:V,x:R,y:et,uiManager:t(this,L),isCentered:!0,...E});J&&this.add(J)}deserialize(a){switch(a.annotationType??a.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return z.FreeTextEditor.deserialize(a,this,t(this,L));case n.AnnotationEditorType.INK:return H.InkEditor.deserialize(a,this,t(this,L));case n.AnnotationEditorType.STAMP:return k.StampEditor.deserialize(a,this,t(this,L))}return null}addNewEditor(){K(this,v,Pe).call(this,K(this,v,Qe).call(this),!0)}setSelected(a){t(this,L).setSelected(a)}toggleSelected(a){t(this,L).toggleSelected(a)}isSelected(a){return t(this,L).isSelected(a)}unselect(a){t(this,L).unselect(a)}pointerup(a){const{isMac:E}=n.FeatureTest.platform;if(!(a.button!==0||a.ctrlKey&&E)&&a.target===this.div&&t(this,g)){if(lt(this,g,!1),!t(this,j)){lt(this,j,!0);return}if(t(this,L).getMode()===n.AnnotationEditorType.STAMP){t(this,L).unselectAll();return}K(this,v,Pe).call(this,a,!1)}}pointerdown(a){if(t(this,g)){lt(this,g,!1);return}const{isMac:E}=n.FeatureTest.platform;if(a.button!==0||a.ctrlKey&&E||a.target!==this.div)return;lt(this,g,!0);const R=t(this,L).getActive();lt(this,j,!R||R.isEmpty())}findNewParent(a,E,R){const et=t(this,L).findParent(E,R);return et===null||et===this?!1:(et.changeParent(a),!0)}destroy(){var a,E;((a=t(this,L).getActive())==null?void 0:a.parent)===this&&(t(this,L).commitOrRemove(),t(this,L).setActiveEditor(null));for(const R of t(this,S).values())(E=t(this,m))==null||E.removePointerInTextLayer(R.contentDiv),R.setParent(null),R.isAttachedToDOM=!1,R.div.remove();this.div=null,t(this,S).clear(),t(this,L).removeLayer(this)}render({viewport:a}){this.viewport=a,(0,ut.setLayerDimensions)(this.div,a);for(const E of t(this,L).getEditors(this.pageIndex))this.add(E);this.updateMode()}update({viewport:a}){t(this,L).commitOrRemove(),this.viewport=a,(0,ut.setLayerDimensions)(this.div,{rotation:a.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:a,pageHeight:E}=this.viewport.rawDims;return[a,E]}};m=new WeakMap,j=new WeakMap,U=new WeakMap,_=new WeakMap,b=new WeakMap,S=new WeakMap,g=new WeakMap,f=new WeakMap,A=new WeakMap,L=new WeakMap,v=new WeakSet,Je=function(a){switch(t(this,L).getMode()){case n.AnnotationEditorType.FREETEXT:return new z.FreeTextEditor(a);case n.AnnotationEditorType.INK:return new H.InkEditor(a);case n.AnnotationEditorType.STAMP:return new k.StampEditor(a)}return null},Pe=function(a,E){const R=this.getNextId(),et=K(this,v,Je).call(this,{parent:this,id:R,x:a.offsetX,y:a.offsetY,uiManager:t(this,L),isCentered:E});return et&&this.add(et),et},Qe=function(){const{x:a,y:E,width:R,height:et}=this.div.getBoundingClientRect(),V=Math.max(0,a),J=Math.max(0,E),G=Math.min(window.innerWidth,a+R),rt=Math.min(window.innerHeight,E+et),C=(V+G)/2-a,$=(J+rt)/2-E,[nt,T]=this.viewport.rotation%180===0?[C,$]:[$,C];return{offsetX:nt,offsetY:T}},Ze=function(){lt(this,f,!0);for(const a of t(this,S).values())a.isEmpty()&&a.remove();lt(this,f,!1)},Jt(h,"_initialized",!1);let w=h;e.AnnotationEditorLayer=w},(x,e,N)=>{var k,w,m,j,U,_,b,S,g,f,xn,Rn,kn,me,tn,Fn,en;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var n=N(1),u=N(5),z=N(4),H=N(29);const h=class h extends z.AnnotationEditor{constructor(E){super({...E,name:"freeTextEditor"});at(this,f);at(this,k,this.editorDivBlur.bind(this));at(this,w,this.editorDivFocus.bind(this));at(this,m,this.editorDivInput.bind(this));at(this,j,this.editorDivKeydown.bind(this));at(this,U);at(this,_,"");at(this,b,`${this.id}-editor`);at(this,S);at(this,g,null);lt(this,U,E.color||h._defaultColor||z.AnnotationEditor._defaultLineColor),lt(this,S,E.fontSize||h._defaultFontSize)}static get _keyboardManager(){const E=h.prototype,R=J=>J.isEmpty(),et=u.AnnotationEditorUIManager.TRANSLATE_SMALL,V=u.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new u.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],E.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],E.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],E._translateEmpty,{args:[-et,0],checker:R}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],E._translateEmpty,{args:[-V,0],checker:R}],[["ArrowRight","mac+ArrowRight"],E._translateEmpty,{args:[et,0],checker:R}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],E._translateEmpty,{args:[V,0],checker:R}],[["ArrowUp","mac+ArrowUp"],E._translateEmpty,{args:[0,-et],checker:R}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],E._translateEmpty,{args:[0,-V],checker:R}],[["ArrowDown","mac+ArrowDown"],E._translateEmpty,{args:[0,et],checker:R}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],E._translateEmpty,{args:[0,V],checker:R}]]))}static initialize(E){z.AnnotationEditor.initialize(E,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const R=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(R.getPropertyValue("--freetext-padding"))}static updateDefaultParams(E,R){switch(E){case n.AnnotationEditorParamsType.FREETEXT_SIZE:h._defaultFontSize=R;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:h._defaultColor=R;break}}updateParams(E,R){switch(E){case n.AnnotationEditorParamsType.FREETEXT_SIZE:K(this,f,xn).call(this,R);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:K(this,f,Rn).call(this,R);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,h._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,h._defaultColor||z.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,S)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,U)]]}_translateEmpty(E,R){this._uiManager.translateSelectedEditors(E,R,!0)}getInitialTranslation(){const E=this.parentScale;return[-h._internalPadding*E,-(h._internalPadding+t(this,S))*E]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,j)),this.editorDiv.addEventListener("focus",t(this,w)),this.editorDiv.addEventListener("blur",t(this,k)),this.editorDiv.addEventListener("input",t(this,m)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,b)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,j)),this.editorDiv.removeEventListener("focus",t(this,w)),this.editorDiv.removeEventListener("blur",t(this,k)),this.editorDiv.removeEventListener("input",t(this,m)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(E){this._focusEventsAllowed&&(super.focusin(E),E.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var E;if(this.width){K(this,f,en).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(E=this._initialOptions)!=null&&E.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const E=t(this,_),R=lt(this,_,K(this,f,kn).call(this).trimEnd());if(E===R)return;const et=V=>{if(lt(this,_,V),!V){this.remove();return}K(this,f,tn).call(this),this._uiManager.rebuild(this),K(this,f,me).call(this)};this.addCommands({cmd:()=>{et(R)},undo:()=>{et(E)},mustExec:!1}),K(this,f,me).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(E){this.enterInEditMode()}keydown(E){E.target===this.div&&E.key==="Enter"&&(this.enterInEditMode(),E.preventDefault())}editorDivKeydown(E){h._keyboardManager.exec(this,E)}editorDivFocus(E){this.isEditing=!0}editorDivBlur(E){this.isEditing=!1}editorDivInput(E){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let E,R;this.width&&(E=this.x,R=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,b)),this.enableEditing(),z.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(V=>{var J;return(J=this.editorDiv)==null?void 0:J.setAttribute("aria-label",V)}),z.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(V=>{var J;return(J=this.editorDiv)==null?void 0:J.setAttribute("default-content",V)}),this.editorDiv.contentEditable=!0;const{style:et}=this.editorDiv;if(et.fontSize=`calc(${t(this,S)}px * var(--scale-factor))`,et.color=t(this,U),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,u.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[V,J]=this.parentDimensions;if(this.annotationElementId){const{position:G}=t(this,g);let[rt,C]=this.getInitialTranslation();[rt,C]=this.pageTranslationToScreen(rt,C);const[$,nt]=this.pageDimensions,[T,s]=this.pageTranslation;let i,p;switch(this.rotation){case 0:i=E+(G[0]-T)/$,p=R+this.height-(G[1]-s)/nt;break;case 90:i=E+(G[0]-T)/$,p=R-(G[1]-s)/nt,[rt,C]=[C,-rt];break;case 180:i=E-this.width+(G[0]-T)/$,p=R-(G[1]-s)/nt,[rt,C]=[-rt,-C];break;case 270:i=E+(G[0]-T-this.height*nt)/$,p=R+(G[1]-s-this.width*$)/nt,[rt,C]=[-C,rt];break}this.setAt(i*V,p*J,rt,C)}else this.setAt(E*V,R*J,this.width*V,this.height*J);K(this,f,tn).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(E,R,et){let V=null;if(E instanceof H.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:G,fontColor:rt},rect:C,rotation:$,id:nt},textContent:T,textPosition:s,parent:{page:{pageNumber:i}}}=E;if(!T||T.length===0)return null;V=E={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(rt),fontSize:G,value:T.join(`
`),position:s,pageIndex:i-1,rect:C,rotation:$,id:nt,deleted:!1}}const J=super.deserialize(E,R,et);return lt(J,S,E.fontSize),lt(J,U,n.Util.makeHexColor(...E.color)),lt(J,_,E.value),J.annotationElementId=E.id||null,lt(J,g,V),J}serialize(E=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const R=h._internalPadding*this.parentScale,et=this.getRect(R,R),V=z.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,U)),J={annotationType:n.AnnotationEditorType.FREETEXT,color:V,fontSize:t(this,S),value:t(this,_),pageIndex:this.pageIndex,rect:et,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return E?J:this.annotationElementId&&!K(this,f,Fn).call(this,J)?null:(J.id=this.annotationElementId,J)}};k=new WeakMap,w=new WeakMap,m=new WeakMap,j=new WeakMap,U=new WeakMap,_=new WeakMap,b=new WeakMap,S=new WeakMap,g=new WeakMap,f=new WeakSet,xn=function(E){const R=V=>{this.editorDiv.style.fontSize=`calc(${V}px * var(--scale-factor))`,this.translate(0,-(V-t(this,S))*this.parentScale),lt(this,S,V),K(this,f,me).call(this)},et=t(this,S);this.addCommands({cmd:()=>{R(E)},undo:()=>{R(et)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Rn=function(E){const R=t(this,U);this.addCommands({cmd:()=>{lt(this,U,this.editorDiv.style.color=E)},undo:()=>{lt(this,U,this.editorDiv.style.color=R)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},kn=function(){const E=this.editorDiv.getElementsByTagName("div");if(E.length===0)return this.editorDiv.innerText;const R=[];for(const et of E)R.push(et.innerText.replace(/\r\n?|\n/,""));return R.join(`
`)},me=function(){const[E,R]=this.parentDimensions;let et;if(this.isAttachedToDOM)et=this.div.getBoundingClientRect();else{const{currentLayer:V,div:J}=this,G=J.style.display;J.style.display="hidden",V.div.append(this.div),et=J.getBoundingClientRect(),J.remove(),J.style.display=G}this.rotation%180===this.parentRotation%180?(this.width=et.width/E,this.height=et.height/R):(this.width=et.height/E,this.height=et.width/R),this.fixAndSetPosition()},tn=function(){if(this.editorDiv.replaceChildren(),!!t(this,_))for(const E of t(this,_).split(`
`)){const R=document.createElement("div");R.append(E?document.createTextNode(E):document.createElement("br")),this.editorDiv.append(R)}},Fn=function(E){const{value:R,fontSize:et,color:V,rect:J,pageIndex:G}=t(this,g);return E.value!==R||E.fontSize!==et||E.rect.some((rt,C)=>Math.abs(rt-J[C])>=1)||E.color.some((rt,C)=>rt!==V[C])||E.pageIndex!==G},en=function(E=!1){if(!this.annotationElementId)return;if(K(this,f,me).call(this),!E&&(this.width===0||this.height===0)){setTimeout(()=>K(this,f,en).call(this,!0),0);return}const R=h._internalPadding*this.parentScale;t(this,g).rect=this.getRect(R,R)},Jt(h,"_freeTextDefaultContent",""),Jt(h,"_internalPadding",0),Jt(h,"_defaultColor",null),Jt(h,"_defaultFontSize",10),Jt(h,"_type","freetext");let ut=h;e.FreeTextEditor=ut},(x,e,N)=>{var p,D,re,Mn,st,ht,pt,yt,bt,_t,Q,Z,y,I,Y,it,gt,St,vt,tt,wt,Pt,Dn,we,nn,sn,It,Gt,qt,Et,ot,ct,kt,rn,Vt,W,mt,Ct,Ln,an;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var n=N(1),u=N(6),z=N(3),H=N(30),ut=N(31),k=N(32);const w=1e3,m=9,j=new WeakSet;function U(Rt){return{width:Rt[2]-Rt[0],height:Rt[3]-Rt[1]}}class _{static create(F){switch(F.data.annotationType){case n.AnnotationType.LINK:return new S(F);case n.AnnotationType.TEXT:return new g(F);case n.AnnotationType.WIDGET:switch(F.data.fieldType){case"Tx":return new A(F);case"Btn":return F.data.radioButton?new o(F):F.data.checkBox?new v(F):new d(F);case"Ch":return new l(F);case"Sig":return new L(F)}return new f(F);case n.AnnotationType.POPUP:return new c(F);case n.AnnotationType.FREETEXT:return new B(F);case n.AnnotationType.LINE:return new a(F);case n.AnnotationType.SQUARE:return new E(F);case n.AnnotationType.CIRCLE:return new R(F);case n.AnnotationType.POLYLINE:return new et(F);case n.AnnotationType.CARET:return new J(F);case n.AnnotationType.INK:return new G(F);case n.AnnotationType.POLYGON:return new V(F);case n.AnnotationType.HIGHLIGHT:return new rt(F);case n.AnnotationType.UNDERLINE:return new C(F);case n.AnnotationType.SQUIGGLY:return new $(F);case n.AnnotationType.STRIKEOUT:return new nt(F);case n.AnnotationType.STAMP:return new T(F);case n.AnnotationType.FILEATTACHMENT:return new s(F);default:return new b(F)}}}const M=class M{constructor(F,{isRenderable:P=!1,ignoreBorder:X=!1,createQuadrilaterals:dt=!1}={}){at(this,p,!1);this.isRenderable=P,this.data=F.data,this.layer=F.layer,this.linkService=F.linkService,this.downloadManager=F.downloadManager,this.imageResourcesPath=F.imageResourcesPath,this.renderForms=F.renderForms,this.svgFactory=F.svgFactory,this.annotationStorage=F.annotationStorage,this.enableScripting=F.enableScripting,this.hasJSActions=F.hasJSActions,this._fieldObjects=F.fieldObjects,this.parent=F.parent,P&&(this.container=this._createContainer(X)),dt&&this._createQuadrilaterals()}static _hasPopupData({titleObj:F,contentsObj:P,richText:X}){return!!(F!=null&&F.str||P!=null&&P.str||X!=null&&X.str)}get hasPopupData(){return M._hasPopupData(this.data)}_createContainer(F){const{data:P,parent:{page:X,viewport:dt}}=this,ft=document.createElement("section");ft.setAttribute("data-annotation-id",P.id),this instanceof f||(ft.tabIndex=w),ft.style.zIndex=this.parent.zIndex++,this.data.popupRef&&ft.setAttribute("aria-haspopup","dialog"),P.noRotate&&ft.classList.add("norotate");const{pageWidth:At,pageHeight:Tt,pageX:Ot,pageY:Mt}=dt.rawDims;if(!P.rect||this instanceof c){const{rotation:jt}=P;return!P.hasOwnCanvas&&jt!==0&&this.setRotation(jt,ft),ft}const{width:xt,height:Ht}=U(P.rect),Dt=n.Util.normalizeRect([P.rect[0],X.view[3]-P.rect[1]+X.view[1],P.rect[2],X.view[3]-P.rect[3]+X.view[1]]);if(!F&&P.borderStyle.width>0){ft.style.borderWidth=`${P.borderStyle.width}px`;const jt=P.borderStyle.horizontalCornerRadius,$t=P.borderStyle.verticalCornerRadius;if(jt>0||$t>0){const Kt=`calc(${jt}px * var(--scale-factor)) / calc(${$t}px * var(--scale-factor))`;ft.style.borderRadius=Kt}else if(this instanceof o){const Kt=`calc(${xt}px * var(--scale-factor)) / calc(${Ht}px * var(--scale-factor))`;ft.style.borderRadius=Kt}switch(P.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:ft.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:ft.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:ft.style.borderBottomStyle="solid";break}const Yt=P.borderColor||null;Yt?(lt(this,p,!0),ft.style.borderColor=n.Util.makeHexColor(Yt[0]|0,Yt[1]|0,Yt[2]|0)):ft.style.borderWidth=0}ft.style.left=`${100*(Dt[0]-Ot)/At}%`,ft.style.top=`${100*(Dt[1]-Mt)/Tt}%`;const{rotation:Nt}=P;return P.hasOwnCanvas||Nt===0?(ft.style.width=`${100*xt/At}%`,ft.style.height=`${100*Ht/Tt}%`):this.setRotation(Nt,ft),ft}setRotation(F,P=this.container){if(!this.data.rect)return;const{pageWidth:X,pageHeight:dt}=this.parent.viewport.rawDims,{width:ft,height:At}=U(this.data.rect);let Tt,Ot;F%180===0?(Tt=100*ft/X,Ot=100*At/dt):(Tt=100*At/X,Ot=100*ft/dt),P.style.width=`${Tt}%`,P.style.height=`${Ot}%`,P.setAttribute("data-main-rotation",(360-F)%360)}get _commonActions(){const F=(P,X,dt)=>{const ft=dt.detail[P],At=ft[0],Tt=ft.slice(1);dt.target.style[X]=H.ColorConverters[`${At}_HTML`](Tt),this.annotationStorage.setValue(this.data.id,{[X]:H.ColorConverters[`${At}_rgb`](Tt)})};return(0,n.shadow)(this,"_commonActions",{display:P=>{const{display:X}=P.detail,dt=X%2===1;this.container.style.visibility=dt?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:dt,noPrint:X===1||X===2})},print:P=>{this.annotationStorage.setValue(this.data.id,{noPrint:!P.detail.print})},hidden:P=>{const{hidden:X}=P.detail;this.container.style.visibility=X?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:X,noView:X})},focus:P=>{setTimeout(()=>P.target.focus({preventScroll:!1}),0)},userName:P=>{P.target.title=P.detail.userName},readonly:P=>{P.target.disabled=P.detail.readonly},required:P=>{this._setRequired(P.target,P.detail.required)},bgColor:P=>{F("bgColor","backgroundColor",P)},fillColor:P=>{F("fillColor","backgroundColor",P)},fgColor:P=>{F("fgColor","color",P)},textColor:P=>{F("textColor","color",P)},borderColor:P=>{F("borderColor","borderColor",P)},strokeColor:P=>{F("strokeColor","borderColor",P)},rotation:P=>{const X=P.detail.rotation;this.setRotation(X),this.annotationStorage.setValue(this.data.id,{rotation:X})}})}_dispatchEventFromSandbox(F,P){const X=this._commonActions;for(const dt of Object.keys(P.detail)){const ft=F[dt]||X[dt];ft==null||ft(P)}}_setDefaultPropertiesFromJS(F){if(!this.enableScripting)return;const P=this.annotationStorage.getRawValue(this.data.id);if(!P)return;const X=this._commonActions;for(const[dt,ft]of Object.entries(P)){const At=X[dt];if(At){const Tt={detail:{[dt]:ft},target:F};At(Tt),delete P[dt]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:F}=this.data;if(!F)return;const[P,X,dt,ft]=this.data.rect;if(F.length===1){const[,{x:$t,y:Yt},{x:Kt,y:Zt}]=F[0];if(dt===$t&&ft===Yt&&P===Kt&&X===Zt)return}const{style:At}=this.container;let Tt;if(t(this,p)){const{borderColor:$t,borderWidth:Yt}=At;At.borderWidth=0,Tt=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${$t}" stroke-width="${Yt}">`],this.container.classList.add("hasBorder")}const Ot=dt-P,Mt=ft-X,{svgFactory:xt}=this,Ht=xt.createElement("svg");Ht.classList.add("quadrilateralsContainer"),Ht.setAttribute("width",0),Ht.setAttribute("height",0);const Dt=xt.createElement("defs");Ht.append(Dt);const Nt=xt.createElement("clipPath"),jt=`clippath_${this.data.id}`;Nt.setAttribute("id",jt),Nt.setAttribute("clipPathUnits","objectBoundingBox"),Dt.append(Nt);for(const[,{x:$t,y:Yt},{x:Kt,y:Zt}]of F){const Qt=xt.createElement("rect"),ee=(Kt-P)/Ot,se=(ft-Yt)/Mt,ie=($t-Kt)/Ot,gn=(Yt-Zt)/Mt;Qt.setAttribute("x",ee),Qt.setAttribute("y",se),Qt.setAttribute("width",ie),Qt.setAttribute("height",gn),Nt.append(Qt),Tt==null||Tt.push(`<rect vector-effect="non-scaling-stroke" x="${ee}" y="${se}" width="${ie}" height="${gn}"/>`)}t(this,p)&&(Tt.push("</g></svg>')"),At.backgroundImage=Tt.join("")),this.container.append(Ht),this.container.style.clipPath=`url(#${jt})`}_createPopup(){const{container:F,data:P}=this;F.setAttribute("aria-haspopup","dialog");const X=new c({data:{color:P.color,titleObj:P.titleObj,modificationDate:P.modificationDate,contentsObj:P.contentsObj,richText:P.richText,parentRect:P.rect,borderStyle:0,id:`popup_${P.id}`,rotation:P.rotation},parent:this.parent,elements:[this]});this.parent.div.append(X.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(F,P=null){const X=[];if(this._fieldObjects){const dt=this._fieldObjects[F];if(dt)for(const{page:ft,id:At,exportValues:Tt}of dt){if(ft===-1||At===P)continue;const Ot=typeof Tt=="string"?Tt:null,Mt=document.querySelector(`[data-element-id="${At}"]`);if(Mt&&!j.has(Mt)){(0,n.warn)(`_getElementsByName - element not allowed: ${At}`);continue}X.push({id:At,exportValue:Ot,domElement:Mt})}return X}for(const dt of document.getElementsByName(F)){const{exportValue:ft}=dt,At=dt.getAttribute("data-element-id");At!==P&&j.has(dt)&&X.push({id:At,exportValue:ft,domElement:dt})}return X}show(){var F;this.container&&(this.container.hidden=!1),(F=this.popup)==null||F.maybeShow()}hide(){var F;this.container&&(this.container.hidden=!0),(F=this.popup)==null||F.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const F=this.getElementsToTriggerPopup();if(Array.isArray(F))for(const P of F)P.classList.add("highlightArea");else F.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:F,data:{id:P}}=this;this.container.addEventListener("dblclick",()=>{var X;(X=this.linkService.eventBus)==null||X.dispatch("switchannotationeditormode",{source:this,mode:F,editId:P})})}};p=new WeakMap;let b=M;class S extends b{constructor(P,X=null){super(P,{isRenderable:!0,ignoreBorder:!!(X!=null&&X.ignoreBorder),createQuadrilaterals:!0});at(this,D);this.isTooltipOnly=P.data.isTooltipOnly}render(){const{data:P,linkService:X}=this,dt=document.createElement("a");dt.setAttribute("data-element-id",P.id);let ft=!1;return P.url?(X.addLinkAttributes(dt,P.url,P.newWindow),ft=!0):P.action?(this._bindNamedAction(dt,P.action),ft=!0):P.attachment?(this._bindAttachment(dt,P.attachment),ft=!0):P.setOCGState?(K(this,D,Mn).call(this,dt,P.setOCGState),ft=!0):P.dest?(this._bindLink(dt,P.dest),ft=!0):(P.actions&&(P.actions.Action||P.actions["Mouse Up"]||P.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(dt,P),ft=!0),P.resetForm?(this._bindResetFormAction(dt,P.resetForm),ft=!0):this.isTooltipOnly&&!ft&&(this._bindLink(dt,""),ft=!0)),this.container.classList.add("linkAnnotation"),ft&&this.container.append(dt),this.container}_bindLink(P,X){P.href=this.linkService.getDestinationHash(X),P.onclick=()=>(X&&this.linkService.goToDestination(X),!1),(X||X==="")&&K(this,D,re).call(this)}_bindNamedAction(P,X){P.href=this.linkService.getAnchorUrl(""),P.onclick=()=>(this.linkService.executeNamedAction(X),!1),K(this,D,re).call(this)}_bindAttachment(P,X){P.href=this.linkService.getAnchorUrl(""),P.onclick=()=>{var dt;return(dt=this.downloadManager)==null||dt.openOrDownloadData(this.container,X.content,X.filename),!1},K(this,D,re).call(this)}_bindJSAction(P,X){P.href=this.linkService.getAnchorUrl("");const dt=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const ft of Object.keys(X.actions)){const At=dt.get(ft);At&&(P[At]=()=>{var Tt;return(Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:X.id,name:ft}}),!1})}P.onclick||(P.onclick=()=>!1),K(this,D,re).call(this)}_bindResetFormAction(P,X){const dt=P.onclick;if(dt||(P.href=this.linkService.getAnchorUrl("")),K(this,D,re).call(this),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),dt||(P.onclick=()=>!1);return}P.onclick=()=>{var Ht;dt==null||dt();const{fields:ft,refs:At,include:Tt}=X,Ot=[];if(ft.length!==0||At.length!==0){const Dt=new Set(At);for(const Nt of ft){const jt=this._fieldObjects[Nt]||[];for(const{id:$t}of jt)Dt.add($t)}for(const Nt of Object.values(this._fieldObjects))for(const jt of Nt)Dt.has(jt.id)===Tt&&Ot.push(jt)}else for(const Dt of Object.values(this._fieldObjects))Ot.push(...Dt);const Mt=this.annotationStorage,xt=[];for(const Dt of Ot){const{id:Nt}=Dt;switch(xt.push(Nt),Dt.type){case"text":{const $t=Dt.defaultValue||"";Mt.setValue(Nt,{value:$t});break}case"checkbox":case"radiobutton":{const $t=Dt.defaultValue===Dt.exportValues;Mt.setValue(Nt,{value:$t});break}case"combobox":case"listbox":{const $t=Dt.defaultValue||"";Mt.setValue(Nt,{value:$t});break}default:continue}const jt=document.querySelector(`[data-element-id="${Nt}"]`);if(jt){if(!j.has(jt)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${Nt}`);continue}}else continue;jt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Ht=this.linkService.eventBus)==null||Ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:xt,name:"ResetForm"}})),!1}}}D=new WeakSet,re=function(){this.container.setAttribute("data-internal-link","")},Mn=function(P,X){P.href=this.linkService.getAnchorUrl(""),P.onclick=()=>(this.linkService.executeSetOCGState(X),!1),K(this,D,re).call(this)};class g extends b{constructor(F){super(F,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const F=document.createElement("img");return F.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",F.alt="[{{type}} Annotation]",F.dataset.l10nId="text_annotation_type",F.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(F),this.container}}class f extends b{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(F){var P;this.data.hasOwnCanvas&&(((P=F.previousSibling)==null?void 0:P.nodeName)==="CANVAS"&&(F.previousSibling.hidden=!0),F.hidden=!1)}_getKeyModifier(F){const{isWin:P,isMac:X}=n.FeatureTest.platform;return P&&F.ctrlKey||X&&F.metaKey}_setEventListener(F,P,X,dt,ft){X.includes("mouse")?F.addEventListener(X,At=>{var Tt;(Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:dt,value:ft(At),shift:At.shiftKey,modifier:this._getKeyModifier(At)}})}):F.addEventListener(X,At=>{var Tt;if(X==="blur"){if(!P.focused||!At.relatedTarget)return;P.focused=!1}else if(X==="focus"){if(P.focused)return;P.focused=!0}ft&&((Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:dt,value:ft(At)}}))})}_setEventListeners(F,P,X,dt){var ft,At,Tt;for(const[Ot,Mt]of X)(Mt==="Action"||(ft=this.data.actions)!=null&&ft[Mt])&&((Mt==="Focus"||Mt==="Blur")&&(P||(P={focused:!1})),this._setEventListener(F,P,Ot,Mt,dt),Mt==="Focus"&&!((At=this.data.actions)!=null&&At.Blur)?this._setEventListener(F,P,"blur","Blur",null):Mt==="Blur"&&!((Tt=this.data.actions)!=null&&Tt.Focus)&&this._setEventListener(F,P,"focus","Focus",null))}_setBackgroundColor(F){const P=this.data.backgroundColor||null;F.style.backgroundColor=P===null?"transparent":n.Util.makeHexColor(P[0],P[1],P[2])}_setTextStyle(F){const P=["left","center","right"],{fontColor:X}=this.data.defaultAppearanceData,dt=this.data.defaultAppearanceData.fontSize||m,ft=F.style;let At;const Tt=2,Ot=Mt=>Math.round(10*Mt)/10;if(this.data.multiLine){const Mt=Math.abs(this.data.rect[3]-this.data.rect[1]-Tt),xt=Math.round(Mt/(n.LINE_FACTOR*dt))||1,Ht=Mt/xt;At=Math.min(dt,Ot(Ht/n.LINE_FACTOR))}else{const Mt=Math.abs(this.data.rect[3]-this.data.rect[1]-Tt);At=Math.min(dt,Ot(Mt/n.LINE_FACTOR))}ft.fontSize=`calc(${At}px * var(--scale-factor))`,ft.color=n.Util.makeHexColor(X[0],X[1],X[2]),this.data.textAlignment!==null&&(ft.textAlign=P[this.data.textAlignment])}_setRequired(F,P){P?F.setAttribute("required",!0):F.removeAttribute("required"),F.setAttribute("aria-required",P)}}class A extends f{constructor(F){const P=F.renderForms||!F.data.hasAppearance&&!!F.data.fieldValue;super(F,{isRenderable:P})}setPropertyOnSiblings(F,P,X,dt){const ft=this.annotationStorage;for(const At of this._getElementsByName(F.name,F.id))At.domElement&&(At.domElement[P]=X),ft.setValue(At.id,{[dt]:X})}render(){var dt,ft;const F=this.annotationStorage,P=this.data.id;this.container.classList.add("textWidgetAnnotation");let X=null;if(this.renderForms){const At=F.getValue(P,{value:this.data.fieldValue});let Tt=At.value||"";const Ot=F.getValue(P,{charLimit:this.data.maxLen}).charLimit;Ot&&Tt.length>Ot&&(Tt=Tt.slice(0,Ot));let Mt=At.formattedValue||((dt=this.data.textContent)==null?void 0:dt.join(`
`))||null;Mt&&this.data.comb&&(Mt=Mt.replaceAll(/\s+/g,""));const xt={userValue:Tt,formattedValue:Mt,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(X=document.createElement("textarea"),X.textContent=Mt??Tt,this.data.doNotScroll&&(X.style.overflowY="hidden")):(X=document.createElement("input"),X.type="text",X.setAttribute("value",Mt??Tt),this.data.doNotScroll&&(X.style.overflowX="hidden")),this.data.hasOwnCanvas&&(X.hidden=!0),j.add(X),X.setAttribute("data-element-id",P),X.disabled=this.data.readOnly,X.name=this.data.fieldName,X.tabIndex=w,this._setRequired(X,this.data.required),Ot&&(X.maxLength=Ot),X.addEventListener("input",Dt=>{F.setValue(P,{value:Dt.target.value}),this.setPropertyOnSiblings(X,"value",Dt.target.value,"value"),xt.formattedValue=null}),X.addEventListener("resetform",Dt=>{const Nt=this.data.defaultFieldValue??"";X.value=xt.userValue=Nt,xt.formattedValue=null});let Ht=Dt=>{const{formattedValue:Nt}=xt;Nt!=null&&(Dt.target.value=Nt),Dt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){X.addEventListener("focus",Nt=>{if(xt.focused)return;const{target:jt}=Nt;xt.userValue&&(jt.value=xt.userValue),xt.lastCommittedValue=jt.value,xt.commitKey=1,xt.focused=!0}),X.addEventListener("updatefromsandbox",Nt=>{this.showElementAndHideCanvas(Nt.target);const jt={value($t){xt.userValue=$t.detail.value??"",F.setValue(P,{value:xt.userValue.toString()}),$t.target.value=xt.userValue},formattedValue($t){const{formattedValue:Yt}=$t.detail;xt.formattedValue=Yt,Yt!=null&&$t.target!==document.activeElement&&($t.target.value=Yt),F.setValue(P,{formattedValue:Yt})},selRange($t){$t.target.setSelectionRange(...$t.detail.selRange)},charLimit:$t=>{var Qt;const{charLimit:Yt}=$t.detail,{target:Kt}=$t;if(Yt===0){Kt.removeAttribute("maxLength");return}Kt.setAttribute("maxLength",Yt);let Zt=xt.userValue;!Zt||Zt.length<=Yt||(Zt=Zt.slice(0,Yt),Kt.value=xt.userValue=Zt,F.setValue(P,{value:Zt}),(Qt=this.linkService.eventBus)==null||Qt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:Zt,willCommit:!0,commitKey:1,selStart:Kt.selectionStart,selEnd:Kt.selectionEnd}}))}};this._dispatchEventFromSandbox(jt,Nt)}),X.addEventListener("keydown",Nt=>{var Yt;xt.commitKey=1;let jt=-1;if(Nt.key==="Escape"?jt=0:Nt.key==="Enter"&&!this.data.multiLine?jt=2:Nt.key==="Tab"&&(xt.commitKey=3),jt===-1)return;const{value:$t}=Nt.target;xt.lastCommittedValue!==$t&&(xt.lastCommittedValue=$t,xt.userValue=$t,(Yt=this.linkService.eventBus)==null||Yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:$t,willCommit:!0,commitKey:jt,selStart:Nt.target.selectionStart,selEnd:Nt.target.selectionEnd}}))});const Dt=Ht;Ht=null,X.addEventListener("blur",Nt=>{var $t;if(!xt.focused||!Nt.relatedTarget)return;xt.focused=!1;const{value:jt}=Nt.target;xt.userValue=jt,xt.lastCommittedValue!==jt&&(($t=this.linkService.eventBus)==null||$t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:jt,willCommit:!0,commitKey:xt.commitKey,selStart:Nt.target.selectionStart,selEnd:Nt.target.selectionEnd}})),Dt(Nt)}),(ft=this.data.actions)!=null&&ft.Keystroke&&X.addEventListener("beforeinput",Nt=>{var se;xt.lastCommittedValue=null;const{data:jt,target:$t}=Nt,{value:Yt,selectionStart:Kt,selectionEnd:Zt}=$t;let Qt=Kt,ee=Zt;switch(Nt.inputType){case"deleteWordBackward":{const ie=Yt.substring(0,Kt).match(/\w*[^\w]*$/);ie&&(Qt-=ie[0].length);break}case"deleteWordForward":{const ie=Yt.substring(Kt).match(/^[^\w]*\w*/);ie&&(ee+=ie[0].length);break}case"deleteContentBackward":Kt===Zt&&(Qt-=1);break;case"deleteContentForward":Kt===Zt&&(ee+=1);break}Nt.preventDefault(),(se=this.linkService.eventBus)==null||se.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:Yt,change:jt||"",willCommit:!1,selStart:Qt,selEnd:ee}})}),this._setEventListeners(X,xt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Nt=>Nt.target.value)}if(Ht&&X.addEventListener("blur",Ht),this.data.comb){const Nt=(this.data.rect[2]-this.data.rect[0])/Ot;X.classList.add("comb"),X.style.letterSpacing=`calc(${Nt}px * var(--scale-factor) - 1ch)`}}else X=document.createElement("div"),X.textContent=this.data.fieldValue,X.style.verticalAlign="middle",X.style.display="table-cell";return this._setTextStyle(X),this._setBackgroundColor(X),this._setDefaultPropertiesFromJS(X),this.container.append(X),this.container}}class L extends f{constructor(F){super(F,{isRenderable:!!F.data.hasOwnCanvas})}}class v extends f{constructor(F){super(F,{isRenderable:F.renderForms})}render(){const F=this.annotationStorage,P=this.data,X=P.id;let dt=F.getValue(X,{value:P.exportValue===P.fieldValue}).value;typeof dt=="string"&&(dt=dt!=="Off",F.setValue(X,{value:dt})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const ft=document.createElement("input");return j.add(ft),ft.setAttribute("data-element-id",X),ft.disabled=P.readOnly,this._setRequired(ft,this.data.required),ft.type="checkbox",ft.name=P.fieldName,dt&&ft.setAttribute("checked",!0),ft.setAttribute("exportValue",P.exportValue),ft.tabIndex=w,ft.addEventListener("change",At=>{const{name:Tt,checked:Ot}=At.target;for(const Mt of this._getElementsByName(Tt,X)){const xt=Ot&&Mt.exportValue===P.exportValue;Mt.domElement&&(Mt.domElement.checked=xt),F.setValue(Mt.id,{value:xt})}F.setValue(X,{value:Ot})}),ft.addEventListener("resetform",At=>{const Tt=P.defaultFieldValue||"Off";At.target.checked=Tt===P.exportValue}),this.enableScripting&&this.hasJSActions&&(ft.addEventListener("updatefromsandbox",At=>{const Tt={value(Ot){Ot.target.checked=Ot.detail.value!=="Off",F.setValue(X,{value:Ot.target.checked})}};this._dispatchEventFromSandbox(Tt,At)}),this._setEventListeners(ft,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],At=>At.target.checked)),this._setBackgroundColor(ft),this._setDefaultPropertiesFromJS(ft),this.container.append(ft),this.container}}class o extends f{constructor(F){super(F,{isRenderable:F.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const F=this.annotationStorage,P=this.data,X=P.id;let dt=F.getValue(X,{value:P.fieldValue===P.buttonValue}).value;typeof dt=="string"&&(dt=dt!==P.buttonValue,F.setValue(X,{value:dt}));const ft=document.createElement("input");if(j.add(ft),ft.setAttribute("data-element-id",X),ft.disabled=P.readOnly,this._setRequired(ft,this.data.required),ft.type="radio",ft.name=P.fieldName,dt&&ft.setAttribute("checked",!0),ft.tabIndex=w,ft.addEventListener("change",At=>{const{name:Tt,checked:Ot}=At.target;for(const Mt of this._getElementsByName(Tt,X))F.setValue(Mt.id,{value:!1});F.setValue(X,{value:Ot})}),ft.addEventListener("resetform",At=>{const Tt=P.defaultFieldValue;At.target.checked=Tt!=null&&Tt===P.buttonValue}),this.enableScripting&&this.hasJSActions){const At=P.buttonValue;ft.addEventListener("updatefromsandbox",Tt=>{const Ot={value:Mt=>{const xt=At===Mt.detail.value;for(const Ht of this._getElementsByName(Mt.target.name)){const Dt=xt&&Ht.id===X;Ht.domElement&&(Ht.domElement.checked=Dt),F.setValue(Ht.id,{value:Dt})}}};this._dispatchEventFromSandbox(Ot,Tt)}),this._setEventListeners(ft,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Tt=>Tt.target.checked)}return this._setBackgroundColor(ft),this._setDefaultPropertiesFromJS(ft),this.container.append(ft),this.container}}class d extends S{constructor(F){super(F,{ignoreBorder:F.data.hasAppearance})}render(){const F=super.render();F.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(F.title=this.data.alternativeText);const P=F.lastChild;return this.enableScripting&&this.hasJSActions&&P&&(this._setDefaultPropertiesFromJS(P),P.addEventListener("updatefromsandbox",X=>{this._dispatchEventFromSandbox({},X)})),F}}class l extends f{constructor(F){super(F,{isRenderable:F.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const F=this.annotationStorage,P=this.data.id,X=F.getValue(P,{value:this.data.fieldValue}),dt=document.createElement("select");j.add(dt),dt.setAttribute("data-element-id",P),dt.disabled=this.data.readOnly,this._setRequired(dt,this.data.required),dt.name=this.data.fieldName,dt.tabIndex=w;let ft=this.data.combo&&this.data.options.length>0;this.data.combo||(dt.size=this.data.options.length,this.data.multiSelect&&(dt.multiple=!0)),dt.addEventListener("resetform",xt=>{const Ht=this.data.defaultFieldValue;for(const Dt of dt.options)Dt.selected=Dt.value===Ht});for(const xt of this.data.options){const Ht=document.createElement("option");Ht.textContent=xt.displayValue,Ht.value=xt.exportValue,X.value.includes(xt.exportValue)&&(Ht.setAttribute("selected",!0),ft=!1),dt.append(Ht)}let At=null;if(ft){const xt=document.createElement("option");xt.value=" ",xt.setAttribute("hidden",!0),xt.setAttribute("selected",!0),dt.prepend(xt),At=()=>{xt.remove(),dt.removeEventListener("input",At),At=null},dt.addEventListener("input",At)}const Tt=xt=>{const Ht=xt?"value":"textContent",{options:Dt,multiple:Nt}=dt;return Nt?Array.prototype.filter.call(Dt,jt=>jt.selected).map(jt=>jt[Ht]):Dt.selectedIndex===-1?null:Dt[Dt.selectedIndex][Ht]};let Ot=Tt(!1);const Mt=xt=>{const Ht=xt.target.options;return Array.prototype.map.call(Ht,Dt=>({displayValue:Dt.textContent,exportValue:Dt.value}))};return this.enableScripting&&this.hasJSActions?(dt.addEventListener("updatefromsandbox",xt=>{const Ht={value(Dt){At==null||At();const Nt=Dt.detail.value,jt=new Set(Array.isArray(Nt)?Nt:[Nt]);for(const $t of dt.options)$t.selected=jt.has($t.value);F.setValue(P,{value:Tt(!0)}),Ot=Tt(!1)},multipleSelection(Dt){dt.multiple=!0},remove(Dt){const Nt=dt.options,jt=Dt.detail.remove;Nt[jt].selected=!1,dt.remove(jt),Nt.length>0&&Array.prototype.findIndex.call(Nt,Yt=>Yt.selected)===-1&&(Nt[0].selected=!0),F.setValue(P,{value:Tt(!0),items:Mt(Dt)}),Ot=Tt(!1)},clear(Dt){for(;dt.length!==0;)dt.remove(0);F.setValue(P,{value:null,items:[]}),Ot=Tt(!1)},insert(Dt){const{index:Nt,displayValue:jt,exportValue:$t}=Dt.detail.insert,Yt=dt.children[Nt],Kt=document.createElement("option");Kt.textContent=jt,Kt.value=$t,Yt?Yt.before(Kt):dt.append(Kt),F.setValue(P,{value:Tt(!0),items:Mt(Dt)}),Ot=Tt(!1)},items(Dt){const{items:Nt}=Dt.detail;for(;dt.length!==0;)dt.remove(0);for(const jt of Nt){const{displayValue:$t,exportValue:Yt}=jt,Kt=document.createElement("option");Kt.textContent=$t,Kt.value=Yt,dt.append(Kt)}dt.options.length>0&&(dt.options[0].selected=!0),F.setValue(P,{value:Tt(!0),items:Mt(Dt)}),Ot=Tt(!1)},indices(Dt){const Nt=new Set(Dt.detail.indices);for(const jt of Dt.target.options)jt.selected=Nt.has(jt.index);F.setValue(P,{value:Tt(!0)}),Ot=Tt(!1)},editable(Dt){Dt.target.disabled=!Dt.detail.editable}};this._dispatchEventFromSandbox(Ht,xt)}),dt.addEventListener("input",xt=>{var Dt;const Ht=Tt(!0);F.setValue(P,{value:Ht}),xt.preventDefault(),(Dt=this.linkService.eventBus)==null||Dt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:P,name:"Keystroke",value:Ot,changeEx:Ht,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(dt,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],xt=>xt.target.value)):dt.addEventListener("input",function(xt){F.setValue(P,{value:Tt(!0)})}),this.data.combo&&this._setTextStyle(dt),this._setBackgroundColor(dt),this._setDefaultPropertiesFromJS(dt),this.container.append(dt),this.container}}class c extends b{constructor(F){const{data:P,elements:X}=F;super(F,{isRenderable:b._hasPopupData(P)}),this.elements=X}render(){this.container.classList.add("popupAnnotation");const F=new h({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),P=[];for(const X of this.elements)X.popup=F,P.push(X.data.id),X.addHighlightArea();return this.container.setAttribute("aria-controls",P.map(X=>`${n.AnnotationPrefix}${X}`).join(",")),this.container}}class h{constructor({container:F,color:P,elements:X,titleObj:dt,modificationDate:ft,contentsObj:At,richText:Tt,parent:Ot,rect:Mt,parentRect:xt,open:Ht}){at(this,Pt);at(this,st,null);at(this,ht,K(this,Pt,Dn).bind(this));at(this,pt,K(this,Pt,sn).bind(this));at(this,yt,K(this,Pt,nn).bind(this));at(this,bt,K(this,Pt,we).bind(this));at(this,_t,null);at(this,Q,null);at(this,Z,null);at(this,y,null);at(this,I,null);at(this,Y,null);at(this,it,!1);at(this,gt,null);at(this,St,null);at(this,vt,null);at(this,tt,null);at(this,wt,!1);var Nt;lt(this,Q,F),lt(this,tt,dt),lt(this,Z,At),lt(this,vt,Tt),lt(this,I,Ot),lt(this,_t,P),lt(this,St,Mt),lt(this,Y,xt),lt(this,y,X);const Dt=u.PDFDateString.toDateObject(ft);Dt&&lt(this,st,Ot.l10n.get("annotation_date_string",{date:Dt.toLocaleDateString(),time:Dt.toLocaleTimeString()})),this.trigger=X.flatMap(jt=>jt.getElementsToTriggerPopup());for(const jt of this.trigger)jt.addEventListener("click",t(this,bt)),jt.addEventListener("mouseenter",t(this,yt)),jt.addEventListener("mouseleave",t(this,pt)),jt.classList.add("popupTriggerArea");for(const jt of X)(Nt=jt.container)==null||Nt.addEventListener("keydown",t(this,ht));t(this,Q).hidden=!0,Ht&&K(this,Pt,we).call(this)}render(){if(t(this,gt))return;const{page:{view:F},viewport:{rawDims:{pageWidth:P,pageHeight:X,pageX:dt,pageY:ft}}}=t(this,I),At=lt(this,gt,document.createElement("div"));if(At.className="popup",t(this,_t)){const Qt=At.style.outlineColor=n.Util.makeHexColor(...t(this,_t));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?At.style.backgroundColor=`color-mix(in srgb, ${Qt} 30%, white)`:At.style.backgroundColor=n.Util.makeHexColor(...t(this,_t).map(se=>Math.floor(.7*(255-se)+se)))}const Tt=document.createElement("span");Tt.className="header";const Ot=document.createElement("h1");if(Tt.append(Ot),{dir:Ot.dir,str:Ot.textContent}=t(this,tt),At.append(Tt),t(this,st)){const Qt=document.createElement("span");Qt.classList.add("popupDate"),t(this,st).then(ee=>{Qt.textContent=ee}),Tt.append(Qt)}const Mt=t(this,Z),xt=t(this,vt);if(xt!=null&&xt.str&&(!(Mt!=null&&Mt.str)||Mt.str===xt.str))k.XfaLayer.render({xfaHtml:xt.html,intent:"richText",div:At}),At.lastChild.classList.add("richText","popupContent");else{const Qt=this._formatContents(Mt);At.append(Qt)}let Ht=!!t(this,Y),Dt=Ht?t(this,Y):t(this,St);for(const Qt of t(this,y))if(!Dt||n.Util.intersect(Qt.data.rect,Dt)!==null){Dt=Qt.data.rect,Ht=!0;break}const Nt=n.Util.normalizeRect([Dt[0],F[3]-Dt[1]+F[1],Dt[2],F[3]-Dt[3]+F[1]]),$t=Ht?Dt[2]-Dt[0]+5:0,Yt=Nt[0]+$t,Kt=Nt[1],{style:Zt}=t(this,Q);Zt.left=`${100*(Yt-dt)/P}%`,Zt.top=`${100*(Kt-ft)/X}%`,t(this,Q).append(At)}_formatContents({str:F,dir:P}){const X=document.createElement("p");X.classList.add("popupContent"),X.dir=P;const dt=F.split(/(?:\r\n?|\n)/);for(let ft=0,At=dt.length;ft<At;++ft){const Tt=dt[ft];X.append(document.createTextNode(Tt)),ft<At-1&&X.append(document.createElement("br"))}return X}forceHide(){lt(this,wt,this.isVisible),t(this,wt)&&(t(this,Q).hidden=!0)}maybeShow(){t(this,wt)&&(lt(this,wt,!1),t(this,Q).hidden=!1)}get isVisible(){return t(this,Q).hidden===!1}}st=new WeakMap,ht=new WeakMap,pt=new WeakMap,yt=new WeakMap,bt=new WeakMap,_t=new WeakMap,Q=new WeakMap,Z=new WeakMap,y=new WeakMap,I=new WeakMap,Y=new WeakMap,it=new WeakMap,gt=new WeakMap,St=new WeakMap,vt=new WeakMap,tt=new WeakMap,wt=new WeakMap,Pt=new WeakSet,Dn=function(F){F.altKey||F.shiftKey||F.ctrlKey||F.metaKey||(F.key==="Enter"||F.key==="Escape"&&t(this,it))&&K(this,Pt,we).call(this)},we=function(){lt(this,it,!t(this,it)),t(this,it)?(K(this,Pt,nn).call(this),t(this,Q).addEventListener("click",t(this,bt)),t(this,Q).addEventListener("keydown",t(this,ht))):(K(this,Pt,sn).call(this),t(this,Q).removeEventListener("click",t(this,bt)),t(this,Q).removeEventListener("keydown",t(this,ht)))},nn=function(){t(this,gt)||this.render(),this.isVisible?t(this,it)&&t(this,Q).classList.add("focused"):(t(this,Q).hidden=!1,t(this,Q).style.zIndex=parseInt(t(this,Q).style.zIndex)+1e3)},sn=function(){t(this,Q).classList.remove("focused"),!(t(this,it)||!this.isVisible)&&(t(this,Q).hidden=!0,t(this,Q).style.zIndex=parseInt(t(this,Q).style.zIndex)-1e3)};class B extends b{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0}),this.textContent=F.data.textContent,this.textPosition=F.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const F=document.createElement("div");F.classList.add("annotationTextContent"),F.setAttribute("role","comment");for(const P of this.textContent){const X=document.createElement("span");X.textContent=P,F.append(X)}this.container.append(F)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=B;class a extends b{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0});at(this,It,null)}render(){this.container.classList.add("lineAnnotation");const P=this.data,{width:X,height:dt}=U(P.rect),ft=this.svgFactory.create(X,dt,!0),At=lt(this,It,this.svgFactory.createElement("svg:line"));return At.setAttribute("x1",P.rect[2]-P.lineCoordinates[0]),At.setAttribute("y1",P.rect[3]-P.lineCoordinates[1]),At.setAttribute("x2",P.rect[2]-P.lineCoordinates[2]),At.setAttribute("y2",P.rect[3]-P.lineCoordinates[3]),At.setAttribute("stroke-width",P.borderStyle.width||1),At.setAttribute("stroke","transparent"),At.setAttribute("fill","transparent"),ft.append(At),this.container.append(ft),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,It)}addHighlightArea(){this.container.classList.add("highlightArea")}}It=new WeakMap;class E extends b{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0});at(this,Gt,null)}render(){this.container.classList.add("squareAnnotation");const P=this.data,{width:X,height:dt}=U(P.rect),ft=this.svgFactory.create(X,dt,!0),At=P.borderStyle.width,Tt=lt(this,Gt,this.svgFactory.createElement("svg:rect"));return Tt.setAttribute("x",At/2),Tt.setAttribute("y",At/2),Tt.setAttribute("width",X-At),Tt.setAttribute("height",dt-At),Tt.setAttribute("stroke-width",At||1),Tt.setAttribute("stroke","transparent"),Tt.setAttribute("fill","transparent"),ft.append(Tt),this.container.append(ft),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Gt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Gt=new WeakMap;class R extends b{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0});at(this,qt,null)}render(){this.container.classList.add("circleAnnotation");const P=this.data,{width:X,height:dt}=U(P.rect),ft=this.svgFactory.create(X,dt,!0),At=P.borderStyle.width,Tt=lt(this,qt,this.svgFactory.createElement("svg:ellipse"));return Tt.setAttribute("cx",X/2),Tt.setAttribute("cy",dt/2),Tt.setAttribute("rx",X/2-At/2),Tt.setAttribute("ry",dt/2-At/2),Tt.setAttribute("stroke-width",At||1),Tt.setAttribute("stroke","transparent"),Tt.setAttribute("fill","transparent"),ft.append(Tt),this.container.append(ft),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,qt)}addHighlightArea(){this.container.classList.add("highlightArea")}}qt=new WeakMap;class et extends b{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0});at(this,Et,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const P=this.data,{width:X,height:dt}=U(P.rect),ft=this.svgFactory.create(X,dt,!0);let At=[];for(const Ot of P.vertices){const Mt=Ot.x-P.rect[0],xt=P.rect[3]-Ot.y;At.push(Mt+","+xt)}At=At.join(" ");const Tt=lt(this,Et,this.svgFactory.createElement(this.svgElementName));return Tt.setAttribute("points",At),Tt.setAttribute("stroke-width",P.borderStyle.width||1),Tt.setAttribute("stroke","transparent"),Tt.setAttribute("fill","transparent"),ft.append(Tt),this.container.append(ft),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Et)}addHighlightArea(){this.container.classList.add("highlightArea")}}Et=new WeakMap;class V extends et{constructor(F){super(F),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class J extends b{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class G extends b{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0});at(this,ot,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const P=this.data,{width:X,height:dt}=U(P.rect),ft=this.svgFactory.create(X,dt,!0);for(const At of P.inkLists){let Tt=[];for(const Mt of At){const xt=Mt.x-P.rect[0],Ht=P.rect[3]-Mt.y;Tt.push(`${xt},${Ht}`)}Tt=Tt.join(" ");const Ot=this.svgFactory.createElement(this.svgElementName);t(this,ot).push(Ot),Ot.setAttribute("points",Tt),Ot.setAttribute("stroke-width",P.borderStyle.width||1),Ot.setAttribute("stroke","transparent"),Ot.setAttribute("fill","transparent"),!P.popupRef&&this.hasPopupData&&this._createPopup(),ft.append(Ot)}return this.container.append(ft),this.container}getElementsToTriggerPopup(){return t(this,ot)}addHighlightArea(){this.container.classList.add("highlightArea")}}ot=new WeakMap,e.InkAnnotationElement=G;class rt extends b{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class C extends b{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class $ extends b{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class nt extends b{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class T extends b{constructor(F){super(F,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=T;class s extends b{constructor(P){var ft;super(P,{isRenderable:!0});at(this,kt);at(this,ct,null);const{filename:X,content:dt}=this.data.file;this.filename=(0,u.getFilenameFromUrl)(X,!0),this.content=dt,(ft=this.linkService.eventBus)==null||ft.dispatch("fileattachmentannotation",{source:this,filename:X,content:dt})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:P,data:X}=this;let dt;X.hasAppearance||X.fillAlpha===0?dt=document.createElement("div"):(dt=document.createElement("img"),dt.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(X.name)?"paperclip":"pushpin"}.svg`,X.fillAlpha&&X.fillAlpha<1&&(dt.style=`filter: opacity(${Math.round(X.fillAlpha*100)}%);`)),dt.addEventListener("dblclick",K(this,kt,rn).bind(this)),lt(this,ct,dt);const{isMac:ft}=n.FeatureTest.platform;return P.addEventListener("keydown",At=>{At.key==="Enter"&&(ft?At.metaKey:At.ctrlKey)&&K(this,kt,rn).call(this)}),!X.popupRef&&this.hasPopupData?this._createPopup():dt.classList.add("popupTriggerArea"),P.append(dt),P}getElementsToTriggerPopup(){return t(this,ct)}addHighlightArea(){this.container.classList.add("highlightArea")}}ct=new WeakMap,kt=new WeakSet,rn=function(){var P;(P=this.downloadManager)==null||P.openOrDownloadData(this.container,this.content,this.filename)};class i{constructor({div:F,accessibilityManager:P,annotationCanvasMap:X,l10n:dt,page:ft,viewport:At}){at(this,Ct);at(this,Vt,null);at(this,W,null);at(this,mt,new Map);this.div=F,lt(this,Vt,P),lt(this,W,X),this.l10n=dt,this.page=ft,this.viewport=At,this.zIndex=0,this.l10n||(this.l10n=ut.NullL10n)}async render(F){const{annotations:P}=F,X=this.div;(0,u.setLayerDimensions)(X,this.viewport);const dt=new Map,ft={data:null,layer:X,linkService:F.linkService,downloadManager:F.downloadManager,imageResourcesPath:F.imageResourcesPath||"",renderForms:F.renderForms!==!1,svgFactory:new u.DOMSVGFactory,annotationStorage:F.annotationStorage||new z.AnnotationStorage,enableScripting:F.enableScripting===!0,hasJSActions:F.hasJSActions,fieldObjects:F.fieldObjects,parent:this,elements:null};for(const At of P){if(At.noHTML)continue;const Tt=At.annotationType===n.AnnotationType.POPUP;if(Tt){const xt=dt.get(At.id);if(!xt)continue;ft.elements=xt}else{const{width:xt,height:Ht}=U(At.rect);if(xt<=0||Ht<=0)continue}ft.data=At;const Ot=_.create(ft);if(!Ot.isRenderable)continue;if(!Tt&&At.popupRef){const xt=dt.get(At.popupRef);xt?xt.push(Ot):dt.set(At.popupRef,[Ot])}Ot.annotationEditorType>0&&t(this,mt).set(Ot.data.id,Ot);const Mt=Ot.render();At.hidden&&(Mt.style.visibility="hidden"),K(this,Ct,Ln).call(this,Mt,At.id)}K(this,Ct,an).call(this),await this.l10n.translate(X)}update({viewport:F}){const P=this.div;this.viewport=F,(0,u.setLayerDimensions)(P,{rotation:F.rotation}),K(this,Ct,an).call(this),P.hidden=!1}getEditableAnnotations(){return Array.from(t(this,mt).values())}getEditableAnnotation(F){return t(this,mt).get(F)}}Vt=new WeakMap,W=new WeakMap,mt=new WeakMap,Ct=new WeakSet,Ln=function(F,P){var dt;const X=F.firstChild||F;X.id=`${n.AnnotationPrefix}${P}`,this.div.append(F),(dt=t(this,Vt))==null||dt.moveElementInDOM(this.div,F,X,!1)},an=function(){if(!t(this,W))return;const F=this.div;for(const[P,X]of t(this,W)){const dt=F.querySelector(`[data-annotation-id="${P}"]`);if(!dt)continue;const{firstChild:ft}=dt;ft?ft.nodeName==="CANVAS"?ft.replaceWith(X):ft.before(X):dt.append(X)}t(this,W).clear()},e.AnnotationLayer=i},(x,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function N(z){return Math.floor(Math.max(0,Math.min(1,z))*255).toString(16).padStart(2,"0")}function n(z){return Math.max(0,Math.min(255,255*z))}class u{static CMYK_G([H,ut,k,w]){return["G",1-Math.min(1,.3*H+.59*k+.11*ut+w)]}static G_CMYK([H]){return["CMYK",0,0,0,1-H]}static G_RGB([H]){return["RGB",H,H,H]}static G_rgb([H]){return H=n(H),[H,H,H]}static G_HTML([H]){const ut=N(H);return`#${ut}${ut}${ut}`}static RGB_G([H,ut,k]){return["G",.3*H+.59*ut+.11*k]}static RGB_rgb(H){return H.map(n)}static RGB_HTML(H){return`#${H.map(N).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([H,ut,k,w]){return["RGB",1-Math.min(1,H+w),1-Math.min(1,k+w),1-Math.min(1,ut+w)]}static CMYK_rgb([H,ut,k,w]){return[n(1-Math.min(1,H+w)),n(1-Math.min(1,k+w)),n(1-Math.min(1,ut+w))]}static CMYK_HTML(H){const ut=this.CMYK_RGB(H).slice(1);return this.RGB_HTML(ut)}static RGB_CMYK([H,ut,k]){const w=1-H,m=1-ut,j=1-k,U=Math.min(w,m,j);return["CMYK",w,m,j,U]}}e.ColorConverters=u},(x,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=n;const N={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};N.print_progress_percent="{{progress}}%";function n(H,ut){switch(H){case"find_match_count":H=`find_match_count[${ut.total===1?"one":"other"}]`;break;case"find_match_count_limit":H=`find_match_count_limit[${ut.limit===1?"one":"other"}]`;break}return N[H]||""}function u(H,ut){return ut?H.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(k,w)=>w in ut?ut[w]:"{{"+w+"}}"):H}const z={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(H,ut=null,k=n(H,ut)){return u(k,ut)},async translate(H){}};e.NullL10n=z},(x,e,N)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var n=N(25);class u{static setupStorage(H,ut,k,w,m){const j=w.getValue(ut,{value:null});switch(k.name){case"textarea":if(j.value!==null&&(H.textContent=j.value),m==="print")break;H.addEventListener("input",U=>{w.setValue(ut,{value:U.target.value})});break;case"input":if(k.attributes.type==="radio"||k.attributes.type==="checkbox"){if(j.value===k.attributes.xfaOn?H.setAttribute("checked",!0):j.value===k.attributes.xfaOff&&H.removeAttribute("checked"),m==="print")break;H.addEventListener("change",U=>{w.setValue(ut,{value:U.target.checked?U.target.getAttribute("xfaOn"):U.target.getAttribute("xfaOff")})})}else{if(j.value!==null&&H.setAttribute("value",j.value),m==="print")break;H.addEventListener("input",U=>{w.setValue(ut,{value:U.target.value})})}break;case"select":if(j.value!==null){H.setAttribute("value",j.value);for(const U of k.children)U.attributes.value===j.value?U.attributes.selected=!0:U.attributes.hasOwnProperty("selected")&&delete U.attributes.selected}H.addEventListener("input",U=>{const _=U.target.options,b=_.selectedIndex===-1?"":_[_.selectedIndex].value;w.setValue(ut,{value:b})});break}}static setAttributes({html:H,element:ut,storage:k=null,intent:w,linkService:m}){const{attributes:j}=ut,U=H instanceof HTMLAnchorElement;j.type==="radio"&&(j.name=`${j.name}-${w}`);for(const[_,b]of Object.entries(j))if(b!=null)switch(_){case"class":b.length&&H.setAttribute(_,b.join(" "));break;case"dataId":break;case"id":H.setAttribute("data-element-id",b);break;case"style":Object.assign(H.style,b);break;case"textContent":H.textContent=b;break;default:(!U||_!=="href"&&_!=="newWindow")&&H.setAttribute(_,b)}U&&m.addLinkAttributes(H,j.href,j.newWindow),k&&j.dataId&&this.setupStorage(H,j.dataId,ut,k)}static render(H){var S;const ut=H.annotationStorage,k=H.linkService,w=H.xfaHtml,m=H.intent||"display",j=document.createElement(w.name);w.attributes&&this.setAttributes({html:j,element:w,intent:m,linkService:k});const U=[[w,-1,j]],_=H.div;if(_.append(j),H.viewport){const g=`matrix(${H.viewport.transform.join(",")})`;_.style.transform=g}m!=="richText"&&_.setAttribute("class","xfaLayer xfaFont");const b=[];for(;U.length>0;){const[g,f,A]=U.at(-1);if(f+1===g.children.length){U.pop();continue}const L=g.children[++U.at(-1)[1]];if(L===null)continue;const{name:v}=L;if(v==="#text"){const d=document.createTextNode(L.value);b.push(d),A.append(d);continue}const o=(S=L==null?void 0:L.attributes)!=null&&S.xmlns?document.createElementNS(L.attributes.xmlns,v):document.createElement(v);if(A.append(o),L.attributes&&this.setAttributes({html:o,element:L,storage:ut,intent:m,linkService:k}),L.children&&L.children.length>0)U.push([L,-1,o]);else if(L.value){const d=document.createTextNode(L.value);n.XfaText.shouldBuildText(v)&&b.push(d),o.append(d)}}for(const g of _.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:b}}static update(H){const ut=`matrix(${H.viewport.transform.join(",")})`;H.div.style.transform=ut,H.div.hidden=!1}}e.XfaLayer=u},(x,e,N)=>{var w,m,j,U,_,b,S,g,f,A,L,v,o,d,l,On,In,Nn,Bn,on,Un,ln,jn,Wn,Hn,Gn,$n,ne,cn,Ce,xe,ce,hn,Re,D,Vn,dn,zn,Xn,un,ke,he;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var n=N(1),u=N(4),z=N(29),H=N(6),ut=N(5);const _t=class _t extends u.AnnotationEditor{constructor(y){super({...y,name:"inkEditor"});at(this,l);at(this,w,0);at(this,m,0);at(this,j,this.canvasPointermove.bind(this));at(this,U,this.canvasPointerleave.bind(this));at(this,_,this.canvasPointerup.bind(this));at(this,b,this.canvasPointerdown.bind(this));at(this,S,new Path2D);at(this,g,!1);at(this,f,!1);at(this,A,!1);at(this,L,null);at(this,v,0);at(this,o,0);at(this,d,null);this.color=y.color||null,this.thickness=y.thickness||null,this.opacity=y.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(y){u.AnnotationEditor.initialize(y,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(y,I){switch(y){case n.AnnotationEditorParamsType.INK_THICKNESS:_t._defaultThickness=I;break;case n.AnnotationEditorParamsType.INK_COLOR:_t._defaultColor=I;break;case n.AnnotationEditorParamsType.INK_OPACITY:_t._defaultOpacity=I/100;break}}updateParams(y,I){switch(y){case n.AnnotationEditorParamsType.INK_THICKNESS:K(this,l,On).call(this,I);break;case n.AnnotationEditorParamsType.INK_COLOR:K(this,l,In).call(this,I);break;case n.AnnotationEditorParamsType.INK_OPACITY:K(this,l,Nn).call(this,I);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,_t._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,_t._defaultColor||u.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(_t._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||_t._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||_t._defaultColor||u.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??_t._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(K(this,l,Ce).call(this),K(this,l,xe).call(this)),this.isAttachedToDOM||(this.parent.add(this),K(this,l,ce).call(this)),K(this,l,he).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,L).disconnect(),lt(this,L,null),super.remove())}setParent(y){!this.parent&&y?this._uiManager.removeShouldRescale(this):this.parent&&y===null&&this._uiManager.addShouldRescale(this),super.setParent(y)}onScaleChanging(){const[y,I]=this.parentDimensions,Y=this.width*y,it=this.height*I;this.setDimensions(Y,it)}enableEditMode(){t(this,g)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,b)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,b)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,g)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),lt(this,g,!0),this.div.classList.add("disabled"),K(this,l,he).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(y){this._focusEventsAllowed&&(super.focusin(y),this.enableEditMode())}canvasPointerdown(y){y.button!==0||!this.isInEditMode()||t(this,g)||(this.setInForeground(),y.preventDefault(),y.type!=="mouse"&&this.div.focus(),K(this,l,Un).call(this,y.offsetX,y.offsetY))}canvasPointermove(y){y.preventDefault(),K(this,l,ln).call(this,y.offsetX,y.offsetY)}canvasPointerup(y){y.preventDefault(),K(this,l,cn).call(this,y)}canvasPointerleave(y){K(this,l,cn).call(this,y)}get isResizable(){return!this.isEmpty()&&t(this,g)}render(){if(this.div)return this.div;let y,I;this.width&&(y=this.x,I=this.y),super.render(),u.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(vt=>{var tt;return(tt=this.div)==null?void 0:tt.setAttribute("aria-label",vt)});const[Y,it,gt,St]=K(this,l,Bn).call(this);if(this.setAt(Y,it,0,0),this.setDims(gt,St),K(this,l,Ce).call(this),this.width){const[vt,tt]=this.parentDimensions;this.setAspectRatio(this.width*vt,this.height*tt),this.setAt(y*vt,I*tt,this.width*vt,this.height*tt),lt(this,A,!0),K(this,l,ce).call(this),this.setDims(this.width*vt,this.height*tt),K(this,l,ne).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return K(this,l,xe).call(this),this.div}setDimensions(y,I){const Y=Math.round(y),it=Math.round(I);if(t(this,v)===Y&&t(this,o)===it)return;lt(this,v,Y),lt(this,o,it),this.canvas.style.visibility="hidden";const[gt,St]=this.parentDimensions;this.width=y/gt,this.height=I/St,this.fixAndSetPosition(),t(this,g)&&K(this,l,hn).call(this,y,I),K(this,l,ce).call(this),K(this,l,ne).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(y,I,Y){var It,Gt,qt;if(y instanceof z.InkAnnotationElement)return null;const it=super.deserialize(y,I,Y);it.thickness=y.thickness,it.color=n.Util.makeHexColor(...y.color),it.opacity=y.opacity;const[gt,St]=it.pageDimensions,vt=it.width*gt,tt=it.height*St,wt=it.parentScale,Pt=y.thickness/2;lt(it,g,!0),lt(it,v,Math.round(vt)),lt(it,o,Math.round(tt));const{paths:Wt,rect:Ut,rotation:zt}=y;for(let{bezier:Et}of Wt){Et=K(It=_t,D,zn).call(It,Et,Ut,zt);const ot=[];it.paths.push(ot);let ct=wt*(Et[0]-Pt),kt=wt*(Et[1]-Pt);for(let Vt=2,W=Et.length;Vt<W;Vt+=6){const mt=wt*(Et[Vt]-Pt),Ct=wt*(Et[Vt+1]-Pt),Lt=wt*(Et[Vt+2]-Pt),Bt=wt*(Et[Vt+3]-Pt),Rt=wt*(Et[Vt+4]-Pt),F=wt*(Et[Vt+5]-Pt);ot.push([[ct,kt],[mt,Ct],[Lt,Bt],[Rt,F]]),ct=Rt,kt=F}const Xt=K(this,D,Vn).call(this,ot);it.bezierPath2D.push(Xt)}const Ft=K(Gt=it,l,un).call(Gt);return lt(it,m,Math.max(u.AnnotationEditor.MIN_SIZE,Ft[2]-Ft[0])),lt(it,w,Math.max(u.AnnotationEditor.MIN_SIZE,Ft[3]-Ft[1])),K(qt=it,l,hn).call(qt,vt,tt),it}serialize(){if(this.isEmpty())return null;const y=this.getRect(0,0),I=u.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:I,thickness:this.thickness,opacity:this.opacity,paths:K(this,l,Xn).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,y),pageIndex:this.pageIndex,rect:y,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};w=new WeakMap,m=new WeakMap,j=new WeakMap,U=new WeakMap,_=new WeakMap,b=new WeakMap,S=new WeakMap,g=new WeakMap,f=new WeakMap,A=new WeakMap,L=new WeakMap,v=new WeakMap,o=new WeakMap,d=new WeakMap,l=new WeakSet,On=function(y){const I=this.thickness;this.addCommands({cmd:()=>{this.thickness=y,K(this,l,he).call(this)},undo:()=>{this.thickness=I,K(this,l,he).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},In=function(y){const I=this.color;this.addCommands({cmd:()=>{this.color=y,K(this,l,ne).call(this)},undo:()=>{this.color=I,K(this,l,ne).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Nn=function(y){y/=100;const I=this.opacity;this.addCommands({cmd:()=>{this.opacity=y,K(this,l,ne).call(this)},undo:()=>{this.opacity=I,K(this,l,ne).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Bn=function(){const{parentRotation:y,parentDimensions:[I,Y]}=this;switch(y){case 90:return[0,Y,Y,I];case 180:return[I,Y,I,Y];case 270:return[I,0,Y,I];default:return[0,0,I,Y]}},on=function(){const{ctx:y,color:I,opacity:Y,thickness:it,parentScale:gt,scaleFactor:St}=this;y.lineWidth=it*gt/St,y.lineCap="round",y.lineJoin="round",y.miterLimit=10,y.strokeStyle=`${I}${(0,ut.opacityToHex)(Y)}`},Un=function(y,I){this.canvas.addEventListener("contextmenu",H.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,U)),this.canvas.addEventListener("pointermove",t(this,j)),this.canvas.addEventListener("pointerup",t(this,_)),this.canvas.removeEventListener("pointerdown",t(this,b)),this.isEditing=!0,t(this,A)||(lt(this,A,!0),K(this,l,ce).call(this),this.thickness||(this.thickness=_t._defaultThickness),this.color||(this.color=_t._defaultColor||u.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=_t._defaultOpacity)),this.currentPath.push([y,I]),lt(this,f,!1),K(this,l,on).call(this),lt(this,d,()=>{K(this,l,Hn).call(this),t(this,d)&&window.requestAnimationFrame(t(this,d))}),window.requestAnimationFrame(t(this,d))},ln=function(y,I){const[Y,it]=this.currentPath.at(-1);if(this.currentPath.length>1&&y===Y&&I===it)return;const gt=this.currentPath;let St=t(this,S);if(gt.push([y,I]),lt(this,f,!0),gt.length<=2){St.moveTo(...gt[0]),St.lineTo(y,I);return}gt.length===3&&(lt(this,S,St=new Path2D),St.moveTo(...gt[0])),K(this,l,Gn).call(this,St,...gt.at(-3),...gt.at(-2),y,I)},jn=function(){if(this.currentPath.length===0)return;const y=this.currentPath.at(-1);t(this,S).lineTo(...y)},Wn=function(y,I){lt(this,d,null),y=Math.min(Math.max(y,0),this.canvas.width),I=Math.min(Math.max(I,0),this.canvas.height),K(this,l,ln).call(this,y,I),K(this,l,jn).call(this);let Y;if(this.currentPath.length!==1)Y=K(this,l,$n).call(this);else{const tt=[y,I];Y=[[tt,tt.slice(),tt.slice(),tt]]}const it=t(this,S),gt=this.currentPath;this.currentPath=[],lt(this,S,new Path2D);const St=()=>{this.allRawPaths.push(gt),this.paths.push(Y),this.bezierPath2D.push(it),this.rebuild()},vt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(K(this,l,Ce).call(this),K(this,l,xe).call(this)),K(this,l,he).call(this))};this.addCommands({cmd:St,undo:vt,mustExec:!0})},Hn=function(){if(!t(this,f))return;lt(this,f,!1);const y=Math.ceil(this.thickness*this.parentScale),I=this.currentPath.slice(-3),Y=I.map(St=>St[0]),it=I.map(St=>St[1]);Math.min(...Y)-y,Math.max(...Y)+y,Math.min(...it)-y,Math.max(...it)+y;const{ctx:gt}=this;gt.save(),gt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const St of this.bezierPath2D)gt.stroke(St);gt.stroke(t(this,S)),gt.restore()},Gn=function(y,I,Y,it,gt,St,vt){const tt=(I+it)/2,wt=(Y+gt)/2,Pt=(it+St)/2,Wt=(gt+vt)/2;y.bezierCurveTo(tt+2*(it-tt)/3,wt+2*(gt-wt)/3,Pt+2*(it-Pt)/3,Wt+2*(gt-Wt)/3,Pt,Wt)},$n=function(){const y=this.currentPath;if(y.length<=2)return[[y[0],y[0],y.at(-1),y.at(-1)]];const I=[];let Y,[it,gt]=y[0];for(Y=1;Y<y.length-2;Y++){const[Ut,zt]=y[Y],[Ft,It]=y[Y+1],Gt=(Ut+Ft)/2,qt=(zt+It)/2,Et=[it+2*(Ut-it)/3,gt+2*(zt-gt)/3],ot=[Gt+2*(Ut-Gt)/3,qt+2*(zt-qt)/3];I.push([[it,gt],Et,ot,[Gt,qt]]),[it,gt]=[Gt,qt]}const[St,vt]=y[Y],[tt,wt]=y[Y+1],Pt=[it+2*(St-it)/3,gt+2*(vt-gt)/3],Wt=[tt+2*(St-tt)/3,wt+2*(vt-wt)/3];return I.push([[it,gt],Pt,Wt,[tt,wt]]),I},ne=function(){if(this.isEmpty()){K(this,l,Re).call(this);return}K(this,l,on).call(this);const{canvas:y,ctx:I}=this;I.setTransform(1,0,0,1,0,0),I.clearRect(0,0,y.width,y.height),K(this,l,Re).call(this);for(const Y of this.bezierPath2D)I.stroke(Y)},cn=function(y){this.canvas.removeEventListener("pointerleave",t(this,U)),this.canvas.removeEventListener("pointermove",t(this,j)),this.canvas.removeEventListener("pointerup",t(this,_)),this.canvas.addEventListener("pointerdown",t(this,b)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",H.noContextMenu)},10),K(this,l,Wn).call(this,y.offsetX,y.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Ce=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",u.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(y=>{var I;return(I=this.canvas)==null?void 0:I.setAttribute("aria-label",y)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},xe=function(){lt(this,L,new ResizeObserver(y=>{const I=y[0].contentRect;I.width&&I.height&&this.setDimensions(I.width,I.height)})),t(this,L).observe(this.div)},ce=function(){if(!t(this,A))return;const[y,I]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*y),this.canvas.height=Math.ceil(this.height*I),K(this,l,Re).call(this)},hn=function(y,I){const Y=K(this,l,ke).call(this),it=(y-Y)/t(this,m),gt=(I-Y)/t(this,w);this.scaleFactor=Math.min(it,gt)},Re=function(){const y=K(this,l,ke).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+y,this.translationY*this.scaleFactor+y)},D=new WeakSet,Vn=function(y){const I=new Path2D;for(let Y=0,it=y.length;Y<it;Y++){const[gt,St,vt,tt]=y[Y];Y===0&&I.moveTo(...gt),I.bezierCurveTo(St[0],St[1],vt[0],vt[1],tt[0],tt[1])}return I},dn=function(y,I,Y){const[it,gt,St,vt]=I;switch(Y){case 0:for(let tt=0,wt=y.length;tt<wt;tt+=2)y[tt]+=it,y[tt+1]=vt-y[tt+1];break;case 90:for(let tt=0,wt=y.length;tt<wt;tt+=2){const Pt=y[tt];y[tt]=y[tt+1]+it,y[tt+1]=Pt+gt}break;case 180:for(let tt=0,wt=y.length;tt<wt;tt+=2)y[tt]=St-y[tt],y[tt+1]+=gt;break;case 270:for(let tt=0,wt=y.length;tt<wt;tt+=2){const Pt=y[tt];y[tt]=St-y[tt+1],y[tt+1]=vt-Pt}break;default:throw new Error("Invalid rotation")}return y},zn=function(y,I,Y){const[it,gt,St,vt]=I;switch(Y){case 0:for(let tt=0,wt=y.length;tt<wt;tt+=2)y[tt]-=it,y[tt+1]=vt-y[tt+1];break;case 90:for(let tt=0,wt=y.length;tt<wt;tt+=2){const Pt=y[tt];y[tt]=y[tt+1]-gt,y[tt+1]=Pt-it}break;case 180:for(let tt=0,wt=y.length;tt<wt;tt+=2)y[tt]=St-y[tt],y[tt+1]-=gt;break;case 270:for(let tt=0,wt=y.length;tt<wt;tt+=2){const Pt=y[tt];y[tt]=vt-y[tt+1],y[tt+1]=St-Pt}break;default:throw new Error("Invalid rotation")}return y},Xn=function(y,I,Y,it){var wt,Pt;const gt=[],St=this.thickness/2,vt=y*I+St,tt=y*Y+St;for(const Wt of this.paths){const Ut=[],zt=[];for(let Ft=0,It=Wt.length;Ft<It;Ft++){const[Gt,qt,Et,ot]=Wt[Ft],ct=y*Gt[0]+vt,kt=y*Gt[1]+tt,Xt=y*qt[0]+vt,Vt=y*qt[1]+tt,W=y*Et[0]+vt,mt=y*Et[1]+tt,Ct=y*ot[0]+vt,Lt=y*ot[1]+tt;Ft===0&&(Ut.push(ct,kt),zt.push(ct,kt)),Ut.push(Xt,Vt,W,mt,Ct,Lt),zt.push(Xt,Vt),Ft===It-1&&zt.push(Ct,Lt)}gt.push({bezier:K(wt=_t,D,dn).call(wt,Ut,it,this.rotation),points:K(Pt=_t,D,dn).call(Pt,zt,it,this.rotation)})}return gt},un=function(){let y=1/0,I=-1/0,Y=1/0,it=-1/0;for(const gt of this.paths)for(const[St,vt,tt,wt]of gt){const Pt=n.Util.bezierBoundingBox(...St,...vt,...tt,...wt);y=Math.min(y,Pt[0]),Y=Math.min(Y,Pt[1]),I=Math.max(I,Pt[2]),it=Math.max(it,Pt[3])}return[y,Y,I,it]},ke=function(){return t(this,g)?Math.ceil(this.thickness*this.parentScale):0},he=function(y=!1){if(this.isEmpty())return;if(!t(this,g)){K(this,l,ne).call(this);return}const I=K(this,l,un).call(this),Y=K(this,l,ke).call(this);lt(this,m,Math.max(u.AnnotationEditor.MIN_SIZE,I[2]-I[0])),lt(this,w,Math.max(u.AnnotationEditor.MIN_SIZE,I[3]-I[1]));const it=Math.ceil(Y+t(this,m)*this.scaleFactor),gt=Math.ceil(Y+t(this,w)*this.scaleFactor),[St,vt]=this.parentDimensions;this.width=it/St,this.height=gt/vt,this.setAspectRatio(it,gt);const tt=this.translationX,wt=this.translationY;this.translationX=-I[0],this.translationY=-I[1],K(this,l,ce).call(this),K(this,l,ne).call(this),lt(this,v,it),lt(this,o,gt),this.setDims(it,gt);const Pt=y?Y/this.scaleFactor/2:0;this.translate(tt-this.translationX-Pt,wt-this.translationY-Pt)},at(_t,D),Jt(_t,"_defaultColor",null),Jt(_t,"_defaultOpacity",1),Jt(_t,"_defaultThickness",1),Jt(_t,"_type","ink");let k=_t;e.InkEditor=k},(x,e,N)=>{var k,w,m,j,U,_,b,S,g,f,A,be,ye,Fe,fn,qn,Yn,pn,Me,Kn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var n=N(1),u=N(4),z=N(6),H=N(29);const E=class E extends u.AnnotationEditor{constructor(V){super({...V,name:"stampEditor"});at(this,A);at(this,k,null);at(this,w,null);at(this,m,null);at(this,j,null);at(this,U,null);at(this,_,null);at(this,b,null);at(this,S,null);at(this,g,!1);at(this,f,!1);lt(this,j,V.bitmapUrl),lt(this,U,V.bitmapFile)}static initialize(V){u.AnnotationEditor.initialize(V)}static get supportedTypes(){const V=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",V.map(J=>`image/${J}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(V){return this.supportedTypes.includes(V)}static paste(V,J){J.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:V.getAsFile()})}remove(){var V,J;t(this,w)&&(lt(this,k,null),this._uiManager.imageManager.deleteId(t(this,w)),(V=t(this,_))==null||V.remove(),lt(this,_,null),(J=t(this,b))==null||J.disconnect(),lt(this,b,null)),super.remove()}rebuild(){if(!this.parent){t(this,w)&&K(this,A,Fe).call(this);return}super.rebuild(),this.div!==null&&(t(this,w)&&K(this,A,Fe).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,m)||t(this,k)||t(this,j)||t(this,U))}get isResizable(){return!0}render(){if(this.div)return this.div;let V,J;if(this.width&&(V=this.x,J=this.y),super.render(),this.div.hidden=!0,t(this,k)?K(this,A,fn).call(this):K(this,A,Fe).call(this),this.width){const[G,rt]=this.parentDimensions;this.setAt(V*G,J*rt,this.width*G,this.height*rt)}return this.div}static deserialize(V,J,G){if(V instanceof H.StampAnnotationElement)return null;const rt=super.deserialize(V,J,G),{rect:C,bitmapUrl:$,bitmapId:nt,isSvg:T,accessibilityData:s}=V;nt&&G.imageManager.isValidId(nt)?lt(rt,w,nt):lt(rt,j,$),lt(rt,g,T);const[i,p]=rt.pageDimensions;return rt.width=(C[2]-C[0])/i,rt.height=(C[3]-C[1])/p,s&&(rt.altTextData=s),rt}serialize(V=!1,J=null){if(this.isEmpty())return null;const G={annotationType:n.AnnotationEditorType.STAMP,bitmapId:t(this,w),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,g),structTreeParentId:this._structTreeParentId};if(V)return G.bitmapUrl=K(this,A,Me).call(this,!0),G.accessibilityData=this.altTextData,G;const{decorative:rt,altText:C}=this.altTextData;if(!rt&&C&&(G.accessibilityData={type:"Figure",alt:C}),J===null)return G;J.stamps||(J.stamps=new Map);const $=t(this,g)?(G.rect[2]-G.rect[0])*(G.rect[3]-G.rect[1]):null;if(!J.stamps.has(t(this,w)))J.stamps.set(t(this,w),{area:$,serialized:G}),G.bitmap=K(this,A,Me).call(this,!1);else if(t(this,g)){const nt=J.stamps.get(t(this,w));$>nt.area&&(nt.area=$,nt.serialized.bitmap.close(),nt.serialized.bitmap=K(this,A,Me).call(this,!1))}return G}};k=new WeakMap,w=new WeakMap,m=new WeakMap,j=new WeakMap,U=new WeakMap,_=new WeakMap,b=new WeakMap,S=new WeakMap,g=new WeakMap,f=new WeakMap,A=new WeakSet,be=function(V,J=!1){if(!V){this.remove();return}lt(this,k,V.bitmap),J||(lt(this,w,V.id),lt(this,g,V.isSvg)),K(this,A,fn).call(this)},ye=function(){lt(this,m,null),this._uiManager.enableWaiting(!1),t(this,_)&&this.div.focus()},Fe=function(){if(t(this,w)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,w)).then(J=>K(this,A,be).call(this,J,!0)).finally(()=>K(this,A,ye).call(this));return}if(t(this,j)){const J=t(this,j);lt(this,j,null),this._uiManager.enableWaiting(!0),lt(this,m,this._uiManager.imageManager.getFromUrl(J).then(G=>K(this,A,be).call(this,G)).finally(()=>K(this,A,ye).call(this)));return}if(t(this,U)){const J=t(this,U);lt(this,U,null),this._uiManager.enableWaiting(!0),lt(this,m,this._uiManager.imageManager.getFromFile(J).then(G=>K(this,A,be).call(this,G)).finally(()=>K(this,A,ye).call(this)));return}const V=document.createElement("input");V.type="file",V.accept=E.supportedTypesStr,lt(this,m,new Promise(J=>{V.addEventListener("change",async()=>{if(!V.files||V.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const G=await this._uiManager.imageManager.getFromFile(V.files[0]);K(this,A,be).call(this,G)}J()}),V.addEventListener("cancel",()=>{this.remove(),J()})}).finally(()=>K(this,A,ye).call(this))),V.click()},fn=function(){const{div:V}=this;let{width:J,height:G}=t(this,k);const[rt,C]=this.pageDimensions,$=.75;if(this.width)J=this.width*rt,G=this.height*C;else if(J>$*rt||G>$*C){const i=Math.min($*rt/J,$*C/G);J*=i,G*=i}const[nt,T]=this.parentDimensions;this.setDims(J*nt/rt,G*T/C),this._uiManager.enableWaiting(!1);const s=lt(this,_,document.createElement("canvas"));V.append(s),V.hidden=!1,K(this,A,pn).call(this,J,G),K(this,A,Kn).call(this),t(this,f)||(this.parent.addUndoableEditor(this),lt(this,f,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},qn=function(V,J){var $;const[G,rt]=this.parentDimensions;this.width=V/G,this.height=J/rt,this.setDims(V,J),($=this._initialOptions)!=null&&$.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,S)!==null&&clearTimeout(t(this,S)),lt(this,S,setTimeout(()=>{lt(this,S,null),K(this,A,pn).call(this,V,J)},200))},Yn=function(V,J){const{width:G,height:rt}=t(this,k);let C=G,$=rt,nt=t(this,k);for(;C>2*V||$>2*J;){const T=C,s=$;C>2*V&&(C=C>=16384?Math.floor(C/2)-1:Math.ceil(C/2)),$>2*J&&($=$>=16384?Math.floor($/2)-1:Math.ceil($/2));const i=new OffscreenCanvas(C,$);i.getContext("2d").drawImage(nt,0,0,T,s,0,0,C,$),nt=i.transferToImageBitmap()}return nt},pn=function(V,J){V=Math.ceil(V),J=Math.ceil(J);const G=t(this,_);if(!G||G.width===V&&G.height===J)return;G.width=V,G.height=J;const rt=t(this,g)?t(this,k):K(this,A,Yn).call(this,V,J),C=G.getContext("2d");C.filter=this._uiManager.hcmFilter,C.drawImage(rt,0,0,rt.width,rt.height,0,0,V,J)},Me=function(V){if(V){if(t(this,g)){const rt=this._uiManager.imageManager.getSvgUrl(t(this,w));if(rt)return rt}const J=document.createElement("canvas");return{width:J.width,height:J.height}=t(this,k),J.getContext("2d").drawImage(t(this,k),0,0),J.toDataURL()}if(t(this,g)){const[J,G]=this.pageDimensions,rt=Math.round(this.width*J*z.PixelsPerInch.PDF_TO_CSS_UNITS),C=Math.round(this.height*G*z.PixelsPerInch.PDF_TO_CSS_UNITS),$=new OffscreenCanvas(rt,C);return $.getContext("2d").drawImage(t(this,k),0,0,t(this,k).width,t(this,k).height,0,0,rt,C),$.transferToImageBitmap()}return structuredClone(t(this,k))},Kn=function(){lt(this,b,new ResizeObserver(V=>{const J=V[0].contentRect;J.width&&J.height&&K(this,A,qn).call(this,J.width,J.height)})),t(this,b).observe(this.div)},Jt(E,"_type","stamp");let ut=E;e.StampEditor=ut}],__webpack_module_cache__={};function __w_pdfjs_require__(x){var e=__webpack_module_cache__[x];if(e!==void 0)return e.exports;var N=__webpack_module_cache__[x]={exports:{}};return __webpack_modules__[x](N,N.exports,__w_pdfjs_require__),N.exports}var __webpack_exports__={};return(()=>{var x=__webpack_exports__;Object.defineProperty(x,"__esModule",{value:!0}),Object.defineProperty(x,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(x,"AnnotationEditorLayer",{enumerable:!0,get:function(){return z.AnnotationEditorLayer}}),Object.defineProperty(x,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(x,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(x,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return H.AnnotationEditorUIManager}}),Object.defineProperty(x,"AnnotationLayer",{enumerable:!0,get:function(){return ut.AnnotationLayer}}),Object.defineProperty(x,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(x,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(x,"DOMSVGFactory",{enumerable:!0,get:function(){return n.DOMSVGFactory}}),Object.defineProperty(x,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(x,"GlobalWorkerOptions",{enumerable:!0,get:function(){return k.GlobalWorkerOptions}}),Object.defineProperty(x,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(x,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(x,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(x,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(x,"PDFDataRangeTransport",{enumerable:!0,get:function(){return N.PDFDataRangeTransport}}),Object.defineProperty(x,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(x,"PDFWorker",{enumerable:!0,get:function(){return N.PDFWorker}}),Object.defineProperty(x,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(x,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(x,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(x,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(x,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(x,"SVGGraphics",{enumerable:!0,get:function(){return N.SVGGraphics}}),Object.defineProperty(x,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(x,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(x,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(x,"XfaLayer",{enumerable:!0,get:function(){return w.XfaLayer}}),Object.defineProperty(x,"build",{enumerable:!0,get:function(){return N.build}}),Object.defineProperty(x,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(x,"getDocument",{enumerable:!0,get:function(){return N.getDocument}}),Object.defineProperty(x,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(x,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(x,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(x,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}}),Object.defineProperty(x,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(x,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(x,"noContextMenu",{enumerable:!0,get:function(){return n.noContextMenu}}),Object.defineProperty(x,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(x,"renderTextLayer",{enumerable:!0,get:function(){return u.renderTextLayer}}),Object.defineProperty(x,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}}),Object.defineProperty(x,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(x,"updateTextLayer",{enumerable:!0,get:function(){return u.updateTextLayer}}),Object.defineProperty(x,"version",{enumerable:!0,get:function(){return N.version}});var e=__w_pdfjs_require__(1),N=__w_pdfjs_require__(2),n=__w_pdfjs_require__(6),u=__w_pdfjs_require__(26),z=__w_pdfjs_require__(27),H=__w_pdfjs_require__(5),ut=__w_pdfjs_require__(29),k=__w_pdfjs_require__(14),w=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs="default"in pdfjsModule?pdf:pdfjsModule;var __spreadArray=function(x,e,N){if(N||arguments.length===2)for(var n=0,u=e.length,z;n<u;n++)(z||!(n in e))&&(z||(z=Array.prototype.slice.call(e,0,n)),z[n]=e[n]);return x.concat(z||Array.prototype.slice.call(e))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(x,e){var N={};return allEvents.forEach(function(n){var u=x[n];u&&(e?N[n]=function(z){return u(z,e(n))}:N[n]=u)}),N}function makeCancellablePromise(x){var e=!1,N=new Promise(function(n,u){x.then(function(z){return!e&&n(z)}).catch(function(z){return!e&&u(z)})});return{promise:N,cancel:function(){e=!0}}}function r(x){var e,N,n="";if(typeof x=="string"||typeof x=="number")n+=x;else if(typeof x=="object")if(Array.isArray(x)){var u=x.length;for(e=0;e<u;e++)x[e]&&(N=r(x[e]))&&(n&&(n+=" "),n+=N)}else for(N in x)x[N]&&(n&&(n+=" "),n+=N);return n}function clsx(){for(var x,e,N=0,n="",u=arguments.length;N<u;N++)(x=arguments[N])&&(e=r(x))&&(n&&(n+=" "),n+=e);return n}var prefix="Invariant failed";function invariant(x,e){if(!x)throw new Error(prefix)}var warning=function(){},warning_1=warning;const warning$1=getDefaultExportFromCjs(warning_1);var has=Object.prototype.hasOwnProperty;function find(x,e,N){for(N of x.keys())if(dequal(N,e))return N}function dequal(x,e){var N,n,u;if(x===e)return!0;if(x&&e&&(N=x.constructor)===e.constructor){if(N===Date)return x.getTime()===e.getTime();if(N===RegExp)return x.toString()===e.toString();if(N===Array){if((n=x.length)===e.length)for(;n--&&dequal(x[n],e[n]););return n===-1}if(N===Set){if(x.size!==e.size)return!1;for(n of x)if(u=n,u&&typeof u=="object"&&(u=find(e,u),!u)||!e.has(u))return!1;return!0}if(N===Map){if(x.size!==e.size)return!1;for(n of x)if(u=n[0],u&&typeof u=="object"&&(u=find(e,u),!u)||!dequal(n[1],e.get(u)))return!1;return!0}if(N===ArrayBuffer)x=new Uint8Array(x),e=new Uint8Array(e);else if(N===DataView){if((n=x.byteLength)===e.byteLength)for(;n--&&x.getInt8(n)===e.getInt8(n););return n===-1}if(ArrayBuffer.isView(x)){if((n=x.byteLength)===e.byteLength)for(;n--&&x[n]===e[n];);return n===-1}if(!N||typeof x=="object"){n=0;for(N in x)if(has.call(x,N)&&++n&&!has.call(e,N)||!(N in e)||!dequal(x[N],e[N]))return!1;return Object.keys(e).length===n}}return x!==x&&e!==e}const DocumentContext=reactExports.createContext(null);function Message({children:x,type:e}){return React.createElement("div",{className:`react-pdf__message react-pdf__message--${e}`},x)}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){invariant(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(N=>{invariant(this.pdfDocument),invariant(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(N):Array.isArray(e)?N(e):e.then(N)}).then(N=>{invariant(Array.isArray(N));const n=N[0];new Promise(u=>{invariant(this.pdfDocument),n instanceof Object?this.pdfDocument.getPageIndex(n).then(z=>{u(z)}).catch(()=>{invariant(!1)}):typeof n=="number"?u(n):invariant(!1)}).then(u=>{const z=u+1;invariant(this.pdfViewer),invariant(z>=1&&z<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:N,pageIndex:u,pageNumber:z})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const N=e-1;invariant(this.pdfViewer),invariant(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:N,pageNumber:e})}addLinkAttributes(e,N,n){e.href=N,e.rel=this.externalLinkRel||DEFAULT_LINK_REL,e.target=n?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(x){return typeof x<"u"}function isProvided(x){return isDefined(x)&&x!==null}function isString(x){return typeof x=="string"}function isArrayBuffer(x){return x instanceof ArrayBuffer}function isBlob(x){return invariant(isBrowser),x instanceof Blob}function isDataURI(x){return isString(x)&&/^data:/.test(x)}function dataURItoByteString(x){invariant(isDataURI(x));const[e="",N=""]=x.split(",");return e.split(";").indexOf("base64")!==-1?atob(N):unescape(N)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning$1(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning$1(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(x){x&&x.cancel&&x.cancel()}function makePageCallback(x,e){return Object.defineProperty(x,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(x,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(x,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(x,"originalHeight",{get(){return this.view[3]},configurable:!0}),x}function isCancelException(x){return x.name==="RenderingCancelledException"}function loadFromFile(x){return new Promise((e,N)=>{const n=new FileReader;n.onload=()=>{if(!n.result)return N(new Error("Error while reading a file."));e(n.result)},n.onerror=u=>{if(!u.target)return N(new Error("Error while reading a file."));const{error:z}=u.target;if(!z)return N(new Error("Error while reading a file."));switch(z.code){case z.NOT_FOUND_ERR:return N(new Error("Error while reading a file: File not found."));case z.SECURITY_ERR:return N(new Error("Error while reading a file: Security error."));case z.ABORT_ERR:return N(new Error("Error while reading a file: Aborted."));default:return N(new Error("Error while reading a file."))}},n.readAsArrayBuffer(x)})}function reducer(x,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return x}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const{PDFDataRangeTransport:PDFDataRangeTransport$1}=pdfjs,eventProps=(()=>{const x={};return allEvents.forEach(e=>{x[e]=PropTypes.func}),x})(),isTypedArray=PropTypes.oneOfType([PropTypes.instanceOf(Int8Array),PropTypes.instanceOf(Uint8Array),PropTypes.instanceOf(Uint8ClampedArray),PropTypes.instanceOf(Int16Array),PropTypes.instanceOf(Uint16Array),PropTypes.instanceOf(Int32Array),PropTypes.instanceOf(Uint32Array),PropTypes.instanceOf(Float32Array),PropTypes.instanceOf(Float64Array)]),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.arrayOf(PropTypes.number.isRequired),isTypedArray]).isRequired}),PropTypes.shape({range:PropTypes.instanceOf(PDFDataRangeTransport$1).isRequired}),PropTypes.shape({url:PropTypes.string.isRequired})];typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));const isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes);PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired});const isPageIndex=function x(e,N,n){const{[N]:u,pageNumber:z,pdf:H}=e;if(!isDefined(H))return null;if(isDefined(u)){if(typeof u!="number")return new Error(`\`${N}\` of type \`${typeof u}\` supplied to \`${n}\`, expected \`number\`.`);if(u<0)return new Error(`Expected \`${N}\` to be greater or equal to 0.`);const{numPages:ut}=H;if(u+1>ut)return new Error(`Expected \`${N}\` to be less or equal to ${ut-1}.`)}else if(!isDefined(z))return new Error(`\`${N}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${n}\`.`);return null},isPageNumber=function x(e,N,n){const{[N]:u,pageIndex:z,pdf:H}=e;if(!isDefined(H))return null;if(isDefined(u)){if(typeof u!="number")return new Error(`\`${N}\` of type \`${typeof u}\` supplied to \`${n}\`, expected \`number\`.`);if(u<1)return new Error(`Expected \`${N}\` to be greater or equal to 1.`);const{numPages:ut}=H;if(u>ut)return new Error(`Expected \`${N}\` to be less or equal to ${ut}.`)}else if(!isDefined(z))return new Error(`\`${N}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${n}\`.`);return null},isPdf=PropTypes.oneOfType([PropTypes.any,PropTypes.oneOf([!1])]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.exact({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","custom","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]);var __awaiter=function(x,e,N,n){function u(z){return z instanceof N?z:new N(function(H){H(z)})}return new(N||(N=Promise))(function(z,H){function ut(m){try{w(n.next(m))}catch(j){H(j)}}function k(m){try{w(n.throw(m))}catch(j){H(j)}}function w(m){m.done?z(m.value):u(m.value).then(ut,k)}w((n=n.apply(x,e||[])).next())})},__rest$1=function(x,e){var N={};for(var n in x)Object.prototype.hasOwnProperty.call(x,n)&&e.indexOf(n)<0&&(N[n]=x[n]);if(x!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,n=Object.getOwnPropertySymbols(x);u<n.length;u++)e.indexOf(n[u])<0&&Object.prototype.propertyIsEnumerable.call(x,n[u])&&(N[n[u]]=x[n[u]]);return N};const{PDFDataRangeTransport}=pdfjs,defaultOnPassword=(x,e)=>{switch(e){case PasswordResponses.NEED_PASSWORD:{const N=prompt("Enter the password to open this PDF file.");x(N);break}case PasswordResponses.INCORRECT_PASSWORD:{const N=prompt("Invalid password. Please try again.");x(N);break}}};function isParameterObject(x){return typeof x=="object"&&x!==null&&("data"in x||"range"in x||"url"in x)}const Document=reactExports.forwardRef(function x(e,N){var{children:n,className:u,error:z="Failed to load PDF file.",externalLinkRel:H,externalLinkTarget:ut,file:k,inputRef:w,imageResourcesPath:m,loading:j="Loading PDF…",noData:U="No PDF file specified.",onItemClick:_,onLoadError:b,onLoadProgress:S,onLoadSuccess:g,onPassword:f=defaultOnPassword,onSourceError:A,onSourceSuccess:L,options:v,renderMode:o,rotate:d}=e,l=__rest$1(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[c,h]=useResolver(),{value:B,error:a}=c,[E,R]=useResolver(),{value:et,error:V}=E,J=reactExports.useRef(new LinkService),G=reactExports.useRef([]),rt=reactExports.useRef(),C=reactExports.useRef();reactExports.useEffect(()=>{k&&k!==rt.current&&isParameterObject(k)&&(warning$1(!dequal(k,rt.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),rt.current=k)},[k]),reactExports.useEffect(()=>{v&&v!==C.current&&(warning$1(!dequal(v,C.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),C.current=v)},[v]);const $=reactExports.useRef({scrollPageIntoView:Q=>{const{dest:Z,pageNumber:y,pageIndex:I=y-1}=Q;if(_){_({dest:Z,pageIndex:I,pageNumber:y});return}const Y=G.current[I];if(Y){Y.scrollIntoView();return}warning$1(!1,`An internal link leading to page ${y} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(N,()=>({linkService:J,pages:G,viewer:$}),[]);function nt(){L&&L()}function T(){a&&(warning$1(!1,a.toString()),A&&A(a))}function s(){h({type:"RESET"})}reactExports.useEffect(s,[k,h]);const i=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!k)return null;if(typeof k=="string")return isDataURI(k)?{data:dataURItoByteString(k)}:(displayCORSWarning(),{url:k});if(k instanceof PDFDataRangeTransport)return{range:k};if(isArrayBuffer(k))return{data:k};if(isBrowser&&isBlob(k))return{data:yield loadFromFile(k)};if(invariant(typeof k=="object"),invariant(isParameterObject(k)),"url"in k&&typeof k.url=="string"){if(isDataURI(k.url)){const{url:Q}=k,Z=__rest$1(k,["url"]),y=dataURItoByteString(Q);return Object.assign({data:y},Z)}displayCORSWarning()}return k}),[k]);reactExports.useEffect(()=>{const Q=makeCancellablePromise(i());return Q.promise.then(Z=>{h({type:"RESOLVE",value:Z})}).catch(Z=>{h({type:"REJECT",error:Z})}),()=>{cancelRunningTask(Q)}},[i,h]),reactExports.useEffect(()=>{if(!(typeof B>"u")){if(B===!1){T();return}nt()}},[B]);function p(){et&&(g&&g(et),G.current=new Array(et.numPages),J.current.setDocument(et))}function M(){V&&(warning$1(!1,V.toString()),b&&b(V))}function D(){R({type:"RESET"})}reactExports.useEffect(D,[R,B]);function O(){if(!B)return;const Q=Object.assign(Object.assign({},v),{isEvalSupported:!1}),Z=Object.assign(Object.assign({},B),Q),y=pdfjs.getDocument(Z);S&&(y.onProgress=S),f&&(y.onPassword=f);const I=y;return I.promise.then(Y=>{R({type:"RESOLVE",value:Y})}).catch(Y=>{I.destroyed||R({type:"REJECT",error:Y})}),()=>{I.destroy()}}reactExports.useEffect(O,[v,R,B]),reactExports.useEffect(()=>{if(!(typeof et>"u")){if(et===!1){M();return}p()}},[et]);function q(){J.current.setViewer($.current),J.current.setExternalLinkRel(H),J.current.setExternalLinkTarget(ut)}reactExports.useEffect(q,[H,ut]);function st(Q,Z){G.current[Q]=Z}function ht(Q){delete G.current[Q]}const pt=reactExports.useMemo(()=>({imageResourcesPath:m,linkService:J.current,onItemClick:_,pdf:et,registerPage:st,renderMode:o,rotate:d,unregisterPage:ht}),[m,_,et,o,d]),yt=reactExports.useMemo(()=>makeEventProps(l,()=>et),[l,et]);function bt(){return React.createElement(DocumentContext.Provider,{value:pt},n)}function _t(){return k?et==null?React.createElement(Message,{type:"loading"},typeof j=="function"?j():j):et===!1?React.createElement(Message,{type:"error"},typeof z=="function"?z():z):bt():React.createElement(Message,{type:"no-data"},typeof U=="function"?U():U)}return React.createElement("div",Object.assign({className:clsx("react-pdf__Document",u),ref:w,style:{"--scale-factor":"1"}},yt),_t())}),isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,options:PropTypes.shape({canvasFactory:PropTypes.any,canvasMaxAreaInBytes:PropTypes.number,cMapPacked:PropTypes.bool,CMapReaderFactory:PropTypes.any,cMapUrl:PropTypes.string,disableAutoFetch:PropTypes.bool,disableFontFace:PropTypes.bool,disableRange:PropTypes.bool,disableStream:PropTypes.bool,docBaseUrl:PropTypes.string,enableXfa:PropTypes.bool,filterFactory:PropTypes.any,fontExtraProperties:PropTypes.bool,httpHeaders:PropTypes.object,isEvalSupported:PropTypes.bool,isOffscreenCanvasSupported:PropTypes.bool,length:PropTypes.number,maxImageSize:PropTypes.number,ownerDocument:PropTypes.any,password:PropTypes.string,pdfBug:PropTypes.bool,rangeChunkSize:PropTypes.number,StandardFontDataFactory:PropTypes.any,standardFontDataUrl:PropTypes.string,stopAtErrors:PropTypes.bool,useSystemFonts:PropTypes.bool,useWorkerFetch:PropTypes.bool,verbosity:PropTypes.number,withCredentials:PropTypes.bool,worker:PropTypes.any}),rotate:PropTypes.number});function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var x=[],e=0;e<arguments.length;e++)x[e]=arguments[e];var N=x.filter(Boolean);if(N.length<=1){var n=N[0];return n||null}return function(z){N.forEach(function(H){typeof H=="function"?H(z):H&&(H.current=z)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(x){return x in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(x){return"children"in x}function isStructTreeNodeWithOnlyContentChild(x){return isStructTreeNode(x)?x.children.length===1&&0 in x.children&&"id"in x.children[0]:!1}function getRoleAttributes(x){const e={};if(isStructTreeNode(x)){const{role:N}=x,n=N.match(HEADING_PATTERN);if(n)e.role="heading",e["aria-level"]=Number(n[1]);else if(isPdfRole(N)){const u=PDF_ROLE_TO_HTML_ROLE[N];u&&(e.role=u)}}return e}function getBaseAttributes(x){const e={};if(isStructTreeNode(x)){if(x.alt!==void 0&&(e["aria-label"]=x.alt),x.lang!==void 0&&(e.lang=x.lang),isStructTreeNodeWithOnlyContentChild(x)){const[N]=x.children;if(N){const n=getBaseAttributes(N);return Object.assign(Object.assign({},e),n)}}}else"id"in x&&(e["aria-owns"]=x.id);return e}function getAttributes(x){return x?Object.assign(Object.assign({},getRoleAttributes(x)),getBaseAttributes(x)):null}function StructTreeItem({className:x,node:e}){const N=reactExports.useMemo(()=>getAttributes(e),[e]),n=reactExports.useMemo(()=>!isStructTreeNode(e)||isStructTreeNodeWithOnlyContentChild(e)?null:e.children.map((u,z)=>React.createElement(StructTreeItem,{key:z,node:u})),[e]);return React.createElement("span",Object.assign({className:x},N),n)}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const x=usePageContext();invariant(x);const{onGetStructTreeError:e,onGetStructTreeSuccess:N}=x,[n,u]=useResolver(),{value:z,error:H}=n,{customTextRenderer:ut,page:k}=x;function w(){z&&N&&N(z)}function m(){H&&(warning$1(!1,H.toString()),e&&e(H))}function j(){u({type:"RESET"})}reactExports.useEffect(j,[u,k]);function U(){if(ut||!k)return;const _=makeCancellablePromise(k.getStructTree()),b=_;return _.promise.then(S=>{u({type:"RESOLVE",value:S})}).catch(S=>{u({type:"REJECT",error:S})}),()=>cancelRunningTask(b)}return reactExports.useEffect(U,[ut,k,u]),reactExports.useEffect(()=>{if(z!==void 0){if(z===!1){m();return}w()}},[z]),z?React.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:z}):null}const ANNOTATION_MODE=pdfjs.AnnotationMode;function PageCanvas(x){const e=usePageContext();invariant(e);const N=Object.assign(Object.assign({},e),x),{_className:n,canvasBackground:u,devicePixelRatio:z=getDevicePixelRatio(),onRenderError:H,onRenderSuccess:ut,page:k,renderForms:w,renderTextLayer:m,rotate:j,scale:U}=N,{canvasRef:_}=x;invariant(k);const b=reactExports.useRef(null);function S(){k&&ut&&ut(makePageCallback(k,U))}function g(o){isCancelException(o)||(warning$1(!1,o.toString()),H&&H(o))}const f=reactExports.useMemo(()=>k.getViewport({scale:U*z,rotation:j}),[z,k,j,U]),A=reactExports.useMemo(()=>k.getViewport({scale:U,rotation:j}),[k,j,U]);function L(){if(!k)return;k.cleanup();const{current:o}=b;if(!o)return;o.width=f.width,o.height=f.height,o.style.width=`${Math.floor(A.width)}px`,o.style.height=`${Math.floor(A.height)}px`,o.style.visibility="hidden";const d={annotationMode:w?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:o.getContext("2d",{alpha:!1}),viewport:f};u&&(d.background=u);const l=k.render(d),c=l;return l.promise.then(()=>{o.style.visibility="",S()}).catch(g),()=>cancelRunningTask(c)}reactExports.useEffect(L,[u,b,z,k,w,f,A]);const v=reactExports.useCallback(()=>{const{current:o}=b;o&&(o.width=0,o.height=0)},[b]);return reactExports.useEffect(()=>v,[v]),React.createElement("canvas",{className:`${n}__canvas`,dir:"ltr",ref:mergeRefs(_,b),style:{display:"block",userSelect:"none"}},m?React.createElement(StructTree,null):null)}function PageSVG(){const x=usePageContext();invariant(x);const{_className:e,onRenderSuccess:N,onRenderError:n,page:u,rotate:z,scale:H}=x;invariant(u);const[ut,k]=useResolver(),{value:w,error:m}=ut;function j(){u&&N&&N(makePageCallback(u,H))}function U(){m&&(isCancelException(m)||(warning$1(!1,m.toString()),n&&n(m)))}const _=reactExports.useMemo(()=>u.getViewport({scale:H,rotation:z}),[u,z,H]);function b(){k({type:"RESET"})}reactExports.useEffect(b,[u,k,_]);function S(){if(!u)return;const L=makeCancellablePromise(u.getOperatorList());return L.promise.then(v=>{new pdfjs.SVGGraphics(u.commonObjs,u.objs).getSVG(v,_).then(d=>{if(!(d instanceof SVGElement))throw new Error("getSVG returned unexpected result.");k({type:"RESOLVE",value:d})}).catch(d=>{k({type:"REJECT",error:d})})}).catch(v=>{k({type:"REJECT",error:v})}),()=>cancelRunningTask(L)}reactExports.useEffect(S,[u,k,_]),reactExports.useEffect(()=>{if(w!==void 0){if(w===!1){U();return}j()}},[w]);function g(L){if(!L||!w)return;L.firstElementChild||L.appendChild(w);const{width:v,height:o}=_;w.setAttribute("width",`${v}`),w.setAttribute("height",`${o}`)}const{width:f,height:A}=_;return React.createElement("div",{className:`${e}__svg`,ref:L=>g(L),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:f,height:A,userSelect:"none"}})}function isTextItem(x){return"str"in x}function TextLayer(){const x=usePageContext();invariant(x);const{customTextRenderer:e,onGetTextError:N,onGetTextSuccess:n,onRenderTextLayerError:u,onRenderTextLayerSuccess:z,page:H,pageIndex:ut,pageNumber:k,rotate:w,scale:m}=x;invariant(H);const[j,U]=useResolver(),{value:_,error:b}=j,S=reactExports.useRef(null),g=reactExports.useRef();warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function f(){_&&n&&n(_)}function A(){b&&(warning$1(!1,b.toString()),N&&N(b))}function L(){U({type:"RESET"})}reactExports.useEffect(L,[H,U]);function v(){if(!H)return;const a=makeCancellablePromise(H.getTextContent()),E=a;return a.promise.then(R=>{U({type:"RESOLVE",value:R})}).catch(R=>{U({type:"REJECT",error:R})}),()=>cancelRunningTask(E)}reactExports.useEffect(v,[H,U]),reactExports.useEffect(()=>{if(_!==void 0){if(_===!1){A();return}f()}},[_]);const o=reactExports.useCallback(()=>{z&&z()},[z]),d=reactExports.useCallback(a=>{warning$1(!1,a.toString()),u&&u(a)},[u]);function l(){const a=g.current;a&&a.classList.add("active")}function c(){const a=g.current;a&&a.classList.remove("active")}const h=reactExports.useMemo(()=>H.getViewport({scale:m,rotation:w}),[H,w,m]);function B(){if(!H||!_)return;const{current:a}=S;if(!a)return;a.innerHTML="";const E=H.streamTextContent({includeMarkedContent:!0}),R={container:a,textContentSource:E,viewport:h},et=pdfjs.renderTextLayer(R),V=et;return et.promise.then(()=>{const J=document.createElement("div");J.className="endOfContent",a.append(J),g.current=J;const G=a.querySelectorAll('[role="presentation"]');if(e){let rt=0;_.items.forEach((C,$)=>{if(!isTextItem(C))return;const nt=G[rt];if(!nt)return;const T=e(Object.assign({pageIndex:ut,pageNumber:k,itemIndex:$},C));nt.innerHTML=T,rt+=C.str&&C.hasEOL?2:1})}o()}).catch(d),()=>cancelRunningTask(V)}return reactExports.useLayoutEffect(B,[e,d,o,H,ut,k,_,h]),React.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:c,onMouseDown:l,ref:S})}function AnnotationLayer(){const x=useDocumentContext(),e=usePageContext();invariant(e);const N=Object.assign(Object.assign({},x),e),{imageResourcesPath:n,linkService:u,onGetAnnotationsError:z,onGetAnnotationsSuccess:H,onRenderAnnotationLayerError:ut,onRenderAnnotationLayerSuccess:k,page:w,pdf:m,renderForms:j,rotate:U,scale:_=1}=N;invariant(m),invariant(w),invariant(u);const[b,S]=useResolver(),{value:g,error:f}=b,A=reactExports.useRef(null);warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function L(){g&&H&&H(g)}function v(){f&&(warning$1(!1,f.toString()),z&&z(f))}function o(){S({type:"RESET"})}reactExports.useEffect(o,[S,w]);function d(){if(!w)return;const a=makeCancellablePromise(w.getAnnotations()),E=a;return a.promise.then(R=>{S({type:"RESOLVE",value:R})}).catch(R=>{S({type:"REJECT",error:R})}),()=>{cancelRunningTask(E)}}reactExports.useEffect(d,[S,w,j]),reactExports.useEffect(()=>{if(g!==void 0){if(g===!1){v();return}L()}},[g]);function l(){k&&k()}function c(a){warning$1(!1,`${a}`),ut&&ut(a)}const h=reactExports.useMemo(()=>w.getViewport({scale:_,rotation:U}),[w,U,_]);function B(){if(!m||!w||!u||!g)return;const{current:a}=A;if(!a)return;const E=h.clone({dontFlip:!0}),R={accessibilityManager:null,annotationCanvasMap:null,div:a,l10n:null,page:w,viewport:E},et={annotations:g,annotationStorage:m.annotationStorage,div:a,downloadManager:null,imageResourcesPath:n,linkService:u,page:w,renderForms:j,viewport:E};a.innerHTML="";try{new pdfjs.AnnotationLayer(R).render(et),l()}catch(V){c(V)}return()=>{}}return reactExports.useEffect(B,[g,n,u,w,j,h]),React.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:A})}var __rest=function(x,e){var N={};for(var n in x)Object.prototype.hasOwnProperty.call(x,n)&&e.indexOf(n)<0&&(N[n]=x[n]);if(x!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,n=Object.getOwnPropertySymbols(x);u<n.length;u++)e.indexOf(n[u])<0&&Object.prototype.propertyIsEnumerable.call(x,n[u])&&(N[n[u]]=x[n[u]]);return N};const defaultScale=1,Page=function x(e){const N=useDocumentContext(),n=Object.assign(Object.assign({},N),e),{_className:u="react-pdf__Page",_enableRegisterUnregisterPage:z=!0,canvasBackground:H,canvasRef:ut,children:k,className:w,customRenderer:m,customTextRenderer:j,devicePixelRatio:U,error:_="Failed to load the page.",height:b,inputRef:S,loading:g="Loading page…",noData:f="No page specified.",onGetAnnotationsError:A,onGetAnnotationsSuccess:L,onGetStructTreeError:v,onGetStructTreeSuccess:o,onGetTextError:d,onGetTextSuccess:l,onLoadError:c,onLoadSuccess:h,onRenderAnnotationLayerError:B,onRenderAnnotationLayerSuccess:a,onRenderError:E,onRenderSuccess:R,onRenderTextLayerError:et,onRenderTextLayerSuccess:V,pageIndex:J,pageNumber:G,pdf:rt,registerPage:C,renderAnnotationLayer:$=!0,renderForms:nt=!1,renderMode:T="canvas",renderTextLayer:s=!0,rotate:i,scale:p=defaultScale,unregisterPage:M,width:D}=n,O=__rest(n,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[q,st]=useResolver(),{value:ht,error:pt}=q,yt=reactExports.useRef(null);invariant(rt);const bt=isProvided(G)?G-1:J??null,_t=G??(isProvided(J)?J+1:null),Q=i??(ht?ht.rotate:null),Z=reactExports.useMemo(()=>{if(!ht)return null;let It=1;const Gt=p??defaultScale;if(D||b){const qt=ht.getViewport({scale:1,rotation:Q});D?It=D/qt.width:b&&(It=b/qt.height)}return Gt*It},[b,ht,Q,p,D]);function y(){return()=>{isProvided(bt)&&z&&M&&M(bt)}}reactExports.useEffect(y,[z,rt,bt,M]);function I(){if(h){if(!ht||!Z)return;h(makePageCallback(ht,Z))}if(z&&C){if(!isProvided(bt)||!yt.current)return;C(bt,yt.current)}}function Y(){pt&&(warning$1(!1,pt.toString()),c&&c(pt))}function it(){st({type:"RESET"})}reactExports.useEffect(it,[st,rt,bt]);function gt(){if(!rt||!_t)return;const It=makeCancellablePromise(rt.getPage(_t)),Gt=It;return It.promise.then(qt=>{st({type:"RESOLVE",value:qt})}).catch(qt=>{st({type:"REJECT",error:qt})}),()=>cancelRunningTask(Gt)}reactExports.useEffect(gt,[st,rt,bt,_t,C]),reactExports.useEffect(()=>{if(ht!==void 0){if(ht===!1){Y();return}I()}},[ht,Z]);const St=reactExports.useMemo(()=>ht&&isProvided(bt)&&_t&&isProvided(Q)&&isProvided(Z)?{_className:u,canvasBackground:H,customTextRenderer:j,devicePixelRatio:U,onGetAnnotationsError:A,onGetAnnotationsSuccess:L,onGetStructTreeError:v,onGetStructTreeSuccess:o,onGetTextError:d,onGetTextSuccess:l,onRenderAnnotationLayerError:B,onRenderAnnotationLayerSuccess:a,onRenderError:E,onRenderSuccess:R,onRenderTextLayerError:et,onRenderTextLayerSuccess:V,page:ht,pageIndex:bt,pageNumber:_t,renderForms:nt,renderTextLayer:s,rotate:Q,scale:Z}:null,[u,H,j,U,A,L,v,o,d,l,B,a,E,R,et,V,ht,bt,_t,nt,s,Q,Z]),vt=reactExports.useMemo(()=>makeEventProps(O,()=>ht&&(Z?makePageCallback(ht,Z):void 0)),[O,ht,Z]),tt=`${bt}@${Z}/${Q}`,wt=`${bt}/${Q}`;function Pt(){switch(T){case"custom":return invariant(m),React.createElement(m,{key:`${tt}_custom`});case"none":return null;case"svg":return React.createElement(PageSVG,{key:`${wt}_svg`});case"canvas":default:return React.createElement(PageCanvas,{key:`${tt}_canvas`,canvasRef:ut})}}function Wt(){return s?React.createElement(TextLayer,{key:`${tt}_text`}):null}function Ut(){return $?React.createElement(AnnotationLayer,{key:`${tt}_annotations`}):null}function zt(){return React.createElement(PageContext.Provider,{value:St},Pt(),Wt(),Ut(),k)}function Ft(){return _t?rt===null||ht===void 0||ht===null?React.createElement(Message,{type:"loading"},typeof g=="function"?g():g):rt===!1||ht===!1?React.createElement(Message,{type:"error"},typeof _=="function"?_():_):zt():React.createElement(Message,{type:"no-data"},typeof f=="function"?f():f)}return React.createElement("div",Object.assign({className:clsx(u,w),"data-page-number":_t,ref:mergeRefs(S,yt),style:{"--scale-factor":`${Z}`,backgroundColor:H||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},vt),Ft())},isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:PropTypes.string,canvasRef:isRef,children:PropTypes.node,className:isClassName,customRenderer:PropTypes.func,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,width:PropTypes.number});displayWorkerWarning();pdfjs.GlobalWorkerOptions.workerSrc="pdf.worker.js";export{Document as D,PropTypes as P,Page as a,clsx as c,invariant as i,pdfjs as p};
